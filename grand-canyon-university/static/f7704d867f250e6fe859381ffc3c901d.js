/*
 New BSD License <http://creativecommons.org/licenses/BSD/>
 New BSD License <http://creativecommons.org/licenses/BSD/>

 Edited 05/2012
 Removed hashtag management features
 @author henry
 Public Domain
 @author Benjamin Arthur Lupton <contact@balupton.com>
 @author James Padolsey <https://gist.github.com/527683>
 Public Domain
 @author Benjamin Arthur Lupton <contact@balupton.com>
 http://opensource.org/licenses/bsd-license.php New BSD License
 @author Paul Serby <paul.serby@clock.co.uk>
*/
(function(b,a){function c(a){var b=O[a]={},c,e,a=a.split(/\s+/);c=0;for(e=a.length;c<e;c++)b[a[c]]=!0;return b}function d(b,c,e){if(e===a&&b.nodeType===1)if(e="data-"+c.replace(B,"-$1").toLowerCase(),e=b.getAttribute(e),typeof e==="string"){try{e=e==="true"?!0:e==="false"?!1:e==="null"?null:h.isNumeric(e)?parseFloat(e):y.test(e)?h.parseJSON(e):e}catch(d){}h.data(b,c,e)}else e=a;return e}function e(a){for(var b in a)if(!(b==="data"&&h.isEmptyObject(a[b]))&&b!=="toJSON")return!1;return!0}function f(a,
b,c){var e=b+"defer",d=b+"queue",f=b+"mark",g=h._data(a,e);g&&(c==="queue"||!h._data(a,d))&&(c==="mark"||!h._data(a,f))&&setTimeout(function(){!h._data(a,d)&&!h._data(a,f)&&(h.removeData(a,e,!0),g.fire())},0)}function j(){return!1}function k(){return!0}function l(a,b,c){b=b||0;if(h.isFunction(b))return h.grep(a,function(a,w){return!!b.call(a,w,a)===c});else if(b.nodeType)return h.grep(a,function(a){return a===b===c});else if(typeof b==="string"){var e=h.grep(a,function(a){return a.nodeType===1});
if(Na.test(b))return h.filter(b,e,!c);else b=h.filter(b,e)}return h.grep(a,function(a){return h.inArray(a,b)>=0===c})}function q(a){var b=oa.split("|"),a=a.createDocumentFragment();if(a.createElement)for(;b.length;)a.createElement(b.pop());return a}function r(a,b){if(b.nodeType===1&&h.hasData(a)){var c,e,d;e=h._data(a);var f=h._data(b,e),g=e.events;if(g)for(c in delete f.handle,f.events={},g){e=0;for(d=g[c].length;e<d;e++)h.event.add(b,c+(g[c][e].namespace?".":"")+g[c][e].namespace,g[c][e],g[c][e].data)}if(f.data)f.data=
h.extend({},f.data)}}function g(a,b){var c;if(b.nodeType===1){b.clearAttributes&&b.clearAttributes();b.mergeAttributes&&b.mergeAttributes(a);c=b.nodeName.toLowerCase();if(c==="object")b.outerHTML=a.outerHTML;else if(c==="input"&&(a.type==="checkbox"||a.type==="radio")){if(a.checked)b.defaultChecked=b.checked=a.checked;if(b.value!==a.value)b.value=a.value}else if(c==="option")b.selected=a.defaultSelected;else if(c==="input"||c==="textarea")b.defaultValue=a.defaultValue;b.removeAttribute(h.expando)}}
function o(a){return typeof a.getElementsByTagName!=="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!=="undefined"?a.querySelectorAll("*"):[]}function u(a){if(a.type==="checkbox"||a.type==="radio")a.defaultChecked=a.checked}function p(a){var b=(a.nodeName||"").toLowerCase();b==="input"?u(a):b!=="script"&&typeof a.getElementsByTagName!=="undefined"&&h.grep(a.getElementsByTagName("input"),u)}function A(a,b){b.src?h.ajax({url:b.src,async:!1,dataType:"script"}):h.globalEval((b.text||
b.textContent||b.innerHTML||"").replace(Oa,"/*$0*/"));b.parentNode&&b.parentNode.removeChild(b)}function z(a,b,c){var e=b==="width"?a.offsetWidth:a.offsetHeight,d=b==="width"?Pa:Qa,f=0,g=d.length;if(e>0){if(c!=="border")for(;f<g;f++)c||(e-=parseFloat(h.css(a,"padding"+d[f]))||0),c==="margin"?e+=parseFloat(h.css(a,c+d[f]))||0:e-=parseFloat(h.css(a,"border"+d[f]+"Width"))||0;return e+"px"}e=aa(a,b,b);if(e<0||e==null)e=a.style[b]||0;e=parseFloat(e)||0;if(c)for(;f<g;f++)e+=parseFloat(h.css(a,"padding"+
d[f]))||0,c!=="padding"&&(e+=parseFloat(h.css(a,"border"+d[f]+"Width"))||0),c==="margin"&&(e+=parseFloat(h.css(a,c+d[f]))||0);return e+"px"}function x(a){return function(b,c){var w;typeof b!=="string"&&(c=b,b="*");if(h.isFunction(c))for(var e=b.toLowerCase().split(pa),d=0,f=e.length,g,m;d<f;d++)g=e[d],(m=/^\+/.test(g))&&(g=g.substr(1)||"*"),w=a[g]=a[g]||[],g=w,g[m?"unshift":"push"](c)}}function J(b,c,e,d,f,h){f=f||c.dataTypes[0];h=h||{};h[f]=!0;for(var f=b[f],g=0,m=f?f.length:0,j=b===ia,k;g<m&&(j||
!k);g++)k=f[g](c,e,d),typeof k==="string"&&(!j||h[k]?k=a:(c.dataTypes.unshift(k),k=J(b,c,e,d,k,h)));if((j||!k)&&!h["*"])k=J(b,c,e,d,"*",h);return k}function N(b,c){var e,d,f=h.ajaxSettings.flatOptions||{};for(e in c)c[e]!==a&&((f[e]?b:d||(d={}))[e]=c[e]);d&&h.extend(!0,b,d)}function F(a,b,c,e){if(h.isArray(b))h.each(b,function(b,d){c||Ra.test(a)?e(a,d):F(a+"["+(typeof d==="object"||h.isArray(d)?b:"")+"]",d,c,e)});else if(!c&&b!=null&&typeof b==="object")for(var d in b)F(a+"["+d+"]",b[d],c,e);else e(a,
b)}function n(){try{return new b.XMLHttpRequest}catch(a){}}function D(){setTimeout(P,0);return ea=h.now()}function P(){ea=a}function K(a,b){var c={};h.each(qa.concat.apply([],qa.slice(0,b)),function(){c[this]=a});return c}function I(a){if(!ja[a]){var b=s.body,c=h("<"+a+">").appendTo(b),e=c.css("display");c.remove();if(e==="none"||e===""){if(!R)R=s.createElement("iframe"),R.frameBorder=R.width=R.height=0;b.appendChild(R);if(!ba||!R.createElement)ba=(R.contentWindow||R.contentDocument).document,ba.write((s.compatMode===
"CSS1Compat"?"<!doctype html>":"")+"<html><body>"),ba.close();c=ba.createElement(a);ba.body.appendChild(c);e=h.css(c,"display");b.removeChild(R)}ja[a]=e}return ja[a]}function M(a){return h.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}var s=b.document,U=b.navigator,L=b.location,h=function(){function c(){if(!e.isReady){try{s.documentElement.doScroll("left")}catch(a){setTimeout(c,1);return}e.ready()}}var e=function(a,b){return new e.fn.init(a,b,h)},d=b.jQuery,f=b.$,h,g=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,
m=/\S/,k=/^\s+/,j=/\s+$/,t=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,v=/^[\],:{}\s]*$/,l=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,y=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,p=/(?:^|:|,)(?:\s*\[)+/g,o=/(webkit)[ \/]([\w.]+)/,q=/(opera)(?:.*version)?[ \/]([\w.]+)/,G=/(msie) ([\w.]+)/,n=/(mozilla)(?:.*? rv:([\w.]+))?/,I=/-([a-z]|[0-9])/ig,B=/^-ms-/,r=function(a,b){return(b+"").toUpperCase()},A=U.userAgent,fa,ca,z=Object.prototype.toString,X=Object.prototype.hasOwnProperty,x=Array.prototype.push,
u=Array.prototype.slice,J=String.prototype.trim,S=Array.prototype.indexOf,M={};e.fn=e.prototype={constructor:e,init:function(b,c,d){var w;if(!b)return this;if(b.nodeType)return this.context=this[0]=b,this.length=1,this;if(b==="body"&&!c&&s.body)return this.context=s,this[0]=s.body,this.selector=b,this.length=1,this;if(typeof b==="string")if((w=b.charAt(0)==="<"&&b.charAt(b.length-1)===">"&&b.length>=3?[null,b,null]:g.exec(b))&&(w[1]||!c))if(w[1])return d=(c=c instanceof e?c[0]:c)?c.ownerDocument||
c:s,(b=t.exec(b))?e.isPlainObject(c)?(b=[s.createElement(b[1])],e.fn.attr.call(b,c,!0)):b=[d.createElement(b[1])]:(b=e.buildFragment([w[1]],[d]),b=(b.cacheable?e.clone(b.fragment):b.fragment).childNodes),e.merge(this,b);else{if((c=s.getElementById(w[2]))&&c.parentNode){if(c.id!==w[2])return d.find(b);this.length=1;this[0]=c}this.context=s;this.selector=b;return this}else return!c||c.jquery?(c||d).find(b):this.constructor(c).find(b);else if(e.isFunction(b))return d.ready(b);if(b.selector!==a)this.selector=
b.selector,this.context=b.context;return e.makeArray(b,this)},selector:"",jquery:"1.7.1",length:0,size:function(){return this.length},toArray:function(){return u.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=this.constructor();e.isArray(a)?x.apply(d,a):e.merge(d,a);d.prevObject=this;d.context=this.context;if(b==="find")d.selector=this.selector+(this.selector?" ":"")+c;else if(b)d.selector=this.selector+"."+b+"("+c+")";
return d},each:function(a,b){return e.each(this,a,b)},ready:function(a){e.bindReady();fa.add(a);return this},eq:function(a){a=+a;return a===-1?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(u.apply(this,arguments),"slice",u.call(arguments).join(","))},map:function(a){return this.pushStack(e.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:x,
sort:[].sort,splice:[].splice};e.fn.init.prototype=e.fn;e.extend=e.fn.extend=function(){var b,c,d,w,f,h=arguments[0]||{},g=1,H=arguments.length,m=!1;typeof h==="boolean"&&(m=h,h=arguments[1]||{},g=2);typeof h!=="object"&&!e.isFunction(h)&&(h={});H===g&&(h=this,--g);for(;g<H;g++)if((b=arguments[g])!=null)for(c in b)d=h[c],w=b[c],h!==w&&(m&&w&&(e.isPlainObject(w)||(f=e.isArray(w)))?(f?(f=!1,d=d&&e.isArray(d)?d:[]):d=d&&e.isPlainObject(d)?d:{},h[c]=e.extend(m,d,w)):w!==a&&(h[c]=w));return h};e.extend({noConflict:function(a){if(b.$===
e)b.$=f;if(a&&b.jQuery===e)b.jQuery=d;return e},isReady:!1,readyWait:1,holdReady:function(a){a?e.readyWait++:e.ready(!0)},ready:function(a){if(a===!0&&!--e.readyWait||a!==!0&&!e.isReady){if(!s.body)return setTimeout(e.ready,1);e.isReady=!0;a!==!0&&--e.readyWait>0||(fa.fireWith(s,[e]),e.fn.trigger&&e(s).trigger("ready").off("ready"))}},bindReady:function(){if(!fa){fa=e.Callbacks("once memory");if(s.readyState==="complete")return setTimeout(e.ready,1);if(s.addEventListener)s.addEventListener("DOMContentLoaded",
ca,!1),b.addEventListener("load",e.ready,!1);else if(s.attachEvent){s.attachEvent("onreadystatechange",ca);b.attachEvent("onload",e.ready);var a=!1;try{a=b.frameElement==null}catch(d){}s.documentElement.doScroll&&a&&c()}}},isFunction:function(a){return e.type(a)==="function"},isArray:Array.isArray||function(a){return e.type(a)==="array"},isWindow:function(a){return a&&typeof a==="object"&&"setInterval"in a},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return a==
null?String(a):M[z.call(a)]||"object"},isPlainObject:function(b){if(!b||e.type(b)!=="object"||b.nodeType||e.isWindow(b))return!1;try{if(b.constructor&&!X.call(b,"constructor")&&!X.call(b.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}for(var d in b);return d===a||X.call(b,d)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw Error(a);},parseJSON:function(a){if(typeof a!=="string"||!a)return null;a=e.trim(a);if(b.JSON&&b.JSON.parse)return b.JSON.parse(a);
if(v.test(a.replace(l,"@").replace(y,"]").replace(p,"")))return(new Function("return "+a))();e.error("Invalid JSON: "+a)},parseXML:function(c){var d,w;try{b.DOMParser?(w=new DOMParser,d=w.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(f){d=a}(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&e.error("Invalid XML: "+c);return d},noop:function(){},globalEval:function(a){a&&m.test(a)&&(b.execScript||function(a){b.eval.call(b,
a)})(a)},camelCase:function(a){return a.replace(B,"ms-").replace(I,r)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(b,c,d){var w,f=0,h=b.length,g=h===a||e.isFunction(b);if(d)if(g)for(w in b){if(c.apply(b[w],d)===!1)break}else for(;f<h;){if(c.apply(b[f++],d)===!1)break}else if(g)for(w in b){if(c.call(b[w],w,b[w])===!1)break}else for(;f<h;)if(c.call(b[f],f,b[f++])===!1)break;return b},trim:J?function(a){return a==null?"":J.call(a)}:function(a){return a==
null?"":a.toString().replace(k,"").replace(j,"")},makeArray:function(a,b){var c=b||[];if(a!=null){var d=e.type(a);a.length==null||d==="string"||d==="function"||d==="regexp"||e.isWindow(a)?x.call(c,a):e.merge(c,a)}return c},inArray:function(a,b,c){var e;if(b){if(S)return S.call(b,a,c);e=b.length;for(c=c?c<0?Math.max(0,e+c):c:0;c<e;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(b,c){var e=b.length,d=0;if(typeof c.length==="number")for(var w=c.length;d<w;d++)b[e++]=c[d];else for(;c[d]!==a;)b[e++]=
c[d++];b.length=e;return b},grep:function(a,b,c){for(var e=[],d,c=!!c,w=0,f=a.length;w<f;w++)d=!!b(a[w],w),c!==d&&e.push(a[w]);return e},map:function(b,c,d){var w,f,h=[],g=0,H=b.length;if(b instanceof e||H!==a&&typeof H==="number"&&(H>0&&b[0]&&b[H-1]||H===0||e.isArray(b)))for(;g<H;g++)w=c(b[g],g,d),w!=null&&(h[h.length]=w);else for(f in b)w=c(b[f],f,d),w!=null&&(h[h.length]=w);return h.concat.apply([],h)},guid:1,proxy:function(b,c){if(typeof c==="string")var d=b[c],c=b,b=d;if(!e.isFunction(b))return a;
var w=u.call(arguments,2),d=function(){return b.apply(c,w.concat(u.call(arguments)))};d.guid=b.guid=b.guid||d.guid||e.guid++;return d},access:function(b,c,d,w,f,h){var g=b.length;if(typeof c==="object"){for(var H in c)e.access(b,H,c[H],w,f,d);return b}if(d!==a){w=!h&&w&&e.isFunction(d);for(H=0;H<g;H++)f(b[H],c,w?d.call(b[H],H,f(b[H],c)):d,h);return b}return g?f(b[0],c):a},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();a=o.exec(a)||q.exec(a)||G.exec(a)||a.indexOf("compatible")<
0&&n.exec(a)||[];return{browser:a[1]||"",version:a[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}e.extend(!0,a,this);a.superclass=this;a.fn=a.prototype=this();a.fn.constructor=a;a.sub=this.sub;a.fn.init=function(c,d){d&&d instanceof e&&!(d instanceof a)&&(d=a(d));return e.fn.init.call(this,c,d,b)};a.fn.init.prototype=a.fn;var b=a(s);return a},browser:{}});e.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){M["[object "+b+"]"]=b.toLowerCase()});
A=e.uaMatch(A);if(A.browser)e.browser[A.browser]=!0,e.browser.version=A.version;if(e.browser.webkit)e.browser.safari=!0;m.test("\u00a0")&&(k=/^[\s\xA0]+/,j=/[\s\xA0]+$/);h=e(s);s.addEventListener?ca=function(){s.removeEventListener("DOMContentLoaded",ca,!1);e.ready()}:s.attachEvent&&(ca=function(){s.readyState==="complete"&&(s.detachEvent("onreadystatechange",ca),e.ready())});return e}(),O={};h.Callbacks=function(b){var b=b?O[b]||c(b):{},e=[],d=[],f,g,m,k,j,t=function(a){var c,d,f,g;c=0;for(d=a.length;c<
d;c++)f=a[c],g=h.type(f),g==="array"?t(f):g==="function"&&(!b.unique||!l.has(f))&&e.push(f)},v=function(a,c){c=c||[];f=!b.memory||[a,c];g=!0;j=m||0;m=0;for(k=e.length;e&&j<k;j++)if(e[j].apply(a,c)===!1&&b.stopOnFalse){f=!0;break}g=!1;e&&(b.once?f===!0?l.disable():e=[]:d&&d.length&&(f=d.shift(),l.fireWith(f[0],f[1])))},l={add:function(){if(e){var a=e.length;t(arguments);g?k=e.length:f&&f!==!0&&(m=a,v(f[0],f[1]))}return this},remove:function(){if(e)for(var a=arguments,c=0,d=a.length;c<d;c++)for(var f=
0;f<e.length;f++)if(a[c]===e[f]&&(g&&f<=k&&(k--,f<=j&&j--),e.splice(f--,1),b.unique))break;return this},has:function(a){if(e)for(var b=0,c=e.length;b<c;b++)if(a===e[b])return!0;return!1},empty:function(){e=[];return this},disable:function(){e=d=f=a;return this},disabled:function(){return!e},lock:function(){d=a;(!f||f===!0)&&l.disable();return this},locked:function(){return!d},fireWith:function(a,c){d&&(g?b.once||d.push([a,c]):(!b.once||!f)&&v(a,c));return this},fire:function(){l.fireWith(this,arguments);
return this},fired:function(){return!!f}};return l};var t=[].slice;h.extend({Deferred:function(a){var b=h.Callbacks("once memory"),c=h.Callbacks("once memory"),e=h.Callbacks("memory"),d="pending",f={resolve:b,reject:c,notify:e},g={done:b.add,fail:c.add,progress:e.add,state:function(){return d},isResolved:b.fired,isRejected:c.fired,then:function(a,b,c){m.done(a).fail(b).progress(c);return this},always:function(){m.done.apply(m,arguments).fail.apply(m,arguments);return this},pipe:function(a,b,c){return h.Deferred(function(e){h.each({done:[a,
"resolve"],fail:[b,"reject"],progress:[c,"notify"]},function(a,b){var c=b[0],d=b[1],w;if(h.isFunction(c))m[a](function(){if((w=c.apply(this,arguments))&&h.isFunction(w.promise))w.promise().then(e.resolve,e.reject,e.notify);else e[d+"With"](this===m?e:this,[w])});else m[a](e[d])})}).promise()},promise:function(a){if(a==null)a=g;else for(var b in g)a[b]=g[b];return a}},m=g.promise({}),k;for(k in f)m[k]=f[k].fire,m[k+"With"]=f[k].fireWith;m.done(function(){d="resolved"},c.disable,e.lock).fail(function(){d=
"rejected"},b.disable,e.lock);a&&a.call(m,m);return m},when:function(a){function b(a){return function(b){e[a]=arguments.length>1?t.call(arguments,0):b;--m||k.resolveWith(k,e)}}function c(a){return function(b){g[a]=arguments.length>1?t.call(arguments,0):b;k.notifyWith(j,g)}}var e=t.call(arguments,0),d=0,f=e.length,g=Array(f),m=f,k=f<=1&&a&&h.isFunction(a.promise)?a:h.Deferred(),j=k.promise();if(f>1){for(;d<f;d++)e[d]&&e[d].promise&&h.isFunction(e[d].promise)?e[d].promise().then(b(d),k.reject,c(d)):
--m;m||k.resolveWith(k,e)}else k!==a&&k.resolveWith(k,f?[a]:[]);return j}});h.support=function(){var a,c,e,d,f,g,m,k,j=s.createElement("div");j.setAttribute("className","t");j.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>";c=j.getElementsByTagName("*");e=j.getElementsByTagName("a")[0];if(!c||!c.length||!e)return{};d=s.createElement("select");f=d.appendChild(s.createElement("option"));c=j.getElementsByTagName("input")[0];a={leadingWhitespace:j.firstChild.nodeType===
3,tbody:!j.getElementsByTagName("tbody").length,htmlSerialize:!!j.getElementsByTagName("link").length,style:/top/.test(e.getAttribute("style")),hrefNormalized:e.getAttribute("href")==="/a",opacity:/^0.55/.test(e.style.opacity),cssFloat:!!e.style.cssFloat,checkOn:c.value==="on",optSelected:f.selected,getSetAttribute:j.className!=="t",enctype:!!s.createElement("form").enctype,html5Clone:s.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,
deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0};c.checked=!0;a.noCloneChecked=c.cloneNode(!0).checked;d.disabled=!0;a.optDisabled=!f.disabled;try{delete j.test}catch(t){a.deleteExpando=!1}!j.addEventListener&&j.attachEvent&&j.fireEvent&&(j.attachEvent("onclick",function(){a.noCloneEvent=!1}),j.cloneNode(!0).fireEvent("onclick"));c=s.createElement("input");c.value="t";c.setAttribute("type","radio");a.radioValue=c.value==="t";c.setAttribute("checked",
"checked");j.appendChild(c);e=s.createDocumentFragment();e.appendChild(j.lastChild);a.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked;a.appendChecked=c.checked;e.removeChild(c);e.appendChild(j);j.innerHTML="";if(b.getComputedStyle)c=s.createElement("div"),c.style.width="0",c.style.marginRight="0",j.style.width="2px",j.appendChild(c),a.reliableMarginRight=(parseInt((b.getComputedStyle(c,null)||{marginRight:0}).marginRight,10)||0)===0;if(j.attachEvent)for(m in{submit:1,change:1,focusin:1})c=
"on"+m,k=c in j,k||(j.setAttribute(c,"return;"),k=typeof j[c]==="function"),a[m+"Bubbles"]=k;e.removeChild(j);e=d=f=c=j=c=null;h(function(){var b,c,e,d,f=s.getElementsByTagName("body")[0];if(f){b=s.createElement("div");b.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px";f.insertBefore(b,f.firstChild);j=s.createElement("div");b.appendChild(j);j.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>";g=j.getElementsByTagName("td");
k=g[0].offsetHeight===0;g[0].style.display="";g[1].style.display="none";a.reliableHiddenOffsets=k&&g[0].offsetHeight===0;j.innerHTML="";j.style.width=j.style.paddingLeft="1px";h.boxModel=a.boxModel=j.offsetWidth===2;if(typeof j.style.zoom!=="undefined")j.style.display="inline",j.style.zoom=1,a.inlineBlockNeedsLayout=j.offsetWidth===2,j.style.display="",j.innerHTML="<div style='width:4px;'></div>",a.shrinkWrapBlocks=j.offsetWidth!==2;j.style.cssText="position:absolute;top:0;left:0;width:1px;height:1px;margin:0;visibility:hidden;border:0;";
j.innerHTML="<div style='position:absolute;top:0;left:0;width:1px;height:1px;margin:0;border:5px solid #000;padding:0;'><div></div></div><table style='position:absolute;top:0;left:0;width:1px;height:1px;margin:0;border:5px solid #000;padding:0;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";c=j.firstChild;e=c.firstChild;d={doesNotAddBorder:e.offsetTop!==5,doesAddBorderForTableAndCells:c.nextSibling.firstChild.firstChild.offsetTop===5};e.style.position="fixed";e.style.top="20px";d.fixedPosition=
e.offsetTop===20||e.offsetTop===15;e.style.position=e.style.top="";c.style.overflow="hidden";c.style.position="relative";d.subtractsBorderForOverflowNotVisible=e.offsetTop===-5;d.doesNotIncludeMarginInBodyOffset=f.offsetTop!==1;f.removeChild(b);j=null;h.extend(a,d)}});return a}();var y=/^(?:\{.*\}|\[.*\])$/,B=/([A-Z])/g;h.extend({cache:{},uuid:0,expando:"jQuery"+(h.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=
a.nodeType?h.cache[a[h.expando]]:a[h.expando];return!!a&&!e(a)},data:function(b,c,e,d){if(h.acceptData(b)){var f;f=h.expando;var g=typeof c==="string",m=b.nodeType,j=m?h.cache:b,k=m?b[f]:b[f]&&f,t=c==="events";if(k&&j[k]&&(t||d||j[k].data)||!(g&&e===a)){k||(m?b[f]=k=++h.uuid:k=f);if(!j[k]&&(j[k]={},!m))j[k].toJSON=h.noop;if(typeof c==="object"||typeof c==="function")d?j[k]=h.extend(j[k],c):j[k].data=h.extend(j[k].data,c);f=b=j[k];if(!d){if(!b.data)b.data={};b=b.data}e!==a&&(b[h.camelCase(c)]=e);if(t&&
!b[c])return f.events;g?(e=b[c],e==null&&(e=b[h.camelCase(c)])):e=b;return e}}},removeData:function(a,b,c){if(h.acceptData(a)){var d,f,g,m=h.expando,j=a.nodeType,k=j?h.cache:a,t=j?a[m]:m;if(k[t]){if(b&&(d=c?k[t]:k[t].data)){h.isArray(b)||(b in d?b=[b]:(b=h.camelCase(b),b=b in d?[b]:b.split(" ")));f=0;for(g=b.length;f<g;f++)delete d[b[f]];if(!(c?e:h.isEmptyObject)(d))return}if(!c&&(delete k[t].data,!e(k[t])))return;h.support.deleteExpando||!k.setInterval?delete k[t]:k[t]=null;j&&(h.support.deleteExpando?
delete a[m]:a.removeAttribute?a.removeAttribute(m):a[m]=null)}}},_data:function(a,b,c){return h.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=h.noData[a.nodeName.toLowerCase()];if(b)return!(b===!0||a.getAttribute("classid")!==b)}return!0}});h.fn.extend({data:function(b,c){var e,f,g,m=null;if(typeof b==="undefined"){if(this.length&&(m=h.data(this[0]),this[0].nodeType===1&&!h._data(this[0],"parsedAttrs"))){f=this[0].attributes;for(var j=0,k=f.length;j<k;j++)g=f[j].name,g.indexOf("data-")===
0&&(g=h.camelCase(g.substring(5)),d(this[0],g,m[g]));h._data(this[0],"parsedAttrs",!0)}return m}else if(typeof b==="object")return this.each(function(){h.data(this,b)});e=b.split(".");e[1]=e[1]?"."+e[1]:"";return c===a?(m=this.triggerHandler("getData"+e[1]+"!",[e[0]]),m===a&&this.length&&(m=h.data(this[0],b),m=d(this[0],b,m)),m===a&&e[1]?this.data(e[0]):m):this.each(function(){var a=h(this),d=[e[0],c];a.triggerHandler("setData"+e[1]+"!",d);h.data(this,b,c);a.triggerHandler("changeData"+e[1]+"!",d)})},
removeData:function(a){return this.each(function(){h.removeData(this,a)})}});h.extend({_mark:function(a,b){a&&(b=(b||"fx")+"mark",h._data(a,b,(h._data(a,b)||0)+1))},_unmark:function(a,b,c){a!==!0&&(c=b,b=a,a=!1);if(b){var c=c||"fx",e=c+"mark";(a=a?0:(h._data(b,e)||1)-1)?h._data(b,e,a):(h.removeData(b,e,!0),f(b,c,"mark"))}},queue:function(a,b,c){var e;if(a)return b=(b||"fx")+"queue",e=h._data(a,b),c&&(!e||h.isArray(c)?e=h._data(a,b,h.makeArray(c)):e.push(c)),e||[]},dequeue:function(a,b){var b=b||"fx",
c=h.queue(a,b),e=c.shift(),d={};e==="inprogress"&&(e=c.shift());e&&(b==="fx"&&c.unshift("inprogress"),h._data(a,b+".run",d),e.call(a,function(){h.dequeue(a,b)},d));c.length||(h.removeData(a,b+"queue "+b+".run",!0),f(a,b,"queue"))}});h.fn.extend({queue:function(b,c){typeof b!=="string"&&(c=b,b="fx");return c===a?h.queue(this[0],b):this.each(function(){var a=h.queue(this,b,c);b==="fx"&&a[0]!=="inprogress"&&h.dequeue(this,b)})},dequeue:function(a){return this.each(function(){h.dequeue(this,a)})},delay:function(a,
b){a=h.fx?h.fx.speeds[a]||a:a;return this.queue(b||"fx",function(b,c){var e=setTimeout(b,a);c.stop=function(){clearTimeout(e)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(b){function c(){--g||e.resolveWith(d,[d])}typeof b!=="string"&&(b=a);var b=b||"fx",e=h.Deferred(),d=this,f=d.length,g=1,m=b+"defer",j=b+"queue";b+="mark";for(var k;f--;)if(k=h.data(d[f],m,a,!0)||(h.data(d[f],j,a,!0)||h.data(d[f],b,a,!0))&&h.data(d[f],m,h.Callbacks("once memory"),!0))g++,k.add(c);c();
return e.promise()}});var m=/[\n\t\r]/g,v=/\s+/,G=/\r/g,X=/^(?:button|input)$/i,S=/^(?:button|input|object|select|textarea)$/i,T=/^a(?:rea)?$/i,V=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,ra=h.support.getSetAttribute,W,sa,ta;h.fn.extend({attr:function(a,b){return h.access(this,a,b,!0,h.attr)},removeAttr:function(a){return this.each(function(){h.removeAttr(this,a)})},prop:function(a,b){return h.access(this,a,b,!0,h.prop)},
removeProp:function(b){b=h.propFix[b]||b;return this.each(function(){try{this[b]=a,delete this[b]}catch(c){}})},addClass:function(a){var b,c,e,d,f,g,m;if(h.isFunction(a))return this.each(function(b){h(this).addClass(a.call(this,b,this.className))});if(a&&typeof a==="string"){b=a.split(v);c=0;for(e=this.length;c<e;c++)if(d=this[c],d.nodeType===1)if(!d.className&&b.length===1)d.className=a;else{f=" "+d.className+" ";g=0;for(m=b.length;g<m;g++)~f.indexOf(" "+b[g]+" ")||(f+=b[g]+" ");d.className=h.trim(f)}}return this},
removeClass:function(b){var c,e,d,f,g,j,k;if(h.isFunction(b))return this.each(function(a){h(this).removeClass(b.call(this,a,this.className))});if(b&&typeof b==="string"||b===a){c=(b||"").split(v);e=0;for(d=this.length;e<d;e++)if(f=this[e],f.nodeType===1&&f.className)if(b){g=(" "+f.className+" ").replace(m," ");j=0;for(k=c.length;j<k;j++)g=g.replace(" "+c[j]+" "," ");f.className=h.trim(g)}else f.className=""}return this},toggleClass:function(a,b){var c=typeof a,e=typeof b==="boolean";return h.isFunction(a)?
this.each(function(c){h(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if(c==="string")for(var d,f=0,g=h(this),m=b,j=a.split(v);d=j[f++];)m=e?m:!g.hasClass(d),g[m?"addClass":"removeClass"](d);else if(c==="undefined"||c==="boolean")this.className&&h._data(this,"__className__",this.className),this.className=this.className||a===!1?"":h._data(this,"__className__")||""})},hasClass:function(a){for(var a=" "+a+" ",b=0,c=this.length;b<c;b++)if(this[b].nodeType===1&&(" "+this[b].className+
" ").replace(m," ").indexOf(a)>-1)return!0;return!1},val:function(b){var c,e,d,f=this[0];if(arguments.length)return d=h.isFunction(b),this.each(function(e){var f=h(this);if(this.nodeType===1&&(e=d?b.call(this,e,f.val()):b,e==null?e="":typeof e==="number"?e+="":h.isArray(e)&&(e=h.map(e,function(a){return a==null?"":a+""})),c=h.valHooks[this.nodeName.toLowerCase()]||h.valHooks[this.type],!c||!("set"in c)||c.set(this,e,"value")===a))this.value=e});else if(f){if((c=h.valHooks[f.nodeName.toLowerCase()]||
h.valHooks[f.type])&&"get"in c&&(e=c.get(f,"value"))!==a)return e;e=f.value;return typeof e==="string"?e.replace(G,""):e==null?"":e}}});h.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,e=a.selectedIndex,d=[],f=a.options,g=a.type==="select-one";if(e<0)return null;a=g?e:0;for(c=g?e+1:f.length;a<c;a++)if(b=f[a],b.selected&&(h.support.optDisabled?!b.disabled:b.getAttribute("disabled")===null)&&(!b.parentNode.disabled||
!h.nodeName(b.parentNode,"optgroup"))){b=h(b).val();if(g)return b;d.push(b)}return g&&!d.length&&f.length?h(f[e]).val():d},set:function(a,b){var c=h.makeArray(b);h(a).find("option").each(function(){this.selected=h.inArray(h(this).val(),c)>=0});if(!c.length)a.selectedIndex=-1;return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(b,c,e,d){var f,g,m=b.nodeType;if(b&&!(m===3||m===8||m===2)){if(d&&c in h.attrFn)return h(b)[c](e);if(typeof b.getAttribute===
"undefined")return h.prop(b,c,e);if(d=m!==1||!h.isXMLDoc(b))c=c.toLowerCase(),g=h.attrHooks[c]||(V.test(c)?sa:W);if(e!==a)if(e===null)h.removeAttr(b,c);else return g&&"set"in g&&d&&(f=g.set(b,e,c))!==a?f:(b.setAttribute(c,""+e),e);else return g&&"get"in g&&d&&(f=g.get(b,c))!==null?f:(f=b.getAttribute(c),f===null?a:f)}},removeAttr:function(a,b){var c,e,d,f,g=0;if(b&&a.nodeType===1){e=b.toLowerCase().split(v);for(f=e.length;g<f;g++)if(d=e[g])c=h.propFix[d]||d,h.attr(a,d,""),a.removeAttribute(ra?d:c),
V.test(d)&&c in a&&(a[c]=!1)}},attrHooks:{type:{set:function(a,b){if(X.test(a.nodeName)&&a.parentNode)h.error("type property can't be changed");else if(!h.support.radioValue&&b==="radio"&&h.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b);if(c)a.value=c;return b}}},value:{get:function(a,b){return W&&h.nodeName(a,"button")?W.get(a,b):b in a?a.value:null},set:function(a,b,c){if(W&&h.nodeName(a,"button"))return W.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor",
"class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(b,c,e){var d,f,g=b.nodeType;if(b&&!(g===3||g===8||g===2)){if(g!==1||!h.isXMLDoc(b))c=h.propFix[c]||c,f=h.propHooks[c];return e!==a?f&&"set"in f&&(d=f.set(b,e,c))!==a?d:b[c]=e:f&&"get"in f&&(d=f.get(b,c))!==null?d:b[c]}},propHooks:{tabIndex:{get:function(b){var c=b.getAttributeNode("tabindex");
return c&&c.specified?parseInt(c.value,10):S.test(b.nodeName)||T.test(b.nodeName)&&b.href?0:a}}}});h.attrHooks.tabindex=h.propHooks.tabIndex;sa={get:function(b,c){var e,d=h.prop(b,c);return d===!0||typeof d!=="boolean"&&(e=b.getAttributeNode(c))&&e.nodeValue!==!1?c.toLowerCase():a},set:function(a,b,c){b===!1?h.removeAttr(a,c):(b=h.propFix[c]||c,b in a&&(a[b]=!0),a.setAttribute(c,c.toLowerCase()));return c}};if(!ra)ta={name:!0,id:!0},W=h.valHooks.button={get:function(b,c){var e;return(e=b.getAttributeNode(c))&&
(ta[c]?e.nodeValue!=="":e.specified)?e.nodeValue:a},set:function(a,b,c){var e=a.getAttributeNode(c);e||(e=s.createAttribute(c),a.setAttributeNode(e));return e.nodeValue=b+""}},h.attrHooks.tabindex.set=W.set,h.each(["width","height"],function(a,b){h.attrHooks[b]=h.extend(h.attrHooks[b],{set:function(a,c){if(c==="")return a.setAttribute(b,"auto"),c}})}),h.attrHooks.contenteditable={get:W.get,set:function(a,b,c){b===""&&(b="false");W.set(a,b,c)}};h.support.hrefNormalized||h.each(["href","src","width",
"height"],function(b,c){h.attrHooks[c]=h.extend(h.attrHooks[c],{get:function(b){b=b.getAttribute(c,2);return b===null?a:b}})});if(!h.support.style)h.attrHooks.style={get:function(b){return b.style.cssText.toLowerCase()||a},set:function(a,b){return a.style.cssText=""+b}};if(!h.support.optSelected)h.propHooks.selected=h.extend(h.propHooks.selected,{get:function(){return null}});if(!h.support.enctype)h.propFix.enctype="encoding";h.support.checkOn||h.each(["radio","checkbox"],function(){h.valHooks[this]=
{get:function(a){return a.getAttribute("value")===null?"on":a.value}}});h.each(["radio","checkbox"],function(){h.valHooks[this]=h.extend(h.valHooks[this],{set:function(a,b){if(h.isArray(b))return a.checked=h.inArray(h(a).val(),b)>=0}})});var ka=/^(?:textarea|input|select)$/i,ua=/^([^\.]*)?(?:\.(.+))?$/,Sa=/\bhover(\.\S+)?\b/,Ta=/^key/,Ua=/^(?:mouse|contextmenu)|click/,va=/^(?:focusinfocus|focusoutblur)$/,Va=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,Wa=function(a){if(a=Va.exec(a))a[1]=(a[1]||"").toLowerCase(),
a[3]=a[3]&&RegExp("(?:^|\\s)"+a[3]+"(?:\\s|$)");return a},wa=function(a){return h.event.special.hover?a:a.replace(Sa,"mouseenter$1 mouseleave$1")};h.event={add:function(b,c,e,d,f){var g,m,j,k,t,v,l,y,p;if(!(b.nodeType===3||b.nodeType===8||!c||!e||!(g=h._data(b)))){if(e.handler)l=e,e=l.handler;if(!e.guid)e.guid=h.guid++;j=g.events;if(!j)g.events=j={};m=g.handle;if(!m)g.handle=m=function(b){return typeof h!=="undefined"&&(!b||h.event.triggered!==b.type)?h.event.dispatch.apply(m.elem,arguments):a},m.elem=
b;c=h.trim(wa(c)).split(" ");for(g=0;g<c.length;g++){k=ua.exec(c[g])||[];t=k[1];v=(k[2]||"").split(".").sort();p=h.event.special[t]||{};t=(f?p.delegateType:p.bindType)||t;p=h.event.special[t]||{};k=h.extend({type:t,origType:k[1],data:d,handler:e,guid:e.guid,selector:f,quick:Wa(f),namespace:v.join(".")},l);y=j[t];if(!y&&(y=j[t]=[],y.delegateCount=0,!p.setup||p.setup.call(b,d,v,m)===!1))b.addEventListener?b.addEventListener(t,m,!1):b.attachEvent&&b.attachEvent("on"+t,m);if(p.add&&(p.add.call(b,k),!k.handler.guid))k.handler.guid=
e.guid;f?y.splice(y.delegateCount++,0,k):y.push(k);h.event.global[t]=!0}b=null}},global:{},remove:function(a,b,c,e,d){var f=h.hasData(a)&&h._data(a),g,m,j,k,t,v,l,y,p,o;if(f&&(l=f.events)){b=h.trim(wa(b||"")).split(" ");for(g=0;g<b.length;g++)if(m=ua.exec(b[g])||[],j=k=m[1],m=m[2],j){y=h.event.special[j]||{};j=(e?y.delegateType:y.bindType)||j;p=l[j]||[];t=p.length;m=m?RegExp("(^|\\.)"+m.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;for(v=0;v<p.length;v++)if(o=p[v],(d||k===o.origType)&&(!c||
c.guid===o.guid)&&(!m||m.test(o.namespace))&&(!e||e===o.selector||e==="**"&&o.selector))p.splice(v--,1),o.selector&&p.delegateCount--,y.remove&&y.remove.call(a,o);p.length===0&&t!==p.length&&((!y.teardown||y.teardown.call(a,m)===!1)&&h.removeEvent(a,j,f.handle),delete l[j])}else for(j in l)h.event.remove(a,j+b[g],c,e,!0);if(h.isEmptyObject(l)){if(b=f.handle)b.elem=null;h.removeData(a,["events","handle"],!0)}}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,e,d,f){if(!d||!(d.nodeType===
3||d.nodeType===8)){var g=c.type||c,m=[],j,k,t,v,l;if(!va.test(g+h.event.triggered)&&(g.indexOf("!")>=0&&(g=g.slice(0,-1),j=!0),g.indexOf(".")>=0&&(m=g.split("."),g=m.shift(),m.sort()),d&&!h.event.customEvent[g]||h.event.global[g]))if(c=typeof c==="object"?c[h.expando]?c:new h.Event(g,c):new h.Event(g),c.type=g,c.isTrigger=!0,c.exclusive=j,c.namespace=m.join("."),c.namespace_re=c.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,j=g.indexOf(":")<0?"on"+g:"",d){c.result=a;if(!c.target)c.target=
d;e=e!=null?h.makeArray(e):[];e.unshift(c);t=h.event.special[g]||{};if(!(t.trigger&&t.trigger.apply(d,e)===!1)){l=[[d,t.bindType||g]];if(!f&&!t.noBubble&&!h.isWindow(d)){v=t.delegateType||g;m=va.test(v+g)?d:d.parentNode;for(k=null;m;m=m.parentNode)l.push([m,v]),k=m;k&&k===d.ownerDocument&&l.push([k.defaultView||k.parentWindow||b,v])}for(k=0;k<l.length&&!c.isPropagationStopped();k++)m=l[k][0],c.type=l[k][1],(v=(h._data(m,"events")||{})[c.type]&&h._data(m,"handle"))&&v.apply(m,e),(v=j&&m[j])&&h.acceptData(m)&&
v.apply(m,e)===!1&&c.preventDefault();c.type=g;if(!f&&!c.isDefaultPrevented()&&(!t._default||t._default.apply(d.ownerDocument,e)===!1)&&!(g==="click"&&h.nodeName(d,"a"))&&h.acceptData(d))if(j&&d[g]&&(g!=="focus"&&g!=="blur"||c.target.offsetWidth!==0)&&!h.isWindow(d))(k=d[j])&&(d[j]=null),h.event.triggered=g,d[g](),h.event.triggered=a,k&&(d[j]=k);return c.result}}else for(k in d=h.cache,d)d[k].events&&d[k].events[g]&&h.event.trigger(c,e,d[k].handle.elem,!0)}},dispatch:function(c){var c=h.event.fix(c||
b.event),e=(h._data(this,"events")||{})[c.type]||[],d=e.delegateCount,f=[].slice.call(arguments,0),g=!c.exclusive&&!c.namespace,m=[],j,k,t,v,l,y,p;f[0]=c;c.delegateTarget=this;if(d&&!c.target.disabled&&!(c.button&&c.type==="click")){t=h(this);t.context=this.ownerDocument||this;for(k=c.target;k!=this;k=k.parentNode||this){l={};y=[];t[0]=k;for(j=0;j<d;j++){v=e[j];p=v.selector;if(l[p]===a){var o=l,q=p,G;if(v.quick){G=v.quick;var n=k.attributes||{};G=(!G[1]||k.nodeName.toLowerCase()===G[1])&&(!G[2]||
(n.id||{}).value===G[2])&&(!G[3]||G[3].test((n["class"]||{}).value))}else G=t.is(p);o[q]=G}l[p]&&y.push(v)}y.length&&m.push({elem:k,matches:y})}}e.length>d&&m.push({elem:this,matches:e.slice(d)});for(j=0;j<m.length&&!c.isPropagationStopped();j++){d=m[j];c.currentTarget=d.elem;for(e=0;e<d.matches.length&&!c.isImmediatePropagationStopped();e++)if(v=d.matches[e],g||!c.namespace&&!v.namespace||c.namespace_re&&c.namespace_re.test(v.namespace))if(c.data=v.data,c.handleObj=v,v=((h.event.special[v.origType]||
{}).handle||v.handler).apply(d.elem,f),v!==a)c.result=v,v===!1&&(c.preventDefault(),c.stopPropagation())}return c.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){if(a.which==null)a.which=b.charCode!=null?b.charCode:b.keyCode;return a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
filter:function(b,c){var e,d,f=c.button,h=c.fromElement;if(b.pageX==null&&c.clientX!=null)e=b.target.ownerDocument||s,d=e.documentElement,e=e.body,b.pageX=c.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0),b.pageY=c.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0);if(!b.relatedTarget&&h)b.relatedTarget=h===b.target?c.toElement:h;if(!b.which&&f!==a)b.which=f&1?1:f&2?3:f&4?2:0;return b}},fix:function(b){if(b[h.expando])return b;var c,
e,d=b,f=h.event.fixHooks[b.type]||{},g=f.props?this.props.concat(f.props):this.props,b=h.Event(d);for(c=g.length;c;)e=g[--c],b[e]=d[e];if(!b.target)b.target=d.srcElement||s;if(b.target.nodeType===3)b.target=b.target.parentNode;if(b.metaKey===a)b.metaKey=b.ctrlKey;return f.filter?f.filter(b,d):b},special:{ready:{setup:h.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){if(h.isWindow(this))this.onbeforeunload=c},teardown:function(a,
b){if(this.onbeforeunload===b)this.onbeforeunload=null}}},simulate:function(a,b,c,e){a=h.extend(new h.Event,c,{type:a,isSimulated:!0,originalEvent:{}});e?h.event.trigger(a,null,b):h.event.dispatch.call(b,a);a.isDefaultPrevented()&&c.preventDefault()}};h.event.handle=h.event.dispatch;h.removeEvent=s.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)};h.Event=function(a,b){if(!(this instanceof h.Event))return new h.Event(a,
b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?k:j):this.type=a;b&&h.extend(this,b);this.timeStamp=a&&a.timeStamp||h.now();this[h.expando]=!0};h.Event.prototype={preventDefault:function(){this.isDefaultPrevented=k;var a=this.originalEvent;if(a)a.preventDefault?a.preventDefault():a.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=k;var a=this.originalEvent;if(a)a.stopPropagation&&
a.stopPropagation(),a.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=k;this.stopPropagation()},isDefaultPrevented:j,isPropagationStopped:j,isImmediatePropagationStopped:j};h.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){h.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c=a.relatedTarget,e=a.handleObj,d;if(!c||c!==this&&!h.contains(this,c))a.type=e.origType,d=e.handler.apply(this,arguments),a.type=b;return d}}});if(!h.support.submitBubbles)h.event.special.submit=
{setup:function(){if(h.nodeName(this,"form"))return!1;h.event.add(this,"click._submit keypress._submit",function(b){b=b.target;if((b=h.nodeName(b,"input")||h.nodeName(b,"button")?b.form:a)&&!b._submit_attached)h.event.add(b,"submit._submit",function(a){this.parentNode&&!a.isTrigger&&h.event.simulate("submit",this.parentNode,a,!0)}),b._submit_attached=!0})},teardown:function(){if(h.nodeName(this,"form"))return!1;h.event.remove(this,"._submit")}};if(!h.support.changeBubbles)h.event.special.change={setup:function(){if(ka.test(this.nodeName)){if(this.type===
"checkbox"||this.type==="radio")h.event.add(this,"propertychange._change",function(a){if(a.originalEvent.propertyName==="checked")this._just_changed=!0}),h.event.add(this,"click._change",function(a){if(this._just_changed&&!a.isTrigger)this._just_changed=!1,h.event.simulate("change",this,a,!0)});return!1}h.event.add(this,"beforeactivate._change",function(a){a=a.target;if(ka.test(a.nodeName)&&!a._change_attached)h.event.add(a,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&
h.event.simulate("change",this.parentNode,a,!0)}),a._change_attached=!0})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!=="radio"&&b.type!=="checkbox")return a.handleObj.handler.apply(this,arguments)},teardown:function(){h.event.remove(this,"._change");return ka.test(this.nodeName)}};h.support.focusinBubbles||h.each({focus:"focusin",blur:"focusout"},function(a,b){var c=0,e=function(a){h.event.simulate(b,a.target,h.event.fix(a),!0)};h.event.special[b]={setup:function(){c++===
0&&s.addEventListener(a,e,!0)},teardown:function(){--c===0&&s.removeEventListener(a,e,!0)}}});h.fn.extend({on:function(b,c,e,d,f){var g,m;if(typeof b==="object"){typeof c!=="string"&&(e=c,c=a);for(m in b)this.on(m,c,e,b[m],f);return this}e==null&&d==null?(d=c,e=c=a):d==null&&(typeof c==="string"?(d=e,e=a):(d=e,e=c,c=a));if(d===!1)d=j;else if(!d)return this;if(f===1)g=d,d=function(a){h().off(a);return g.apply(this,arguments)},d.guid=g.guid||(g.guid=h.guid++);return this.each(function(){h.event.add(this,
b,d,e,c)})},one:function(a,b,c,e){return this.on.call(this,a,b,c,e,1)},off:function(b,c,e){if(b&&b.preventDefault&&b.handleObj){var d=b.handleObj;h(b.delegateTarget).off(d.namespace?d.type+"."+d.namespace:d.type,d.selector,d.handler);return this}if(typeof b==="object"){for(d in b)this.off(d,c,b[d]);return this}if(c===!1||typeof c==="function")e=c,c=a;e===!1&&(e=j);return this.each(function(){h.event.remove(this,b,e,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,
null,b)},live:function(a,b,c){h(this.context).on(a,this.selector,b,c);return this},die:function(a,b){h(this.context).off(a,this.selector||"**",b);return this},delegate:function(a,b,c,e){return this.on(b,a,c,e)},undelegate:function(a,b,c){return arguments.length==1?this.off(a,"**"):this.off(b,a,c)},trigger:function(a,b){return this.each(function(){h.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return h.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||
h.guid++,e=0,d=function(c){var d=(h._data(this,"lastToggle"+a.guid)||0)%e;h._data(this,"lastToggle"+a.guid,d+1);c.preventDefault();return b[d].apply(this,arguments)||!1};for(d.guid=c;e<b.length;)b[e++].guid=c;return this.click(d)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}});h.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),
function(a,b){h.fn[b]=function(a,c){c==null&&(c=a,a=null);return arguments.length>0?this.on(b,null,a,c):this.trigger(b)};h.attrFn&&(h.attrFn[b]=!0);if(Ta.test(b))h.event.fixHooks[b]=h.event.keyHooks;if(Ua.test(b))h.event.fixHooks[b]=h.event.mouseHooks});(function(){function b(a,c,e,f,h,g){for(var h=0,m=f.length;h<m;h++){var j=f[h];if(j){for(var k=!1,j=j[a];j;){if(j[d]===e){k=f[j.sizset];break}if(j.nodeType===1&&!g)j[d]=e,j.sizset=h;if(j.nodeName.toLowerCase()===c){k=j;break}j=j[a]}f[h]=k}}}function c(a,
b,e,f,h,g){for(var h=0,m=f.length;h<m;h++){var j=f[h];if(j){for(var k=!1,j=j[a];j;){if(j[d]===e){k=f[j.sizset];break}if(j.nodeType===1){if(!g)j[d]=e,j.sizset=h;if(typeof b!=="string"){if(j===b){k=!0;break}}else if(l.filter(b,[j]).length>0){k=j;break}}j=j[a]}f[h]=k}}}var e=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d="sizcache"+(Math.random()+"").replace(".",""),f=0,g=Object.prototype.toString,m=!1,j=!0,k=/\\/g,
t=/\r\n/g,v=/\W/;[0,0].sort(function(){j=!1;return 0});var l=function(a,b,c,d){var c=c||[],f=b=b||s;if(b.nodeType!==1&&b.nodeType!==9)return[];if(!a||typeof a!=="string")return c;var h,m,j,k,w,t=!0,v=l.isXML(b),E=[],y=a;do if(e.exec(""),h=e.exec(y))if(y=h[3],E.push(h[1]),h[2]){k=h[3];break}while(h);if(E.length>1&&o.exec(a))if(E.length===2&&p.relative[E[0]])m=r(E[0]+E[1],b,d);else for(m=p.relative[E[0]]?[b]:l(E.shift(),b);E.length;)a=E.shift(),p.relative[a]&&(a+=E.shift()),m=r(a,m,d);else if(!d&&E.length>
1&&b.nodeType===9&&!v&&p.match.ID.test(E[0])&&!p.match.ID.test(E[E.length-1])&&(h=l.find(E.shift(),b,v),b=h.expr?l.filter(h.expr,h.set)[0]:h.set[0]),b){h=d?{expr:E.pop(),set:n(d)}:l.find(E.pop(),E.length===1&&(E[0]==="~"||E[0]==="+")&&b.parentNode?b.parentNode:b,v);m=h.expr?l.filter(h.expr,h.set):h.set;for(E.length>0?j=n(m):t=!1;E.length;)h=w=E.pop(),p.relative[w]?h=E.pop():w="",h==null&&(h=b),p.relative[w](j,h,v)}else j=[];j||(j=m);j||l.error(w||a);if(g.call(j)==="[object Array]")if(t)if(b&&b.nodeType===
1)for(a=0;j[a]!=null;a++)j[a]&&(j[a]===!0||j[a].nodeType===1&&l.contains(b,j[a]))&&c.push(m[a]);else for(a=0;j[a]!=null;a++)j[a]&&j[a].nodeType===1&&c.push(m[a]);else c.push.apply(c,j);else n(j,c);k&&(l(k,f,c,d),l.uniqueSort(c));return c};l.uniqueSort=function(a){if(B&&(m=j,a.sort(B),m))for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1);return a};l.matches=function(a,b){return l(a,null,null,b)};l.matchesSelector=function(a,b){return l(b,null,null,[a]).length>0};l.find=function(a,b,c){var e,
d,f,h,g,m;if(!a)return[];d=0;for(f=p.order.length;d<f;d++)if(g=p.order[d],h=p.leftMatch[g].exec(a))if(m=h[1],h.splice(1,1),m.substr(m.length-1)!=="\\"&&(h[1]=(h[1]||"").replace(k,""),e=p.find[g](h,b,c),e!=null)){a=a.replace(p.match[g],"");break}e||(e=typeof b.getElementsByTagName!=="undefined"?b.getElementsByTagName("*"):[]);return{set:e,expr:a}};l.filter=function(b,c,e,d){for(var f,h,g,m,j,k,w,t,v=b,E=[],y=c,H=c&&c[0]&&l.isXML(c[0]);b&&c.length;){for(g in p.filter)if((f=p.leftMatch[g].exec(b))!=
null&&f[2])if(k=p.filter[g],j=f[1],h=!1,f.splice(1,1),j.substr(j.length-1)!=="\\"){y===E&&(E=[]);if(p.preFilter[g])if(f=p.preFilter[g](f,y,e,E,d,H)){if(f===!0)continue}else h=m=!0;if(f)for(w=0;(j=y[w])!=null;w++)j&&(m=k(j,f,w,y),t=d^m,e&&m!=null?t?h=!0:y[w]=!1:t&&(E.push(j),h=!0));if(m!==a){e||(y=E);b=b.replace(p.match[g],"");if(!h)return[];break}}if(b===v)if(h==null)l.error(b);else break;v=b}return y};l.error=function(a){throw Error("Syntax error, unrecognized expression: "+a);};var y=l.getText=
function(a){var b,c;b=a.nodeType;var e="";if(b)if(b===1||b===9)if(typeof a.textContent==="string")return a.textContent;else if(typeof a.innerText==="string")return a.innerText.replace(t,"");else for(a=a.firstChild;a;a=a.nextSibling)e+=y(a);else{if(b===3||b===4)return a.nodeValue}else for(b=0;c=a[b];b++)c.nodeType!==8&&(e+=y(c));return e},p=l.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,
ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},
type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b==="string",e=c&&!v.test(b),c=c&&!e;e&&(b=b.toLowerCase());for(var e=0,d=a.length,f;e<d;e++)if(f=a[e]){for(;(f=f.previousSibling)&&f.nodeType!==1;);a[e]=c||f&&f.nodeName.toLowerCase()===b?f||!1:f===b}c&&l.filter(b,a,!0)},">":function(a,b){var c,e=typeof b==="string",d=0,f=a.length;if(e&&!v.test(b))for(b=b.toLowerCase();d<f;d++){if(c=a[d])c=c.parentNode,a[d]=c.nodeName.toLowerCase()===b?c:!1}else{for(;d<f;d++)(c=
a[d])&&(a[d]=e?c.parentNode:c.parentNode===b);e&&l.filter(b,a,!0)}},"":function(a,e,d){var h,g=f++,m=c;typeof e==="string"&&!v.test(e)&&(h=e=e.toLowerCase(),m=b);m("parentNode",e,g,a,h,d)},"~":function(a,e,d){var h,g=f++,m=c;typeof e==="string"&&!v.test(e)&&(h=e=e.toLowerCase(),m=b);m("previousSibling",e,g,a,h,d)}},find:{ID:function(a,b,c){if(typeof b.getElementById!=="undefined"&&!c)return(a=b.getElementById(a[1]))&&a.parentNode?[a]:[]},NAME:function(a,b){if(typeof b.getElementsByName!=="undefined"){for(var c=
[],e=b.getElementsByName(a[1]),d=0,f=e.length;d<f;d++)e[d].getAttribute("name")===a[1]&&c.push(e[d]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!=="undefined")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,e,d,f){a=" "+a[1].replace(k,"")+" ";if(f)return a;for(var f=0,h;(h=b[f])!=null;f++)h&&(d^(h.className&&(" "+h.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||e.push(h):c&&(b[f]=!1));return!1},ID:function(a){return a[1].replace(k,
"")},TAG:function(a){return a[1].replace(k,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||l.error(a[0]);a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0;a[3]=b[3]-0}else a[2]&&l.error(a[0]);a[0]=f++;return a},ATTR:function(a,b,c,e,d,f){b=a[1]=a[1].replace(k,"");!f&&p.attrMap[b]&&(a[1]=p.attrMap[b]);a[4]=(a[4]||a[5]||"").replace(k,"");a[2]==="~="&&(a[4]=" "+a[4]+
" ");return a},PSEUDO:function(a,b,c,d,f){if(a[1]==="not")if((e.exec(a[3])||"").length>1||/^\w/.test(a[3]))a[3]=l(a[3],null,null,b);else return a=l.filter(a[3],b,c,1^f),c||d.push.apply(d,a),!1;else if(p.match.POS.test(a[0])||p.match.CHILD.test(a[0]))return!0;return a},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){return a.selected===
!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!l(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()===
"input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},
focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,e){return b===e.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,e){var d=b[1],f=p.filters[d];if(f)return f(a,c,b,e);else if(d==="contains")return(a.textContent||a.innerText||
y([a])||"").indexOf(b[3])>=0;else if(d==="not"){b=b[3];c=0;for(e=b.length;c<e;c++)if(b[c]===a)return!1;return!0}else l.error(d)},CHILD:function(a,b){var c,e,f,h,g,m;c=b[1];m=a;switch(c){case "only":case "first":for(;m=m.previousSibling;)if(m.nodeType===1)return!1;if(c==="first")return!0;m=a;case "last":for(;m=m.nextSibling;)if(m.nodeType===1)return!1;return!0;case "nth":c=b[2];e=b[3];if(c===1&&e===0)return!0;f=b[0];if((h=a.parentNode)&&(h[d]!==f||!a.nodeIndex)){g=0;for(m=h.firstChild;m;m=m.nextSibling)if(m.nodeType===
1)m.nodeIndex=++g;h[d]=f}m=a.nodeIndex-e;return c===0?m===0:m%c===0&&m/c>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||!!a.nodeName&&a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],c=l.attr?l.attr(a,c):p.attrHandle[c]?p.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=c+"",d=b[2],f=b[4];return c==null?d==="!=":!d&&l.attr?
c!=null:d==="="?e===f:d==="*="?e.indexOf(f)>=0:d==="~="?(" "+e+" ").indexOf(f)>=0:!f?e&&c!==!1:d==="!="?e!==f:d==="^="?e.indexOf(f)===0:d==="$="?e.substr(e.length-f.length)===f:d==="|="?e===f||e.substr(0,f.length+1)===f+"-":!1},POS:function(a,b,c,e){var d=p.setFilters[b[2]];if(d)return d(a,c,b,e)}}},o=p.match.POS,G=function(a,b){return"\\"+(b-0+1)},q;for(q in p.match)p.match[q]=RegExp(p.match[q].source+/(?![^\[]*\])(?![^\(]*\))/.source),p.leftMatch[q]=RegExp(/(^(?:.|\r|\n)*?)/.source+p.match[q].source.replace(/\\(\d+)/g,
G));var n=function(a,b){a=Array.prototype.slice.call(a,0);return b?(b.push.apply(b,a),b):a};try{Array.prototype.slice.call(s.documentElement.childNodes,0)}catch(I){n=function(a,b){var c=0,e=b||[];if(g.call(a)==="[object Array]")Array.prototype.push.apply(e,a);else if(typeof a.length==="number")for(var d=a.length;c<d;c++)e.push(a[c]);else for(;a[c];c++)e.push(a[c]);return e}}var B,A;s.documentElement.compareDocumentPosition?B=function(a,b){return a===b?(m=!0,0):!a.compareDocumentPosition||!b.compareDocumentPosition?
a.compareDocumentPosition?-1:1:a.compareDocumentPosition(b)&4?-1:1}:(B=function(a,b){if(a===b)return m=!0,0;else if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,e,d=[],f=[];c=a.parentNode;e=b.parentNode;var h=c;if(c===e)return A(a,b);else if(c){if(!e)return 1}else return-1;for(;h;)d.unshift(h),h=h.parentNode;for(h=e;h;)f.unshift(h),h=h.parentNode;c=d.length;e=f.length;for(h=0;h<c&&h<e;h++)if(d[h]!==f[h])return A(d[h],f[h]);return h===c?A(a,f[h],-1):A(d[h],b,1)},A=function(a,
b,c){if(a===b)return c;for(a=a.nextSibling;a;){if(a===b)return-1;a=a.nextSibling}return 1});(function(){var b=s.createElement("div"),c="script"+(new Date).getTime(),e=s.documentElement;b.innerHTML="<a name='"+c+"'/>";e.insertBefore(b,e.firstChild);if(s.getElementById(c))p.find.ID=function(b,c,e){if(typeof c.getElementById!=="undefined"&&!e)return(c=c.getElementById(b[1]))?c.id===b[1]||typeof c.getAttributeNode!=="undefined"&&c.getAttributeNode("id").nodeValue===b[1]?[c]:a:[]},p.filter.ID=function(a,
b){var c=typeof a.getAttributeNode!=="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b};e.removeChild(b);e=b=null})();(function(){var a=s.createElement("div");a.appendChild(s.createComment(""));if(a.getElementsByTagName("*").length>0)p.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){for(var e=[],d=0;c[d];d++)c[d].nodeType===1&&e.push(c[d]);c=e}return c};a.innerHTML="<a href='#'></a>";if(a.firstChild&&typeof a.firstChild.getAttribute!=="undefined"&&
a.firstChild.getAttribute("href")!=="#")p.attrHandle.href=function(a){return a.getAttribute("href",2)};a=null})();s.querySelectorAll&&function(){var a=l,b=s.createElement("div");b.innerHTML="<p class='TEST'></p>";if(!(b.querySelectorAll&&b.querySelectorAll(".TEST").length===0)){l=function(b,c,e,d){c=c||s;if(!d&&!l.isXML(c)){var f=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(f&&(c.nodeType===1||c.nodeType===9))if(f[1])return n(c.getElementsByTagName(b),e);else if(f[2]&&p.find.CLASS&&c.getElementsByClassName)return n(c.getElementsByClassName(f[2]),
e);if(c.nodeType===9){if(b==="body"&&c.body)return n([c.body],e);else if(f&&f[3]){var h=c.getElementById(f[3]);if(h&&h.parentNode){if(h.id===f[3])return n([h],e)}else return n([],e)}try{return n(c.querySelectorAll(b),e)}catch(g){}}else if(c.nodeType===1&&c.nodeName.toLowerCase()!=="object"){var f=c,m=(h=c.getAttribute("id"))||"__sizzle__",j=c.parentNode,k=/^\s*[+~]/.test(b);h?m=m.replace(/'/g,"\\$&"):c.setAttribute("id",m);if(k&&j)c=c.parentNode;try{if(!k||j)return n(c.querySelectorAll("[id='"+m+
"'] "+b),e)}catch(w){}finally{h||f.removeAttribute("id")}}}return a(b,c,e,d)};for(var c in a)l[c]=a[c];b=null}}();(function(){var a=s.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var c=!b.call(s.createElement("div"),"div"),e=!1;try{b.call(s.documentElement,"[test!='']:sizzle")}catch(d){e=!0}l.matchesSelector=function(a,d){d=d.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!l.isXML(a))try{if(e||!p.match.PSEUDO.test(d)&&!/!=/.test(d)){var f=
b.call(a,d);if(f||!c||a.document&&a.document.nodeType!==11)return f}}catch(h){}return l(d,null,null,[a]).length>0}}})();(function(){var a=s.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(a.getElementsByClassName&&a.getElementsByClassName("e").length!==0&&(a.lastChild.className="e",a.getElementsByClassName("e").length!==1))p.order.splice(1,0,"CLASS"),p.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!=="undefined"&&!c)return b.getElementsByClassName(a[1])},
a=null})();l.contains=s.documentElement.contains?function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:s.documentElement.compareDocumentPosition?function(a,b){return!!(a.compareDocumentPosition(b)&16)}:function(){return!1};l.isXML=function(a){return(a=(a?a.ownerDocument||a:0).documentElement)?a.nodeName!=="HTML":!1};var r=function(a,b,c){for(var e,d=[],f="",b=b.nodeType?[b]:b;e=p.match.PSEUDO.exec(a);)f+=e[0],a=a.replace(p.match.PSEUDO,"");a=p.relative[a]?a+"*":a;e=0;for(var h=b.length;e<h;e++)l(a,
b[e],d,c);return l.filter(f,d)};l.attr=h.attr;l.selectors.attrMap={};h.find=l;h.expr=l.selectors;h.expr[":"]=h.expr.filters;h.unique=l.uniqueSort;h.text=l.getText;h.isXMLDoc=l.isXML;h.contains=l.contains})();var Xa=/Until$/,Ya=/^(?:parents|prevUntil|prevAll)/,Za=/,/,Na=/^.[^:#\[\.,]*$/,$a=Array.prototype.slice,xa=h.expr.match.POS,ab={children:!0,contents:!0,next:!0,prev:!0};h.fn.extend({find:function(a){var b=this,c,e;if(typeof a!=="string")return h(a).filter(function(){c=0;for(e=b.length;c<e;c++)if(h.contains(b[c],
this))return!0});var d=this.pushStack("","find",a),f,g,m;c=0;for(e=this.length;c<e;c++)if(f=d.length,h.find(a,this[c],d),c>0)for(g=f;g<d.length;g++)for(m=0;m<f;m++)if(d[m]===d[g]){d.splice(g--,1);break}return d},has:function(a){var b=h(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(h.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(l(this,a,!1),"not",a)},filter:function(a){return this.pushStack(l(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a===
"string"?xa.test(a)?h(a,this.context).index(this[0])>=0:h.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c=[],e,d,f=this[0];if(h.isArray(a)){for(d=1;f&&f.ownerDocument&&f!==b;){for(e=0;e<a.length;e++)h(f).is(a[e])&&c.push({selector:a[e],elem:f,level:d});f=f.parentNode;d++}return c}var g=xa.test(a)||typeof a!=="string"?h(a,b||this.context):0;e=0;for(d=this.length;e<d;e++)for(f=this[e];f;)if(g?g.index(f)>-1:h.find.matchesSelector(f,a)){c.push(f);break}else if(f=f.parentNode,
!f||!f.ownerDocument||f===b||f.nodeType===11)break;c=c.length>1?h.unique(c):c;return this.pushStack(c,"closest",a)},index:function(a){return!a?this[0]&&this[0].parentNode?this.prevAll().length:-1:typeof a==="string"?h.inArray(this[0],h(a)):h.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var c=typeof a==="string"?h(a,b):h.makeArray(a&&a.nodeType?[a]:a),e=h.merge(this.get(),c);return this.pushStack(!c[0]||!c[0].parentNode||c[0].parentNode.nodeType===11||!e[0]||!e[0].parentNode||e[0].parentNode.nodeType===
11?e:h.unique(e))},andSelf:function(){return this.add(this.prevObject)}});h.each({parent:function(a){return(a=a.parentNode)&&a.nodeType!==11?a:null},parents:function(a){return h.dir(a,"parentNode")},parentsUntil:function(a,b,c){return h.dir(a,"parentNode",c)},next:function(a){return h.nth(a,2,"nextSibling")},prev:function(a){return h.nth(a,2,"previousSibling")},nextAll:function(a){return h.dir(a,"nextSibling")},prevAll:function(a){return h.dir(a,"previousSibling")},nextUntil:function(a,b,c){return h.dir(a,
"nextSibling",c)},prevUntil:function(a,b,c){return h.dir(a,"previousSibling",c)},siblings:function(a){return h.sibling(a.parentNode.firstChild,a)},children:function(a){return h.sibling(a.firstChild)},contents:function(a){return h.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:h.makeArray(a.childNodes)}},function(a,b){h.fn[a]=function(c,e){var d=h.map(this,b,c);Xa.test(a)||(e=c);e&&typeof e==="string"&&(d=h.filter(e,d));d=this.length>1&&!ab[a]?h.unique(d):d;if((this.length>1||Za.test(e))&&
Ya.test(a))d=d.reverse();return this.pushStack(d,a,$a.call(arguments).join(","))}});h.extend({filter:function(a,b,c){c&&(a=":not("+a+")");return b.length===1?h.find.matchesSelector(b[0],a)?[b[0]]:[]:h.find.matches(a,b)},dir:function(b,c,e){for(var d=[],b=b[c];b&&b.nodeType!==9&&(e===a||b.nodeType!==1||!h(b).is(e));)b.nodeType===1&&d.push(b),b=b[c];return d},nth:function(a,b,c){for(var b=b||1,e=0;a;a=a[c])if(a.nodeType===1&&++e===b)break;return a},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)a.nodeType===
1&&a!==b&&c.push(a);return c}});var oa="abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",bb=/ jQuery\d+="(?:\d+|null)"/g,la=/^\s+/,ya=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,za=/<([\w:]+)/,cb=/<tbody/i,db=/<|&#?\w+;/,eb=/<(?:script|style)/i,fb=/<(?:script|object|embed|option|style)/i,Aa=RegExp("<(?:"+oa+")","i"),Ba=/checked\s*(?:[^=]|=\s*.checked.)/i,gb=/\/(java|ecma)script/i,
Oa=/^\s*<!(?:\[CDATA\[|\-\-)/,Q={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},Ca=q(s);Q.optgroup=Q.option;Q.tbody=Q.tfoot=Q.colgroup=Q.caption=Q.thead;Q.th=Q.td;if(!h.support.htmlSerialize)Q._default=[1,"div<div>","</div>"];
h.fn.extend({text:function(b){return h.isFunction(b)?this.each(function(a){var c=h(this);c.text(b.call(this,a,c.text()))}):typeof b!=="object"&&b!==a?this.empty().append((this[0]&&this[0].ownerDocument||s).createTextNode(b)):h.text(this)},wrapAll:function(a){if(h.isFunction(a))return this.each(function(b){h(this).wrapAll(a.call(this,b))});if(this[0]){var b=h(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]);b.map(function(){for(var a=this;a.firstChild&&a.firstChild.nodeType===
1;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return h.isFunction(a)?this.each(function(b){h(this).wrapInner(a.call(this,b))}):this.each(function(){var b=h(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=h.isFunction(a);return this.each(function(c){h(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){h.nodeName(this,"body")||h(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,
!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});else if(arguments.length){var a=h.clean(arguments);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,
!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});else if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,h.clean(arguments));return a}},remove:function(a,b){for(var c=0,e;(e=this[c])!=null;c++)if(!a||h.filter(a,[e]).length)!b&&e.nodeType===1&&(h.cleanData(e.getElementsByTagName("*")),h.cleanData([e])),e.parentNode&&e.parentNode.removeChild(e);return this},empty:function(){for(var a=0,b;(b=this[a])!=null;a++)for(b.nodeType===1&&h.cleanData(b.getElementsByTagName("*"));b.firstChild;)b.removeChild(b.firstChild);
return this},clone:function(a,b){a=a==null?!1:a;b=b==null?a:b;return this.map(function(){return h.clone(this,a,b)})},html:function(b){if(b===a)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(bb,""):null;else if(typeof b==="string"&&!eb.test(b)&&(h.support.leadingWhitespace||!la.test(b))&&!Q[(za.exec(b)||["",""])[1].toLowerCase()]){b=b.replace(ya,"<$1></$2>");try{for(var c=0,e=this.length;c<e;c++)if(this[c].nodeType===1)h.cleanData(this[c].getElementsByTagName("*")),this[c].innerHTML=
b}catch(d){this.empty().append(b)}}else h.isFunction(b)?this.each(function(a){var c=h(this);c.html(b.call(this,a,c.html()))}):this.empty().append(b);return this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(h.isFunction(a))return this.each(function(b){var c=h(this),e=c.html();c.replaceWith(a.call(this,b,e))});typeof a!=="string"&&(a=h(a).detach());return this.each(function(){var b=this.nextSibling,c=this.parentNode;h(this).remove();b?h(b).before(a):h(c).append(a)})}else return this.length?
this.pushStack(h(h.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(b,c,e){var d,f,g,m=b[0],j=[];if(!h.support.checkClone&&arguments.length===3&&typeof m==="string"&&Ba.test(m))return this.each(function(){h(this).domManip(b,c,e,!0)});if(h.isFunction(m))return this.each(function(d){var f=h(this);b[0]=m.call(this,d,c?f.html():a);f.domManip(b,c,e)});if(this[0]){d=m&&m.parentNode;d=h.support.parentNode&&d&&d.nodeType===11&&d.childNodes.length===
this.length?{fragment:d}:h.buildFragment(b,this,j);g=d.fragment;if(f=g.childNodes.length===1?g=g.firstChild:g.firstChild){c=c&&h.nodeName(f,"tr");f=0;for(var k=this.length,t=k-1;f<k;f++)e.call(c?h.nodeName(this[f],"table")?this[f].getElementsByTagName("tbody")[0]||this[f].appendChild(this[f].ownerDocument.createElement("tbody")):this[f]:this[f],d.cacheable||k>1&&f<t?h.clone(g,!0,!0):g)}j.length&&h.each(j,A)}return this}});h.buildFragment=function(a,b,c){var e,d,f,g,m=a[0];b&&b[0]&&(g=b[0].ownerDocument||
b[0]);g.createDocumentFragment||(g=s);if(a.length===1&&typeof m==="string"&&m.length<512&&g===s&&m.charAt(0)==="<"&&!fb.test(m)&&(h.support.checkClone||!Ba.test(m))&&(h.support.html5Clone||!Aa.test(m)))d=!0,(f=h.fragments[m])&&f!==1&&(e=f);e||(e=g.createDocumentFragment(),h.clean(a,g,e,c));d&&(h.fragments[m]=f?e:1);return{fragment:e,cacheable:d}};h.fragments={};h.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){h.fn[a]=function(c){var e=
[],c=h(c),d=this.length===1&&this[0].parentNode;if(d&&d.nodeType===11&&d.childNodes.length===1&&c.length===1)return c[b](this[0]),this;else{for(var d=0,f=c.length;d<f;d++){var g=(d>0?this.clone(!0):this).get();h(c[d])[b](g);e=e.concat(g)}return this.pushStack(e,a,c.selector)}}});h.extend({clone:function(a,b,c){var e,d,f;h.support.html5Clone||!Aa.test("<"+a.nodeName)?e=a.cloneNode(!0):(e=s.createElement("div"),Ca.appendChild(e),e.innerHTML=a.outerHTML,e=e.firstChild);var m=e;if((!h.support.noCloneEvent||
!h.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!h.isXMLDoc(a)){g(a,m);e=o(a);d=o(m);for(f=0;e[f];++f)d[f]&&g(e[f],d[f])}if(b&&(r(a,m),c)){e=o(a);d=o(m);for(f=0;e[f];++f)r(e[f],d[f])}return m},clean:function(a,b,c,e){b=b||s;typeof b.createElement==="undefined"&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||s);for(var d=[],f,g=0,m;(m=a[g])!=null;g++)if(typeof m==="number"&&(m+=""),m){if(typeof m==="string")if(db.test(m)){m=m.replace(ya,"<$1></$2>");f=(za.exec(m)||["",""])[1].toLowerCase();
var j=Q[f]||Q._default,k=j[0],t=b.createElement("div");b===s?Ca.appendChild(t):q(b).appendChild(t);for(t.innerHTML=j[1]+m+j[2];k--;)t=t.lastChild;if(!h.support.tbody){k=cb.test(m);j=f==="table"&&!k?t.firstChild&&t.firstChild.childNodes:j[1]==="<table>"&&!k?t.childNodes:[];for(f=j.length-1;f>=0;--f)h.nodeName(j[f],"tbody")&&!j[f].childNodes.length&&j[f].parentNode.removeChild(j[f])}!h.support.leadingWhitespace&&la.test(m)&&t.insertBefore(b.createTextNode(la.exec(m)[0]),t.firstChild);m=t.childNodes}else m=
b.createTextNode(m);var l;if(!h.support.appendChecked)if(m[0]&&typeof(l=m.length)==="number")for(f=0;f<l;f++)p(m[f]);else p(m);m.nodeType?d.push(m):d=h.merge(d,m)}if(c){a=function(a){return!a.type||gb.test(a.type)};for(g=0;d[g];g++)e&&h.nodeName(d[g],"script")&&(!d[g].type||d[g].type.toLowerCase()==="text/javascript")?e.push(d[g].parentNode?d[g].parentNode.removeChild(d[g]):d[g]):(d[g].nodeType===1&&(b=h.grep(d[g].getElementsByTagName("script"),a),d.splice.apply(d,[g+1,0].concat(b))),c.appendChild(d[g]))}return d},
cleanData:function(a){for(var b,c,e=h.cache,d=h.event.special,f=h.support.deleteExpando,g=0,m;(m=a[g])!=null;g++)if(!m.nodeName||!h.noData[m.nodeName.toLowerCase()])if(c=m[h.expando]){if((b=e[c])&&b.events){for(var j in b.events)d[j]?h.event.remove(m,j):h.removeEvent(m,j,b.handle);if(b.handle)b.handle.elem=null}f?delete m[h.expando]:m.removeAttribute&&m.removeAttribute(h.expando);delete e[c]}}});var ma=/alpha\([^)]*\)/i,hb=/opacity=([^)]*)/,ib=/([A-Z]|^ms)/g,Da=/^-?\d+(?:px)?$/i,jb=/^-?\d/,kb=/^([\-+])=([\-+.\de]+)/,
lb={position:"absolute",visibility:"hidden",display:"block"},Pa=["Left","Right"],Qa=["Top","Bottom"],aa,Ea,Fa;h.fn.css=function(b,c){return arguments.length===2&&c===a?this:h.access(this,b,c,!0,function(b,c,e){return e!==a?h.style(b,c,e):h.css(b,c)})};h.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=aa(a,"opacity","opacity");return c===""?"1":c}else return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":h.support.cssFloat?
"cssFloat":"styleFloat"},style:function(b,c,e,d){if(b&&!(b.nodeType===3||b.nodeType===8||!b.style)){var f,g=h.camelCase(c),m=b.style,j=h.cssHooks[g],c=h.cssProps[g]||g;if(e!==a){d=typeof e;if(d==="string"&&(f=kb.exec(e)))e=+(f[1]+1)*+f[2]+parseFloat(h.css(b,c)),d="number";if(!(e==null||d==="number"&&isNaN(e)))if(d==="number"&&!h.cssNumber[g]&&(e+="px"),!j||!("set"in j)||(e=j.set(b,e))!==a)try{m[c]=e}catch(k){}}else return j&&"get"in j&&(f=j.get(b,!1,d))!==a?f:m[c]}},css:function(b,c,e){var d,f,c=
h.camelCase(c);f=h.cssHooks[c];c=h.cssProps[c]||c;c==="cssFloat"&&(c="float");if(f&&"get"in f&&(d=f.get(b,!0,e))!==a)return d;else if(aa)return aa(b,c)},swap:function(a,b,c){var e={},d;for(d in b)e[d]=a.style[d],a.style[d]=b[d];c.call(a);for(d in b)a.style[d]=e[d]}});h.curCSS=h.css;h.each(["height","width"],function(a,b){h.cssHooks[b]={get:function(a,c,e){var d;if(c){if(a.offsetWidth!==0)return z(a,b,e);else h.swap(a,lb,function(){d=z(a,b,e)});return d}},set:function(a,b){if(Da.test(b)){if(b=parseFloat(b),
b>=0)return b+"px"}else return b}}});if(!h.support.opacity)h.cssHooks.opacity={get:function(a,b){return hb.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,e=a.currentStyle,d=h.isNumeric(b)?"alpha(opacity="+b*100+")":"",f=e&&e.filter||c.filter||"";c.zoom=1;if(b>=1&&h.trim(f.replace(ma,""))===""&&(c.removeAttribute("filter"),e&&!e.filter))return;c.filter=ma.test(f)?f.replace(ma,d):f+" "+d}};h(function(){if(!h.support.reliableMarginRight)h.cssHooks.marginRight=
{get:function(a,b){var c;h.swap(a,{display:"inline-block"},function(){c=b?aa(a,"margin-right","marginRight"):a.style.marginRight});return c}}});s.defaultView&&s.defaultView.getComputedStyle&&(Ea=function(a,b){var c,e,d,b=b.replace(ib,"-$1").toLowerCase();if((e=a.ownerDocument.defaultView)&&(d=e.getComputedStyle(a,null)))c=d.getPropertyValue(b),c===""&&!h.contains(a.ownerDocument.documentElement,a)&&(c=h.style(a,b));return c});s.documentElement.currentStyle&&(Fa=function(a,b){var c,e,d=a.currentStyle&&
a.currentStyle[b],f=a.style;if(d===null&&f&&(c=f[b]))d=c;if(!Da.test(d)&&jb.test(d)){c=f.left;if(e=a.runtimeStyle&&a.runtimeStyle.left)a.runtimeStyle.left=a.currentStyle.left;f.left=b==="fontSize"?"1em":d||0;d=f.pixelLeft+"px";f.left=c;if(e)a.runtimeStyle.left=e}return d===""?"auto":d});aa=Ea||Fa;if(h.expr&&h.expr.filters)h.expr.filters.hidden=function(a){var b=a.offsetHeight;return a.offsetWidth===0&&b===0||!h.support.reliableHiddenOffsets&&(a.style&&a.style.display||h.css(a,"display"))==="none"},
h.expr.filters.visible=function(a){return!h.expr.filters.hidden(a)};var mb=/%20/g,Ra=/\[\]$/,Ga=/\r?\n/g,nb=/#.*$/,ob=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,pb=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,qb=/^(?:GET|HEAD)$/,rb=/^\/\//,Ha=/\?/,sb=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,tb=/^(?:select|textarea)/i,pa=/\s+/,ub=/([?&])_=[^&]*/,Ia=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,Ja=h.fn.load,ia={},Ka={},Y,Z,La=
["*/"]+["*"];try{Y=L.href}catch(Ab){Y=s.createElement("a"),Y.href="",Y=Y.href}Z=Ia.exec(Y.toLowerCase())||[];h.fn.extend({load:function(b,c,e){if(typeof b!=="string"&&Ja)return Ja.apply(this,arguments);else if(!this.length)return this;var d=b.indexOf(" ");if(d>=0)var f=b.slice(d,b.length),b=b.slice(0,d);d="GET";c&&(h.isFunction(c)?(e=c,c=a):typeof c==="object"&&(c=h.param(c,h.ajaxSettings.traditional),d="POST"));var g=this;h.ajax({url:b,type:d,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText;
a.isResolved()&&(a.done(function(a){c=a}),g.html(f?h("<div>").append(c.replace(sb,"")).find(f):c));e&&g.each(e,[c,b,a])}});return this},serialize:function(){return h.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?h.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||tb.test(this.nodeName)||pb.test(this.type))}).map(function(a,b){var c=h(this).val();return c==null?null:h.isArray(c)?h.map(c,function(a){return{name:b.name,
value:a.replace(Ga,"\r\n")}}):{name:b.name,value:c.replace(Ga,"\r\n")}}).get()}});h.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){h.fn[b]=function(a){return this.on(b,a)}});h.each(["get","post"],function(b,c){h[c]=function(b,e,d,f){h.isFunction(e)&&(f=f||d,d=e,e=a);return h.ajax({type:c,url:b,data:e,success:d,dataType:f})}});h.extend({getScript:function(b,c){return h.get(b,a,c,"script")},getJSON:function(a,b,c){return h.get(a,b,c,"json")},ajaxSetup:function(a,
b){b?N(a,h.ajaxSettings):(b=a,a=h.ajaxSettings);N(a,b);return a},ajaxSettings:{url:Y,isLocal:/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/.test(Z[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":La},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":b.String,
"text html":!0,"text json":h.parseJSON,"text xml":h.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:x(ia),ajaxTransport:x(Ka),ajax:function(b,c){function e(b,c,l,v){if(G!==2){G=2;q&&clearTimeout(q);o=a;p=v||"";B.readyState=b>0?4:0;var y,w,n,v=c;if(l){var A=d,r=B,E=A.contents,z=A.dataTypes,X=A.responseFields,x,s,u,J;for(s in X)s in l&&(r[X[s]]=l[s]);for(;z[0]==="*";)z.shift(),x===a&&(x=A.mimeType||r.getResponseHeader("content-type"));if(x)for(s in E)if(E[s]&&E[s].test(x)){z.unshift(s);break}if(z[0]in
l)u=z[0];else{for(s in l){if(!z[0]||A.converters[s+" "+z[0]]){u=s;break}J||(J=s)}u=u||J}u?(u!==z[0]&&z.unshift(u),l=l[u]):l=void 0}else l=a;if(b>=200&&b<300||b===304){if(d.ifModified){if(x=B.getResponseHeader("Last-Modified"))h.lastModified[t]=x;if(x=B.getResponseHeader("Etag"))h.etag[t]=x}if(b===304)v="notmodified",y=!0;else try{x=d;x.dataFilter&&(l=x.dataFilter(l,x.dataType));var H=x.dataTypes;s={};var S,M,N=H.length,K,T=H[0],V,O,L,F,D;for(S=1;S<N;S++){if(S===1)for(M in x.converters)typeof M===
"string"&&(s[M.toLowerCase()]=x.converters[M]);V=T;T=H[S];if(T==="*")T=V;else if(V!=="*"&&V!==T){O=V+" "+T;L=s[O]||s["* "+T];if(!L)for(F in D=a,s)if(K=F.split(" "),K[0]===V||K[0]==="*")if(D=s[K[1]+" "+T]){F=s[F];F===!0?L=D:D===!0&&(L=F);break}!L&&!D&&h.error("No conversion from "+O.replace(" "," to "));L!==!0&&(l=L?L(l):D(F(l)))}}w=l;v="success";y=!0}catch(U){v="parsererror",n=U}}else if(n=v,!v||b)v="error",b<0&&(b=0);B.status=b;B.statusText=""+(c||v);y?m.resolveWith(f,[w,v,B]):m.rejectWith(f,[B,
v,n]);B.statusCode(k);k=a;I&&g.trigger("ajax"+(y?"Success":"Error"),[B,d,y?w:n]);j.fireWith(f,[B,v]);I&&(g.trigger("ajaxComplete",[B,d]),--h.active||h.event.trigger("ajaxStop"))}}typeof b==="object"&&(c=b,b=a);var c=c||{},d=h.ajaxSetup({},c),f=d.context||d,g=f!==d&&(f.nodeType||f instanceof h)?h(f):h.event,m=h.Deferred(),j=h.Callbacks("once memory"),k=d.statusCode||{},t,l={},v={},p,y,o,q,n,G=0,I,A,B={readyState:0,setRequestHeader:function(a,b){if(!G){var c=a.toLowerCase(),a=v[c]=v[c]||a;l[a]=b}return this},
getAllResponseHeaders:function(){return G===2?p:null},getResponseHeader:function(b){var c;if(G===2){if(!y)for(y={};c=ob.exec(p);)y[c[1].toLowerCase()]=c[2];c=y[b.toLowerCase()]}return c===a?null:c},overrideMimeType:function(a){if(!G)d.mimeType=a;return this},abort:function(a){a=a||"abort";o&&o.abort(a);e(0,a);return this}};m.promise(B);B.success=B.done;B.error=B.fail;B.complete=j.add;B.statusCode=function(a){if(a){var b;if(G<2)for(b in a)k[b]=[k[b],a[b]];else b=a[B.status],B.then(b,b)}return this};
d.url=((b||d.url)+"").replace(nb,"").replace(rb,Z[1]+"//");d.dataTypes=h.trim(d.dataType||"*").toLowerCase().split(pa);if(d.crossDomain==null)n=Ia.exec(d.url.toLowerCase()),d.crossDomain=!(!n||!(n[1]!=Z[1]||n[2]!=Z[2]||(n[3]||(n[1]==="http:"?80:443))!=(Z[3]||(Z[1]==="http:"?80:443))));if(d.data&&d.processData&&typeof d.data!=="string")d.data=h.param(d.data,d.traditional);J(ia,d,c,B);if(G===2)return!1;I=d.global;d.type=d.type.toUpperCase();d.hasContent=!qb.test(d.type);I&&h.active++===0&&h.event.trigger("ajaxStart");
if(!d.hasContent&&(d.data&&(d.url+=(Ha.test(d.url)?"&":"?")+d.data,delete d.data),t=d.url,d.cache===!1)){n=h.now();var r=d.url.replace(ub,"$1_="+n);d.url=r+(r===d.url?(Ha.test(d.url)?"&":"?")+"_="+n:"")}(d.data&&d.hasContent&&d.contentType!==!1||c.contentType)&&B.setRequestHeader("Content-Type",d.contentType);d.ifModified&&(t=t||d.url,h.lastModified[t]&&B.setRequestHeader("If-Modified-Since",h.lastModified[t]),h.etag[t]&&B.setRequestHeader("If-None-Match",h.etag[t]));B.setRequestHeader("Accept",d.dataTypes[0]&&
d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+(d.dataTypes[0]!=="*"?", "+La+"; q=0.01":""):d.accepts["*"]);for(A in d.headers)B.setRequestHeader(A,d.headers[A]);if(d.beforeSend&&(d.beforeSend.call(f,B,d)===!1||G===2))return B.abort(),!1;for(A in{success:1,error:1,complete:1})B[A](d[A]);if(o=J(Ka,d,c,B)){B.readyState=1;I&&g.trigger("ajaxSend",[B,d]);d.async&&d.timeout>0&&(q=setTimeout(function(){B.abort("timeout")},d.timeout));try{G=1,o.send(l,e)}catch(z){if(G<2)e(-1,z);else throw z;}}else e(-1,
"No Transport");return B},param:function(b,c){var e=[],d=function(a,b){b=h.isFunction(b)?b():b;e[e.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(c===a)c=h.ajaxSettings.traditional;if(h.isArray(b)||b.jquery&&!h.isPlainObject(b))h.each(b,function(){d(this.name,this.value)});else for(var f in b)F(f,b[f],c,d);return e.join("&").replace(mb,"+")}});h.extend({active:0,lastModified:{},etag:{}});var vb=h.now(),ga=/(\=)\?(&|$)|\?\?/i;h.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return h.expando+
"_"+vb++}});h.ajaxPrefilter("json jsonp",function(a,c,e){c=a.contentType==="application/x-www-form-urlencoded"&&typeof a.data==="string";if(a.dataTypes[0]==="jsonp"||a.jsonp!==!1&&(ga.test(a.url)||c&&ga.test(a.data))){var d,f=a.jsonpCallback=h.isFunction(a.jsonpCallback)?a.jsonpCallback():a.jsonpCallback,g=b[f],m=a.url,j=a.data,k="$1"+f+"$2";a.jsonp!==!1&&(m=m.replace(ga,k),a.url===m&&(c&&(j=j.replace(ga,k)),a.data===j&&(m+=(/\?/.test(m)?"&":"?")+a.jsonp+"="+f)));a.url=m;a.data=j;b[f]=function(a){d=
[a]};e.always(function(){b[f]=g;if(d&&h.isFunction(g))b[f](d[0])});a.converters["script json"]=function(){d||h.error(f+" was not called");return d[0]};a.dataTypes[0]="json";return"script"}});h.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){h.globalEval(a);return a}}});h.ajaxPrefilter("script",function(b){if(b.cache===a)b.cache=!1;if(b.crossDomain)b.type=
"GET",b.global=!1});h.ajaxTransport("script",function(b){if(b.crossDomain){var c,e=s.head||s.getElementsByTagName("head")[0]||s.documentElement;return{send:function(d,f){c=s.createElement("script");c.async="async";if(b.scriptCharset)c.charset=b.scriptCharset;c.src=b.url;c.onload=c.onreadystatechange=function(b,d){if(d||!c.readyState||/loaded|complete/.test(c.readyState))c.onload=c.onreadystatechange=null,e&&c.parentNode&&e.removeChild(c),c=a,d||f(200,"success")};e.insertBefore(c,e.firstChild)},abort:function(){if(c)c.onload(0,
1)}}}});var na=b.ActiveXObject?function(){for(var a in da)da[a](0,1)}:!1,wb=0,da;h.ajaxSettings.xhr=b.ActiveXObject?function(){var a;if(!(a=!this.isLocal&&n()))a:{try{a=new b.ActiveXObject("Microsoft.XMLHTTP");break a}catch(c){}a=void 0}return a}:n;(function(a){h.extend(h.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})})(h.ajaxSettings.xhr());h.support.ajax&&h.ajaxTransport(function(c){if(!c.crossDomain||h.support.cors){var e;return{send:function(d,f){var g=c.xhr(),m,j;c.username?g.open(c.type,
c.url,c.async,c.username,c.password):g.open(c.type,c.url,c.async);if(c.xhrFields)for(j in c.xhrFields)g[j]=c.xhrFields[j];c.mimeType&&g.overrideMimeType&&g.overrideMimeType(c.mimeType);!c.crossDomain&&!d["X-Requested-With"]&&(d["X-Requested-With"]="XMLHttpRequest");try{for(j in d)g.setRequestHeader(j,d[j])}catch(k){}g.send(c.hasContent&&c.data||null);e=function(b,d){var j,k,t,l,v;try{if(e&&(d||g.readyState===4)){e=a;if(m)g.onreadystatechange=h.noop,na&&delete da[m];if(d)g.readyState!==4&&g.abort();
else{j=g.status;t=g.getAllResponseHeaders();l={};if((v=g.responseXML)&&v.documentElement)l.xml=v;l.text=g.responseText;try{k=g.statusText}catch(p){k=""}!j&&c.isLocal&&!c.crossDomain?j=l.text?200:404:j===1223&&(j=204)}}}catch(y){d||f(-1,y)}l&&f(j,k,l,t)};!c.async||g.readyState===4?e():(m=++wb,na&&(da||(da={},h(b).unload(na)),da[m]=e),g.onreadystatechange=e)},abort:function(){e&&e(0,1)}}}});var ja={},R,ba,xb=/^(?:toggle|show|hide)$/,yb=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,ha,qa=[["height","marginTop",
"marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],ea;h.fn.extend({show:function(a,b,c){if(a||a===0)return this.animate(K("show",3),a,b,c);else{for(var c=0,e=this.length;c<e;c++)if(a=this[c],a.style){b=a.style.display;if(!h._data(a,"olddisplay")&&b==="none")b=a.style.display="";b===""&&h.css(a,"display")==="none"&&h._data(a,"olddisplay",I(a.nodeName))}for(c=0;c<e;c++)if(a=this[c],a.style&&(b=a.style.display,b===""||b==="none"))a.style.display=
h._data(a,"olddisplay")||"";return this}},hide:function(a,b,c){if(a||a===0)return this.animate(K("hide",3),a,b,c);else{for(var c=0,e=this.length;c<e;c++)a=this[c],a.style&&(b=h.css(a,"display"),b!=="none"&&!h._data(a,"olddisplay")&&h._data(a,"olddisplay",b));for(c=0;c<e;c++)if(this[c].style)this[c].style.display="none";return this}},_toggle:h.fn.toggle,toggle:function(a,b,c){var e=typeof a==="boolean";h.isFunction(a)&&h.isFunction(b)?this._toggle.apply(this,arguments):a==null||e?this.each(function(){var b=
e?a:h(this).is(":hidden");h(this)[b?"show":"hide"]()}):this.animate(K("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,e){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,e)},animate:function(a,b,c,e){function d(){var w;f.queue===!1&&h._mark(this);var b=h.extend({},f),c=this.nodeType===1,e=c&&h(this).is(":hidden"),g,m,j,k,t;b.animatedProperties={};for(j in a){g=h.camelCase(j);j!==g&&(a[g]=a[j],delete a[j]);m=a[g];h.isArray(m)?(b.animatedProperties[g]=m[1],w=
a[g]=m[0],m=w):b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||"swing";if(m==="hide"&&e||m==="show"&&!e)return b.complete.call(this);if(c&&(g==="height"||g==="width"))if(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],h.css(this,"display")==="inline"&&h.css(this,"float")==="none")!h.support.inlineBlockNeedsLayout||I(this.nodeName)==="inline"?this.style.display="inline-block":this.style.zoom=1}if(b.overflow!=null)this.style.overflow="hidden";for(j in a)if(c=
new h.fx(this,b,j),m=a[j],xb.test(m))if(g=h._data(this,"toggle"+j)||(m==="toggle"?e?"show":"hide":0))h._data(this,"toggle"+j,g==="show"?"hide":"show"),c[g]();else c[m]();else g=yb.exec(m),k=c.cur(),g?(m=parseFloat(g[2]),t=g[3]||(h.cssNumber[j]?"":"px"),t!=="px"&&(h.style(this,j,(m||1)+t),k*=(m||1)/c.cur(),h.style(this,j,k+t)),g[1]&&(m=(g[1]==="-="?-1:1)*m+k),c.custom(k,m,t)):c.custom(k,m,"");return!0}var f=h.speed(b,c,e);if(h.isEmptyObject(a))return this.each(f.complete,[!1]);a=h.extend({},a);return f.queue===
!1?this.each(d):this.queue(f.queue,d)},stop:function(b,c,e){typeof b!=="string"&&(e=c,c=b,b=a);c&&b!==!1&&this.queue(b||"fx",[]);return this.each(function(){function a(b,c,d){c=c[d];h.removeData(b,d,!0);c.stop(e)}var c,d=!1,f=h.timers,g=h._data(this);e||h._unmark(!0,this);if(b==null)for(c in g)g[c]&&g[c].stop&&c.indexOf(".run")===c.length-4&&a(this,g,c);else g[c=b+".run"]&&g[c].stop&&a(this,g,c);for(c=f.length;c--;)if(f[c].elem===this&&(b==null||f[c].queue===b)){if(e)f[c](!0);else f[c].saveState();
d=!0;f.splice(c,1)}(!e||!d)&&h.dequeue(this,b)})}});h.each({slideDown:K("show",1),slideUp:K("hide",1),slideToggle:K("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){h.fn[a]=function(a,c,e){return this.animate(b,a,c,e)}});h.extend({speed:function(a,b,c){var e=a&&typeof a==="object"?h.extend({},a):{complete:c||!c&&b||h.isFunction(a)&&a,duration:a,easing:c&&b||b&&!h.isFunction(b)&&b};e.duration=h.fx.off?0:typeof e.duration==="number"?e.duration:
e.duration in h.fx.speeds?h.fx.speeds[e.duration]:h.fx.speeds._default;if(e.queue==null||e.queue===!0)e.queue="fx";e.old=e.complete;e.complete=function(a){h.isFunction(e.old)&&e.old.call(this);e.queue?h.dequeue(this,e.queue):a!==!1&&h._unmark(this)};return e},easing:{linear:function(a,b,c,e){return c+e*a},swing:function(a,b,c,e){return(-Math.cos(a*Math.PI)/2+0.5)*e+c}},timers:[],fx:function(a,b,c){this.options=b;this.elem=a;this.prop=c;b.orig=b.orig||{}}});h.fx.prototype={update:function(){this.options.step&&
this.options.step.call(this.elem,this.now,this);(h.fx.step[this.prop]||h.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var a,b=h.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||b==="auto"?0:b:a},custom:function(b,c,e){function d(a){return f.step(a)}var f=this,g=h.fx;this.startTime=ea||D();this.end=c;this.now=this.start=b;this.pos=this.state=0;this.unit=e||this.unit||(h.cssNumber[this.prop]?
"":"px");d.queue=this.options.queue;d.elem=this.elem;d.saveState=function(){f.options.hide&&h._data(f.elem,"fxshow"+f.prop)===a&&h._data(f.elem,"fxshow"+f.prop,f.start)};d()&&h.timers.push(d)&&!ha&&(ha=setInterval(g.tick,g.interval))},show:function(){var b=h._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=b||h.style(this.elem,this.prop);this.options.show=!0;b!==a?this.custom(this.cur(),b):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur());h(this.elem).show()},hide:function(){this.options.orig[this.prop]=
h._data(this.elem,"fxshow"+this.prop)||h.style(this.elem,this.prop);this.options.hide=!0;this.custom(this.cur(),0)},step:function(a){var b,c=ea||D(),e=!0,d=this.elem,f=this.options;if(a||c>=f.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();f.animatedProperties[this.prop]=!0;for(b in f.animatedProperties)f.animatedProperties[b]!==!0&&(e=!1);if(e){f.overflow!=null&&!h.support.shrinkWrapBlocks&&h.each(["","X","Y"],function(a,b){d.style["overflow"+b]=f.overflow[a]});f.hide&&
h(d).hide();if(f.hide||f.show)for(b in f.animatedProperties)h.style(d,b,f.orig[b]),h.removeData(d,"fxshow"+b,!0),h.removeData(d,"toggle"+b,!0);if(a=f.complete)f.complete=!1,a.call(d)}return!1}else f.duration==Infinity?this.now=c:(a=c-this.startTime,this.state=a/f.duration,this.pos=h.easing[f.animatedProperties[this.prop]](this.state,a,0,1,f.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update();return!0}};h.extend(h.fx,{tick:function(){for(var a,b=h.timers,c=0;c<b.length;c++)a=
b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||h.fx.stop()},interval:13,stop:function(){clearInterval(ha);ha=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){h.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now}}});h.each(["width","height"],function(a,b){h.fx.step[b]=function(a){h.style(a.elem,b,Math.max(0,a.now)+a.unit)}});if(h.expr&&h.expr.filters)h.expr.filters.animated=function(a){return h.grep(h.timers,
function(b){return a===b.elem}).length};var zb=/^t(?:able|d|h)$/i,Ma=/^(?:body|html)$/i;h.fn.offset="getBoundingClientRect"in s.documentElement?function(a){var b=this[0],c;if(a)return this.each(function(b){h.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return h.offset.bodyOffset(b);try{c=b.getBoundingClientRect()}catch(e){}var d=b.ownerDocument,f=d.documentElement;if(!c||!h.contains(f,b))return c?{top:c.top,left:c.left}:{top:0,left:0};b=d.body;d=M(d);
return{top:c.top+(d.pageYOffset||h.support.boxModel&&f.scrollTop||b.scrollTop)-(f.clientTop||b.clientTop||0),left:c.left+(d.pageXOffset||h.support.boxModel&&f.scrollLeft||b.scrollLeft)-(f.clientLeft||b.clientLeft||0)}}:function(a){var b=this[0];if(a)return this.each(function(b){h.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return h.offset.bodyOffset(b);var c,e=b.offsetParent,d=b.ownerDocument,f=d.documentElement,g=d.body;c=(d=d.defaultView)?d.getComputedStyle(b,
null):b.currentStyle;for(var m=b.offsetTop,j=b.offsetLeft;(b=b.parentNode)&&b!==g&&b!==f;){if(h.support.fixedPosition&&c.position==="fixed")break;c=d?d.getComputedStyle(b,null):b.currentStyle;m-=b.scrollTop;j-=b.scrollLeft;if(b===e){m+=b.offsetTop;j+=b.offsetLeft;if(h.support.doesNotAddBorder&&(!h.support.doesAddBorderForTableAndCells||!zb.test(b.nodeName)))m+=parseFloat(c.borderTopWidth)||0,j+=parseFloat(c.borderLeftWidth)||0;e=b.offsetParent}h.support.subtractsBorderForOverflowNotVisible&&c.overflow!==
"visible"&&(m+=parseFloat(c.borderTopWidth)||0,j+=parseFloat(c.borderLeftWidth)||0)}if(c.position==="relative"||c.position==="static")m+=g.offsetTop,j+=g.offsetLeft;h.support.fixedPosition&&c.position==="fixed"&&(m+=Math.max(f.scrollTop,g.scrollTop),j+=Math.max(f.scrollLeft,g.scrollLeft));return{top:m,left:j}};h.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;h.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(h.css(a,"marginTop"))||0,c+=parseFloat(h.css(a,"marginLeft"))||0);
return{top:b,left:c}},setOffset:function(a,b,c){var e=h.css(a,"position");if(e==="static")a.style.position="relative";var d=h(a),f=d.offset(),g=h.css(a,"top"),m=h.css(a,"left"),j={},k={};(e==="absolute"||e==="fixed")&&h.inArray("auto",[g,m])>-1?(k=d.position(),e=k.top,m=k.left):(e=parseFloat(g)||0,m=parseFloat(m)||0);h.isFunction(b)&&(b=b.call(a,c,f));if(b.top!=null)j.top=b.top-f.top+e;if(b.left!=null)j.left=b.left-f.left+m;"using"in b?b.using.call(a,j):d.css(j)}};h.fn.extend({position:function(){if(!this[0])return null;
var a=this[0],b=this.offsetParent(),c=this.offset(),e=Ma.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(h.css(a,"marginTop"))||0;c.left-=parseFloat(h.css(a,"marginLeft"))||0;e.top+=parseFloat(h.css(b[0],"borderTopWidth"))||0;e.left+=parseFloat(h.css(b[0],"borderLeftWidth"))||0;return{top:c.top-e.top,left:c.left-e.left}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||s.body;a&&!Ma.test(a.nodeName)&&h.css(a,"position")==="static";)a=a.offsetParent;return a})}});
h.each(["Left","Top"],function(b,c){var e="scroll"+c;h.fn[e]=function(c){var d,f;return c===a?(d=this[0],!d?null:(f=M(d))?"pageXOffset"in f?f[b?"pageYOffset":"pageXOffset"]:h.support.boxModel&&f.document.documentElement[e]||f.document.body[e]:d[e]):this.each(function(){(f=M(this))?f.scrollTo(!b?c:h(f).scrollLeft(),b?c:h(f).scrollTop()):this[e]=c})}});h.each(["Height","Width"],function(b,c){var e=c.toLowerCase();h.fn["inner"+c]=function(){var a=this[0];return a?a.style?parseFloat(h.css(a,e,"padding")):
this[e]():null};h.fn["outer"+c]=function(a){var b=this[0];return b?b.style?parseFloat(h.css(b,e,a?"margin":"border")):this[e]():null};h.fn[e]=function(b){var d=this[0];if(!d)return b==null?null:this;if(h.isFunction(b))return this.each(function(a){var c=h(this);c[e](b.call(this,a,c[e]()))});if(h.isWindow(d)){var f=d.document.documentElement["client"+c],g=d.document.body;return d.document.compatMode==="CSS1Compat"&&f||g&&g["client"+c]||f}else return d.nodeType===9?Math.max(d.documentElement["client"+
c],d.body["scroll"+c],d.documentElement["scroll"+c],d.body["offset"+c],d.documentElement["offset"+c]):b===a?(d=h.css(d,e),f=parseFloat(d),h.isNumeric(f)?f:d):this.css(e,typeof b==="string"?b:b+"px")}});b.jQuery=b.$=h;typeof define==="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return h})})(window);
var Eggshell=function(b){var a=function(a,b,c){this.name=a;this.dependencies=b?b:[];this.constructor=c;this.instance=null;this.getName=function(){return this.name};this.getDependencies=function(){return this.dependencies};this.getInstance=function(){return this.instance};this.instantiate=function(a){return this.instance=(this.instance=this.constructor.apply({},a))?this.instance:{}}},c={},d=function(){var a=!1,b;for(b in c){var j=c[b];if(!j.getInstance()){for(var k=j.getDependencies(),l=[],q=!0,r=
0;r<k.length;r++){var g=c[k[r]];if(g&&g.getInstance())l.push(g.getInstance());else{q=!1;break}}q&&(j.instantiate(l),a=!0)}}a&&d()};b.module=function(e,f,j){if(!e||typeof e!="string")throw"Invalid module name. Name needs to be a non empty String.";if(f&&!(f instanceof Array))throw"Invalid dependencies. Dependencies can either be null or an array of module names";if(!j||typeof j!="function")throw"Invalid constructor function";e=new a(e,f,j);c[e.getName()]=e;d();return b};b.namespace=function(a,c,d){if(!a||
typeof a!="string")throw"Invalid namespace. Namespace needs to be a non empty String.";if(typeof c=="undefined"||c===null)throw"Invalid object to be exported";if(typeof d!="undefined"&&typeof d!="boolean")throw"Invalid overwrite flag. It needs to be either null or boolean.";for(var k=a.split("."),a=b,l=0;l<k.length-1;l++)a[k[l]]||(a[k[l]]={}),a=a[k[l]];if(!a[k[k.length-1]]||d)a[k[k.length-1]]=c;else throw"Namespace is already taken";return b};return b}({});
Eggshell.module("Logger",[],function(){for(var b=window.console=window.console||{},a=["log","debug","warn","error"],c=function(){},d=0;d<a.length;d++)b[a[d]]||(b[a[d]]=c);var e="warn";this.debug=function(){e=="debug"&&b.debug(arguments)};this.log=function(){(e=="debug"||e=="info")&&b.log(arguments)};this.warn=function(){(e=="debug"||e=="info"||e=="warn")&&b.warn(arguments)};this.error=function(){b.error(arguments)};this.setLogLevel=function(a){e=a;return Eggshell};Eggshell.namespace("setLogLevel",
this.setLogLevel);return this});
Eggshell.module("Api",["Logger","Eventbus","Connector","Loader","DefinitionRegistry","EggRegistry","ComponentResourceRegistry","Validator","InterfaceRegistry"],function(b,a,c,d,e,f,j,k,l){var q=!1,r=function(a){if(typeof a=="string")return a;else if(typeof a=="object"&&a.shell&&a.shell.getId)return a.shell.getId();else if(typeof a=="object"&&a.getId)return a.getId();else if(typeof a=="object"&&a.prototype&&a.prototype.Eggshell&&a.prototype.Eggshell.getId)return a.prototype.Eggshell.getId();else if(d.getShellInProgress())return d.getShellInProgress().getId();
return null},g=function(a){return f.exist(a)?f.get(a):null};Eggshell.namespace("enableErrorHandling",function(b){q=!!b;a.enableErrorHandling(b);return Eggshell});Eggshell.namespace("enableStrictMode",function(){return Eggshell});Eggshell.namespace("define",function(a,c,d){var f=function(a,c,d){arguments.length==2&&(b.debug(a+" definition is depreciated. Component definition contains class, config, and implementation."),d=c,c=null);typeof c=="function"&&typeof d=="undefined"&&(b.debug(a+" definition is depreciated. Component definition contains class, config, and implementation."),
d=c,c=null);if(typeof a!=="string"||!a)throw"Invalid class. It must be a string.";if(typeof d!=="function"||!d)throw"Invalid constructor. It must be a function.";if(c&&c["interface"]){var f=c["interface"],c=l.get(c["interface"],c);if(!c)throw"Unrecognized interface "+f;}e.exist(a)?c.force_replace&&(e.register(a,{config:c,constructor:d},!0),b.debug("Component defined. Forced replace",a,c,d)):(e.register(a,{config:c,constructor:d}),b.debug("Component defined.",a,c,d));return Eggshell};if(q)try{return f(a,
c,d),Eggshell}catch(g){b.error('Encountered exception in "Eggshell.define".',g,a,c,d)}else return f(a,c,d),Eggshell});Eggshell.namespace("definition",function(a){if(q)try{return e.get(a)}catch(c){return b.error('Encountered error in "Eggshell.getDefintion".',c,a,attributes),null}else return e.get(a)});

Eggshell.namespace("create",function(a,c){
	var f=function(a,b){
		if(typeof a!=="string"||!a)throw"Invalid constructor id.";
		var c=null,c=!1,f=null;
		(f=e.get(a))?(c=f&&f.config?f.config:{},f=f.constructor,c=c&&c.singleton?!0:!1):f=eval(a);
		var g=null,g=c?d.load(a,a,f,b):d.load(null,a,f,b);
				return Eggshell.find(g)
	};

	if(q) try{return f(a,c)} catch(g){
		return b.error('Encountered error in "Eggshell.create".',g,a,c), new Eggshell.Shell([],[])}
		else return f(a,c)});

Eggshell.namespace("find",function(a){var c=function(a){var b=r(a);if(typeof b!=="string"||!b)throw"Invalid id.";for(var c=[],a=[],e=f.getAll(),d=0;d<e.length;d++)if(e[d].getId()===b||e[d].getClass()===b){var g=e[d];c.push(g.getId());a.push(g.getClass())}b=
{};e=[];for(d=0;d<c.length;d++)b[c[d]]||(b[c[d]]=!0,e.push(c[d]));b={};c=[];for(d=0;d<a.length;d++)b[a[d]]||(b[a[d]]=!0,c.push(a[d]));return new Eggshell.Shell(e,c)};if(q)try{return c(a)}catch(e){return b.error('Encountered error in "Eggshell.find".',e,a),new Eggshell.Shell([],[])}else return c(a)});Eggshell.namespace("trigger",function(c,d,f,j){var l=function(b,c,d){var f=r(b);if(typeof f!=="string"||!f)throw"Invalid id.";if(typeof c!=="string"||!c)throw"Invalid Action.";if(b=g(f)){var j=e.get(b.getClass());
if(j&&j.config&&j.config.strict&&(j.config.outputs||j.config.inputs)){var f=j.config.inputs,j=j.config.outputs,l={},p,q=0;if(f!==null)if(f.length&&typeof f.length==="number"){l=[];for(q=0;q<f.length;q++)l.push(f[q])}else for(p in f)l[p]=f[p];if(j!==null)if(j.length&&typeof j.length==="number")for(q=0;q<j.length;q++)l.push(j[q]);else for(p in j)l[p]=j[p];k.validate(l,c,d)}b.trigger(c,d)}else a.fire(f,c,d)};if(q)try{return l(c,d,f,j),Eggshell}catch(x){b.error('Encountered error in "Eggshell.trigger".',
x,{selector:c,action:d,payload:f,options:j})}else return l(c,d,f,j),Eggshell});Eggshell.namespace("on",function(c,e,d,f){var j=function(b,c,e,d){b=r(b);if(typeof b!=="string"||!b)throw"Invalid id.";if(typeof c!=="string"||!c)throw"Invalid Action.";if(typeof e!=="function"||!e)throw"Invalid callback function.";if(g(b))g(b).on(c,e,d);else a.addListener(b,c,e,d)};if(q)try{return j(c,e,d,f),Eggshell}catch(k){b.error('Encountered error in "Eggshell.on".',k,{selector:c,action:e,callback:d,context:f})}else return j(c,
e,d,f),Eggshell});Eggshell.namespace("off",function(c,e,d,f){var j=function(b,c,e,d){b=r(b);if(typeof b!=="string"||!b)throw"Invalid id.";if(typeof c!=="string"||!c)throw"Invalid Action.";g(b)?g(b).off(c,e,d):a.removeListener(b,c,e,d)};if(q)try{return j(c,e,d,f),Eggshell}catch(k){b.error('Encountered error in "Eggshell.off".',k,{selector:c,action:e,callback:d,context:f})}else return j(c,e,d,f),Eggshell});Eggshell.namespace("connect",function(a,e,d,f){var g=function(a,b,e,d){a=r(a);e=r(e);d||(d=b);
if(typeof a!=="string"||!a)throw"Invalid output id.";if(typeof b!=="string"||!b)throw"Invalid output action.";if(typeof e!=="string"||!e)throw"Invalid input id.";if(typeof d!=="string"||!d)throw"Invalid input action.";c.connect(a,b,e,d)};if(q)try{return g(a,e,d,f),Eggshell}catch(j){b.error('Encountered error in "Eggshell.connect".',j,{outputId:a,outputAction:e,inputId:d,inputAction:f})}else return g(a,e,d,f),Eggshell});Eggshell.namespace("destroy",function(c){var e=function(b){b=r(b);if(typeof b!==
"string"||!b)throw"Invalid id.";d.unload(b);a.removeListener(b)};if(q)try{return e(c),Eggshell}catch(f){b.error('Encountered error in "Eggshell.destroy"',f,c)}else return e(c),Eggshell});Eggshell.namespace("destroyAll",function(){var a=function(){for(var a=f.getAll(),b=null,c=0;c<a.length;c++)b=e.get(a[c].getClass()),(!b||!b.config||!b.config.immuneToDestroyAll)&&Eggshell.destroy(a[c].getId())};if(q)try{return a(),Eggshell}catch(c){b.error('Encountered error in "Eggshell.destroyAll"',c,selector)}else return a(),
Eggshell});Eggshell.namespace("immuneToDestroyAll",function(a){var c=function(a){a=r(a);if(a=g(a))e.get(a.getClass()).config.immuneToDestroyAll=!0};if(q)try{return c(a),Eggshell}catch(d){b.error('Encountered error in "Eggshell.immuneToDestroyAll"',d,a)}else return c(a),Eggshell});Eggshell.namespace("getInterface",l.get);Eggshell.namespace("defineInterface",l.set);Eggshell.namespace("createOnce",function(a,c){b.debug('Depreciated. Use "Eggshell.create" and "singleton" flag instead. Old API will be decommissioned in the next major release.');
var f=function(a,b){if(typeof a!=="string"||!a)throw"Invalid constructor id.";var c=null,c=(c=e.get(a))?c.constructor:eval(a),f=null,f=d.load(a,a,c,b);return Eggshell.find(f)};if(q)try{return f(a,c)}catch(g){return b.error('Encountered error in "Eggshell.createOnce".',g,a,c),new Eggshell.Shell([],[])}else return f(a,c)});Eggshell.namespace("getDefinition",function(a){b.debug('Depreciated. Use "Eggshell.definition". Old API will be decommissioned in the next major release.');return Eggshell.definition(a)});
Eggshell.namespace("shell",function(a){b.debug('Depreciated. Use "Eggshell.find". Old API will be decommissioned in the next major release.');return Eggshell.find(a)});Eggshell.namespace("output",function(a,c,e,d){b.debug('Depreciated. Use "Eggshell.trigger". Old API will be decommissioned in the next major release.');return Eggshell.trigger(a,c,e,d)});Eggshell.namespace("listen",function(a,c,e,d){b.debug('Depreciated. Use "Eggshell.on". Old API will be decommissioned in the next major release.');
return Eggshell.on(a,c,e,d)});Eggshell.namespace("bind",Eggshell.listen);Eggshell.namespace("input",Eggshell.listen);Eggshell.namespace("stopListening",function(a,c,e,d){b.debug('Depreciated. Use "Eggshell.off". Old API will be decommissioned in the next major release.');return Eggshell.off(a,c,e,d)});Eggshell.namespace("unbind",Eggshell.stopListening);Eggshell.namespace("disconnect",Eggshell.stopListening)});
Eggshell.module("Shell",["Logger","Api"],function(b){var a=function(a,d){var e=[];if(typeof a=="string")e.push(a);else for(var f=0;f<a.length;f++)e.push(a[f]);this.eggshell=!0;this.getId=function(){return e[0]};this.getClass=function(){return d[0]};this.trigger=function(a,b){for(var c=0;c<e.length;c++)Eggshell.trigger(e[c],a,b);return this};this.on=function(a,b,c,d){for(var f=0;f<e.length;f++)Eggshell.on(e[f],a,b,c,d);return this};this.off=function(a,b,c,d){for(var f=0;f<e.length;f++)Eggshell.off(e[f],
a,b,c,d);return this};this.connect=function(a,b){for(var c=0;c<e.length;c++)for(var d=0;d<b.length;d++)Eggshell.connect(e[c],a,b[d].selector,b[d].action);return this};this.destroy=function(){for(var a=0;a<e.length;a++)Eggshell.destroy(e[a]);return null};this.getNs=function(){b.debug('Depreciated function. Use "Shell.getId()". Old API will be decommissioned in the next major release.');return this.getId()};this.getNamespace=function(){b.debug('Depreciated function. Use "Shell.getId()". Old API will be decommissioned in the next major release.');
return this.getId()};this.getConstructorNamespace=function(){b.debug('Depreciated function. Use "Shell.getClass". Old API will be decommissioned in the next major release.');return this.getClass()};this.listen=function(a,c,e,d){b.debug('Depreciated function. Use "Shell.on". Old API will be decommissioned in the next major release.');return this.on(a,c,e,d)};this.input=function(a,c,e,d){b.debug('Depreciated function. Use "Shell.on". Old API will be decommissioned in the next major release.');return this.on(a,
c,e,d)};this.output=function(a,c){b.debug('Depreciated function. Use "Shell.trigger(action, payload, context)". Old API will be decommissioned in the next major release.');return this.trigger(a,c)};this.stopListening=function(a,c,e,d){b.debug('Depreciated function. Use "Shell.off(action, payload, context, options)". Old API will be decommissioned in the next major release.');return this.off(a,c,e,d)};this.disconnect=function(a,c,e,d){b.debug('Depreciated function. Use "Shell.off(action, payload, context, options)". Old API will be decommissioned in the next major release.');
return this.off(a,c,e,d)}};Eggshell.namespace("Shell",a);return a});Eggshell.module("Connector",["Logger","Eventbus"],function(b,a){this.connect=function(c,d,e,f){e=function(c,e,d,f){return{connect:function(r,g){var o=e,u=f;if(o==="*")o=r.action;u==="*"&&(u=o);b.debug("Routing event. ",{input:{channel:d,action:u},output:{channel:c,action:o}});a.fire(d,u,g,r.chain)}}}(c,d,e,f);a.addListener(c,d,e.connect,e);b.debug("Connector created.",e)};return this});
Eggshell.module("Egg",["Logger","Eventbus"],function(b,a){return function(b,d){var e=null,f=!1,j=[],k=function(a){j[j.length]=a},l=function(){for(;j.length;){var a=j[0];delete j[0];j.splice(0,1);a.call(this)}j=[]};this.getId=function(){return b};this.getClass=function(){return d};this.ready=function(a){e=a;f=!0;l();delete this.ready;delete this.setContext};this.destroy=function(){j=f=e=null};this.trigger=function(e,d){k(function(b,c,e){return function(){a.fire(b,c,e)}}(b,e,d));f&&l()};this.on=function(d,
j,g){k(function(b,c,d,f){return function(){f||(f=e);c==="*"?a.addListener(b,"*",d,f):a.addListener(b,c,d,f)}}(b,d,j,g));f&&l()};this.off=function(d,j,g){g||(g=e);k(function(b,c,d){d||(d=e);return function(){a.removeListener(b,c,j,d)}}(b,d,g));f&&l();return this}}});Eggshell.module("Event",[],function(){return function(b,a,c){this.channel=b;this.action=a;this.chain=c;this.namespace=b}});Eggshell.module("Interceptor",[],function(){return function(b,a,c){this.Event=b;this.callback=a;this.context=c}});
Eggshell.module("Eventbus",["Logger","Event","Interceptor","Listener"],function(b,a,c,d){var e=!0,f={},j={};this.enableErrorHandling=function(a){e=!!a};this.fire=function(c,d,q,r){q=typeof q!="undefined"&&q!==null?q:{};r=typeof r!="undefined"&&r!==null?r:[];r.push(new a(c,d));c=new a(c,d,r);b.debug("Event fired.",c.channel,c.action,q);if(j[c.channel]&&j[c.channel][c.action])if(d=j[c.channel][c.action],e)try{d.callback.apply(d.context,q),b.debug("Interceptor fired.",d)}catch(g){b.error("Interceptor error.",
g,c.channel,c.action,d)}else d.callback.apply(d.context,q),b.debug("Interceptor fired.",d);else if(f){d=[];f["*"]&&(f["*"]["*"]&&(d=d.concat(f["*"]["*"])),f["*"][c.action]&&(d=d.concat(f["*"][c.action])));f[c.channel]&&(f[c.channel]["*"]&&(d=d.concat(f[c.channel]["*"])),f[c.channel][c.action]&&(d=d.concat(f[c.channel][c.action])));for(r=0;r<d.length;r++){var o=d[r];if(e)try{o.callback.call(o.context,c,q),b.debug("Listener fired.",c.channel,c.action,o)}catch(u){b.error("Listener error.",u,c.channel,
c.action,o)}else o.callback.call(o.context,c,q),b.debug("Listener fired.",c.channel,c.action,o)}}};this.addInterceptor=function(e,d,f,r){var g=new a(e,d),f=new c(g,f,r);j[e]||(j[e]={});j[e][d]=f;b.debug("Interceptor added.",e,d,f,r)};this.removeInterceptor=function(a,c){j[a]||(j[a]={});delete j[a][c];b.debug("Interceptor removed",a,c)};this.addListener=function(c,e,j,r){var g=new a(c,e),j=new d(g,j,r);f[c]||(f[c]={});f[c][e]||(f[c][e]=[]);f[c][e].push(j);b.debug("Listener added.",c,e,j,r)};this.removeListener=
function(a,c,e,d){if(f[a])if(c&&typeof c=="string"){var g=f[a][c];if(g)for(var j=0;j<g.length;j++){var u=g[j];if(e)if(!d&&u.callback===e){delete u[j];g.splice(j,1);b.debug("Listener removed",a,c,e);break}else{if(u.callback===e&&u.context===d){delete u[j];g.splice(j,1);b.debug("Listener removed",a,c,e,d);break}}else delete u[j],g.splice(j,1),b.debug("Listeners removed",a,c)}}else delete f[a],f[a]={},b.debug("Listeners removed",a)};return this});
Eggshell.module("Listener",[],function(){return function(b,a,c){this.Event=b;this.callback=a;this.context=c}});
Eggshell.module("Loader",["Logger","Egg","ComponentRegistry","EggRegistry"],function(b,a,c,d){var e=0,f=null,j=null;this.getShellInProgress=function(){return f};this.load=function(k,l,q,r){if(k){if(c.exist(k))return c.get(k)}else if(e++,k="eggshell."+e,c.exist(k))throw"Component id is already taken";var g=new a(k,l);d.register(k,g);var o=new Eggshell.Shell(k,l);f=o;q.prototype.Eggshell=o;q.prototype.shell=o;if(typeof r=="object")r.shell=o;var u=null,u=j&&j.instantiate?j.instantiate(k,l,q,r):new q(r);
c.register(k,u);u.Eggshell=o;u.shell=o;g.ready(u);g.trigger("initialize",r);b.debug("Component loaded",k,u);f=null;return k};this.unload=function(a){d.get(a).trigger("destroy");d.unregister(a);var b=c.get(a);j&&j.destroy&&j.destroy(a,b);c.unregister(a)};Eggshell.namespace("loader.setFactory",function(a){j=a});return this});Eggshell.module("ComponentRegistry",["Registry"],function(b){return new b("ComponentRegistry")});Eggshell.module("DefinitionRegistry",["Registry"],function(b){return new b("DefinitionRegistry")});
Eggshell.module("EggRegistry",["Registry"],function(b){return new b("EggRegistry ")});Eggshell.module("InterfaceRegistry",[],function(){function b(a,d){for(var e in d)d.hasOwnProperty(e)&&(a[e]?d[e]instanceof Array&&a[e]instanceof Array?a[e]=a[e].concat(d[e]):typeof d[e]=="object"?b(a[e],d[e]):a[e]=d[e]:a[e]=d[e]);return a}var a={};return{set:function(b,d){a[b]=d;return Eggshell},get:function(c,d){var e=a[c];return!e?null:!d?e:b(d,e)}}});
Eggshell.module("Registry",["Logger"],function(b){return function(a){var c={};this.exist=function(a){return c[a]?!0:!1};this.getAll=function(){var a=[],b;for(b in c)a.push(c[b]);return a};this.get=function(a){return this.exist(a)?c[a]:null};this.register=function(d,e,f){if(!f&&this.exist(d))throw'Key "'+d+'" already taken';c[d]=e;b.debug("Object registered in registry "+a,d,e)};this.unregister=function(d){delete c[d];b.debug("Object unregistered in registry "+a,d)}}});
Eggshell.module("ComponentResourceRegistry",["Registry"],function(b){return new b("EggRegistry ")});
Eggshell.module("Validator",["Logger"],function(){this.validate=function(b,a,c){if(this.detectMethod(c))throw"Payload cannot contain functions";if(b!==null)if(typeof b=="object"){var d;if(typeof b.length=="number")for(c=0;c<b.length;c++){if(d=b[c],d===a)return}else for(d in b)if(d===a)if(b=b[d],b===null||typeof b.payload=="undefined"||b.payload===null)return;else if(b.payload!==null)if(this.validateStructure(b.payload,c))return;else throw"Payload does not confirm to data structure.";else return;throw"Action not found in component configuration.";
}else throw"Invalid input / output configuration";};this.validateStructure=function(b,a){if(typeof b==="string")return typeof a===b?!0:!1;else if(typeof b==="object"){for(var c in b)if(!this.validateStructure(b[c],a[c]))return!1;return!0}else throw"Structure type is not supported. It can either be a native type as a string value or an object of native types.";};this.detectMethod=function(b){if(typeof b==="function")return!0;else{if(typeof b==="object")for(var a in b)if(this.detectMethod(b[a])===!0)return!0;
return!1}};return this});
Eggshell.module("Marker",["Api","DefinitionRegistry","ComponentRegistry"],function(b,a,c){Eggshell.on("*","initialize",function(b){b=b.channel;shell=Eggshell.find(b);var e=shell.getClass(),f=a.get(e);if(f&&f.config&&f.config.markers){if(f.config.strict===!0&&f.config.outputs)$.isArray(f.config.outputs)?f.config.outputs=$.merge(f.config.outputs,["place markers"]):f.config.outputs["place markers"]=null;var j=c.get(b);shell.on("place markers",function(){var a=this.id,b=this.clazz,c=this.component,e=
this.markers,d;for(d in e){var f=e[d].automation;$el=c.$(d);if($el.length<=0)throw'Marker "'+d+'" not found in component "'+a+'".';else escapeCss=function(a){return a=a.replace(/[!\"#$%&'\(\)\*\+,\.\/:;<=>\?\@\[\\\]\^`\{\|\}~]/g,"-").replace(/\s/g,"-")},$el.addClass("chg-test-"+escapeCss(b)+"-"+escapeCss(f))}},{component:j,markers:f.config.markers,id:b,clazz:e})}},this)});
C=function(b,a){for(var b=b.split("."),c=window.C,d,e,f=0;f<b.length;f++){var j=b[f];d=c;e=j;c=c[j]||(c[j]={})}a!==void 0&&(d[e]=a);return c};C("utility");C.utility.exists=function(b,a){for(var a=a.split("."),c=b,d=0;d<a.length;d++){var e=a[d];if(c[e]===void 0)return!1;c=c[e]}return!0};C.utility.access=function(b,a){for(var c=a||window,d,b=b.split("."),e=0;e<b.length;e++){d=b[e];if(c[d]===void 0)return;c=c[d]}return c};
C.utility.getMaxIndex=function(){for(var b=C.dom.$root.children(),a=[10],c=0;c<b.length;c++)a.push(+b[c].style.zIndex||0);return C.utility.max(a)};C.utility.updateCsrfToken=function(b){$.ajax({url:"_ajax/global/init",type:"post",dataType:"json",success:function(a){return function(b){if(b.token!==C.global.csrfToken)C.global.csrfToken=b.token;a&&a()}}(b)})};
C.utility.loadScript=function(b,a,c){var d=document.createElement("script");d.setAttribute("type","text/javascript");d.setAttribute("charset","utf-8");d.readyState?d.onreadystatechange=function(){if(d.readyState=="loaded"||d.readyState=="complete")d.onreadystatechange=null,a()}:d.onload=function(){a()};d.src=b;document.getElementsByTagName("head")[0].appendChild(d);if(c)C.dom.$window.one("pageunload",function(){d.parentNode.removeChild(d)});return d};
C.utility.max=function(b){return Math.max.apply(Math,b)};C.utility.min=function(b){return Math.min.apply(Math,b)};C.utility.addCommasToInt=function(b){b=b.toString();return b.match(/\D/)?null:b=b.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")};C.utility.processPlaceholders=function(){$("[placeholder]").each(function(){var b=$(this),a=b.attr("placeholder");b.placeholder(a)})};C.utility.json2UriParams=function(b){var a=[],c;for(c in b)b[c]&&a.push(c+"="+encodeURIComponent(b[c]));return a.join("&")};
C.utility.getParams=function(){return C.utility.getParamsByUrl(window.location.href)};C.utility.getParamsByUrl=function(b){var a={},c=b.indexOf("?");if(c==-1)return a;var d=b.indexOf("#");d>0&&(b=b.slice(0,d));b=b.substr(c+1,b.length);b=b.split("&");for(d=0;d<b.length;d++)c=b[d].split("="),c[0]=decodeURIComponent(c[0]),c[1]=c[1]==void 0?1:decodeURIComponent(c[1]),a[c[0]]?(Object.prototype.toString.call(a[c[0]])!="[object Array]"&&(a[c[0]]=[a[c[0]]]),a[c[0]].push(c[1])):a[c[0]]=c[1];return a};
C.dump=function(){if(!(top.location.href.indexOf("www.chegg.com")>-1)){for(var b=0,a=arguments.length;b<a;b++)C.log("Variable type: "+Object.prototype.toString.call(arguments[b])),C.log("Variable value: ",arguments[b]);C.log(C.log.divider(10)+" Stacktrace "+C.log.divider(10));console.trace()}};C.log=function(){C.utility.getCookie("logging")!=null&&Function.prototype.bind&&console&&console.log&&Function.prototype.bind.call(console.log,console).apply(console,arguments)};
C.log.divider=function(b){for(var a="",c=0;c<b;c++)a+="=";return a};C.utility.clone=function(b,a){if(b==null||typeof b!="object")return b;var c=new b.constructor,d;for(d in b)a&&d.indexOf(a)!=-1||(c[d]=this.clone(b[d]));return c};
C.utility.bookCover=function(b,a,c){var c=$.extend({cart:!1},c),d="",e="",f="",j="",k="",l="";"undefined"!==typeof c&&null!==c&&("undefined"!==typeof c.isReadNow&&c.isReadNow?j='<div class="read-now-strip"><span class="read-now-icon"></span> Read Now</div>':"undefined"!==typeof c.isRwyw&&c.isRwyw?f="undefined"!==typeof c.stripVersion&&c.stripVersion?'<div class="instant-access-strip">Instant Access</div>':'<div class="instant-access">Includes free <span>Instant Access</span></div>':"undefined"!==
typeof c.showRwywOverlay&&c.showRwywOverlay&&(l='<image id="rwyw-book-overlay-100" src="'+(C.global.staticBaseUrl+"s/_global/images/icn-rwyw-30x30.png")+'"/>'));switch(a){case 1:case 2:d=b.imgThumb;e="book-overlay-60.png";break;case 3:d=b.imgSmall;e="book-overlay-100.png";break;case 4:d=b.imgMedium;e="book-overlay-140.png";break;case 5:d=b.imgLarge,e="book-overlay-180.png"}d.indexOf("http")===-1&&(d=C.global.coversBaseUrl+d);k="";c.cart&&(k="id=book-in-review");k="<div "+k+' class="book-img-'+a;c&&
c.noBoxShadow&&(k+=" noBoxShadow");k+='"><img class="book-cover" src="'+d+'" onerror="this.src=\''+C.global.errorImage+"'\" />";c&&!c.noOverlay&&(a="",c.cart&&(a="id=overlay-in-review"),e=C.global.staticBaseUrl+"s/_global/images/"+e,k+="<img "+a+' class="book-overlay" src="'+e+'" />');k+=l+f+j+"</div>";return k};C.utility.bookCover.dropdown=1;C.utility.bookCover.thumb=2;C.utility.bookCover.small=3;C.utility.bookCover.medium=4;C.utility.bookCover.large=5;C.utility.openGlobalNav=function(){Eggshell.find("C.global.nav").trigger("expand navigation bar")};
C.utility.closeGlobalNav=function(){Eggshell.find("C.global.nav").trigger("collapse navigation bar")};C.utility.reflowSubNav=function(){$(".chg-nav").css({width:C.dom.$content.width()})};C.utility.showTower=function(){$(".chg-container").addClass("has-tower");C.utility.reflowSubNav()};C.utility.hideTower=function(){$(".chg-container").removeClass("has-tower");C.utility.reflowSubNav()};
(function(){var b={},a=["$","_","Backbone","C","Class","console","History","jQuery","swfobject","matchMedia","CRITEO","_FirebugCommandLine","FxFrames","Fx","MathJax","SelectParser","AbstractChosen","get_side_border_padding","SkypeClick2Call","tinyMCE","tinymce","cheggmathjax","WebFont","WebFontConfig","insertSteps","allocatedAxes","ctx","startAngle","FB","fbAsyncInit","fb_xdm_frame_http","fb_xdm_frame_https","BrightTag","btServe","bt_parameter","bt_meta","bt_data","bt_data_escaped","bt_log","bt_handle_exception",
"_bt_url_prefix","_bt_referrer","_bt_site","_bt_mode"],c;for(c in window)b[c]=1;for(c=0;c<a.length;c++)b[a[c]]=1;C.utility.checkPollution=function(){for(var a in window)!b[a]&&a.indexOf("jQuery")!==0&&C.log("pollution of window."+a)}})();
C.utility.navigate=function(b,a){C.global.adTargeting={};if(typeof C.dom!=="undefined"&&typeof C.dom.$window!=="undefined")var c=C.dom.$window.triggerHandler("beforeunload");if(c!==void 0)if(confirm(""+c+"\n\nAre you sure you want to leave this page?"))typeof C.dom!=="undefined"&&typeof C.dom.$window!=="undefined"&&C.dom.$window.unobserve("beforeunload",this);else return;if(History.enabled)try{b!=location.href?a?History.replaceState(null,null,b):History.pushState(null,null,b):C.utility._handleRequest(b)}catch(d){a?
location.replace(b):location.href=b}else a?location.replace(b):location.href=b};C.utility.refresh=function(){C.utility.navigate(location.href)};C.utility.replace=function(b){C.utility.navigate(b,!0)};C.utility.escapeRegEx=function(b){return b.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")};C.utility.escapeHtml=function(b){return $("<div/>").text(b).html()};
C.utility.serializeFormToJson=function(b){var b=(b.jQuery?b:$(b)).serializeArray(),a={};$.each(b,function(b,d){var e=d.name,f=d.value;a[e]=a[e]===void 0?f:$.isArray(a[e])?a[e].concat(f):[a[e],f]});return a};C.utility.attrSupportedByEl=function(b,a){var c=C.utility.attrSupportedByEl.cache[b]||document.createElement(b);C.utility.attrSupportedByEl.cache[b]||(C.utility.attrSupportedByEl.cache[b]=c);return a in c};C.utility.attrSupportedByEl.cache={};
C.utility.rgba2rgb=function(b){var a=b.match(/rgba\((.+)\)/);if(!a)return b;a=a[1].split(",");a.pop();return"rgb("+a.join(",")+")"};C.utility.unique=function(b){var a=[],c=0,d=b.length;a:for(;c<d;c++){for(var e=c+1;e<d;e++)if(b[e]===b[c])continue a;a.push(b[c])}return a};C.utility.setCookie=function(b,a,c){var d=new Date;d.setDate(d.getDate()+c);a=escape(a)+(c==null?"":";expires="+d.toUTCString())+";path=/";document.cookie=b+"="+a+";domain="+(C.global.cookieDomain||COOKIE_DOMAIN)};
C.utility.getCookie=function(b){var a,c,d,e=document.cookie.split(";");for(a=0;a<e.length;a++)if(c=e[a].substr(0,e[a].indexOf("=")),d=e[a].substr(e[a].indexOf("=")+1),c=c.replace(/^\s+|\s+$/g,""),c==b)return unescape(d)};C.utility.setLocal=function(b,a,c){c||(c=864E5);return $.jStorage.set(b,a,{TTL:c})};C.utility.getLocal=function(b,a){return $.jStorage.get(b,a)};C.utility.deleteLocal=function(b){return $.jStorage.deleteKey(b)};C.utility.listLocal=function(){return $.jStorage.index()};
C.utility.getActiveExperiments=function(){var b=C.utility.getCookie("exp");return b&&b.length?b.toUpperCase().split("|"):[]};C.utility.dataLogger=function(){var b=C.utility.getCookie("V"),a=C.utility.getCookie("exp");a.toUpperCase();return $.extend({},{uvn:b,pageTrackId:C.logger.pageTrackId,experiments:a,userUuid:C.global.userUuid})};
C.utility.updateCart=function(b){$.ajax({url:"_ajax/cart/count",dataType:'json',complete:function(a){try{var c=$.parseJSON(a.responseText)}catch(d){c={items:0}}c.items==0||c.items==null?($(".chg-cart-area").css({display:"none"}),$(".hide-with-cart").css({display:"none"})):($(".chg-cart-count").text(c.items),c.items==null&&$(".chg-cart-count").text(0),$(".chg-cart-area").css({display:"inline-block"}),$(".hide-with-cart").css({display:"inline-block"}));typeof b==="function"&&b(c)}})};
C.utility.zeroPad=function(b,a){var c=String(a||10).length-String(b).length+1;return c>0?Array(c).join("0")+b:b};C.utility.getMessage=function(b,a,c,d){return'<div class="'+b+'"><div class="msg-icon">'+(c?'<div class="msg-header">'+c+"</div>":"")+'<div class="msg-text">'+a+(d?'<span class="msg-close"></span>':"")+"</div></div></div>"};
C.utility.showCsrfMessage=function(){if(!C.utility.csrfMessageDialog)C.utility.csrfMessageDialog=Eggshell.create("C.Eggshell.dialog",{el:$("body")}),Eggshell.immuneToDestroyAll(C.utility.csrfMessageDialog);var b=C.utility.csrfMessageDialog;Eggshell.trigger(b,"set headline","Action could not be completed");Eggshell.trigger(b,"hide sub headline");Eggshell.trigger(b,"hide icon");Eggshell.trigger(b,"set content html","Your session has expired due to inactivity. Please refresh the page.");Eggshell.trigger(b,
"show")};C.utility.isISBN10=function(b){b=b.replace(/[^\dxX]/g,"");if(b.length!=10)return!1;b=b.split("");b[9].toUpperCase()=="X"&&(b[9]=10);for(var a=0,c=0;c<b.length;c++)a+=(10-c)*parseInt(b[c]);return a%11==0};C.utility.isISBN13=function(b){b=b.replace(/[^\d]/g,"");if(b.length!=13)return!1;for(var b=b.split(""),a=0,c=0;c<13;c+=2)a+=parseInt(b[c]);for(c=1;c<12;c+=2)a+=3*parseInt(b[c]);return 0==a%10};
C.utility.ordinal=function(b){var a=Math.abs(b)%10;return b+(Math.abs(b)%100<21&&Math.abs(b)%100>4?"th":a<4?a<3?a<2?a<1?"th":"st":"nd":"rd":"th")};var JSON;JSON||(JSON={});
(function(){function b(a){return a<10?"0"+a:a}function a(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var b=k[a];return typeof b==="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(b,e){var d,k,u,p,A=f,z,x=e[b];x&&typeof x==="object"&&typeof x.toJSON==="function"&&(x=x.toJSON(b));typeof l==="function"&&(x=l.call(e,b,x));switch(typeof x){case "string":return a(x);case "number":return isFinite(x)?String(x):"null";case "boolean":case "null":return String(x);
case "object":if(!x)return"null";f+=j;z=[];if(Object.prototype.toString.apply(x)==="[object Array]"){p=x.length;for(d=0;d<p;d+=1)z[d]=c(d,x)||"null";u=z.length===0?"[]":f?"[\n"+f+z.join(",\n"+f)+"\n"+A+"]":"["+z.join(",")+"]";f=A;return u}if(l&&typeof l==="object"){p=l.length;for(d=0;d<p;d+=1)typeof l[d]==="string"&&(k=l[d],(u=c(k,x))&&z.push(a(k)+(f?": ":":")+u))}else for(k in x)Object.prototype.hasOwnProperty.call(x,k)&&(u=c(k,x))&&z.push(a(k)+(f?": ":":")+u);u=z.length===0?"{}":f?"{\n"+f+z.join(",\n"+
f)+"\n"+A+"}":"{"+z.join(",")+"}";f=A;return u}}if(typeof Date.prototype.toJSON!=="function")Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()};var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f,j,k={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;if(typeof JSON.stringify!=="function")JSON.stringify=function(a,b,e){var d;j=f="";if(typeof e==="number")for(d=0;d<e;d+=1)j+=" ";else typeof e==="string"&&(j=e);if((l=b)&&typeof b!=="function"&&(typeof b!=="object"||typeof b.length!=="number"))throw Error("JSON.stringify");return c("",
{"":a})};if(typeof JSON.parse!=="function")JSON.parse=function(a,b){function c(a,e){var d,f,j=a[e];if(j&&typeof j==="object")for(d in j)Object.prototype.hasOwnProperty.call(j,d)&&(f=c(j,d),f!==void 0?j[d]=f:delete j[d]);return b.call(a,e,j)}var e,a=String(a);d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),typeof b==="function"?c({"":e},""):e;throw new SyntaxError("JSON.parse");}})();
(function(){function b(a,c){function e(){if(a=="session")try{k=g.parse(window.name||"{}")}catch(b){k={}}}var d=!1,f=0,h,j,k={};if(c||typeof window[a+"Storage"]=="undefined")if(a=="local"&&window.globalStorage)localStorage=window.globalStorage[window.location.hostname];else if(z=="userDataBehavior"){c&&window[a+"Storage"]&&window[a+"Storage"].parentNode&&window[a+"Storage"].parentNode.removeChild(window[a+"Storage"]);j=document.createElement("button");document.getElementsByTagName("head")[0].appendChild(j);
a=="local"?k=o:a=="session"&&e();for(h in k)k.hasOwnProperty(h)&&h!="__jstorage_meta"&&h!="length"&&typeof k[h]!="undefined"&&(h in j||f++,j[h]=k[h]);j.length=f;j.key=function(a){var b=0,c;e();for(c in k)if(k.hasOwnProperty(c)&&c!="__jstorage_meta"&&c!="length"&&typeof k[c]!="undefined"){if(b==a)return c;b++}};j.getItem=function(b){e();return a=="session"?k[b]:r.jStorage.get(b)};j.setItem=function(a,b){typeof b!="undefined"&&(j[a]=(b||"").toString())};j.removeItem=function(b){if(a=="local")return r.jStorage.deleteKey(b);
j[b]=void 0;d=!0;b in j&&j.removeAttribute(b);d=!1};j.clear=function(){a=="session"?(window.name="",b("session",!0)):r.jStorage.flush()};a=="local"&&(K=function(a,b){if(a!="length")d=!0,typeof b=="undefined"?a in j&&(f--,j.removeAttribute(a)):(a in j||f++,j[a]=(b||"").toString()),j.length=f,d=!1});j.attachEvent("onpropertychange",function(b){if(b.propertyName!="length"&&!(d||b.propertyName=="length")){if(a=="local")!(b.propertyName in k)&&typeof j[b.propertyName]!="undefined"&&f++;else if(a=="session"){e();
typeof j[b.propertyName]!="undefined"&&!(b.propertyName in k)?(k[b.propertyName]=j[b.propertyName],f++):typeof j[b.propertyName]=="undefined"&&b.propertyName in k?(delete k[b.propertyName],f--):k[b.propertyName]=j[b.propertyName];if(a=="session")window.name=g.stringify(k);j.length=f;return}r.jStorage.set(b.propertyName,j[b.propertyName]);j.length=f}});window[a+"Storage"]=j}}function a(){var a="{}";if(z=="userDataBehavior"){p.load("jStorage");try{a=p.getAttribute("jStorage")}catch(b){}try{N=p.getAttribute("jStorage_update")}catch(c){}u.jStorage=
a}f();l();q()}function c(){var b;clearTimeout(J);J=setTimeout(function(){if(z=="localStorage"||z=="globalStorage")b=u.jStorage_update;else if(z=="userDataBehavior"){p.load("jStorage");try{b=p.getAttribute("jStorage_update")}catch(c){}}if(b&&b!=N){N=b;var e=g.parse(g.stringify(o.__jstorage_meta.CRC32)),f;a();f=g.parse(g.stringify(o.__jstorage_meta.CRC32));var j,h=[],k=[];for(j in e)e.hasOwnProperty(j)&&(f[j]?e[j]!=f[j]&&String(e[j]).substr(0,2)=="2."&&h.push(j):k.push(j));for(j in f)f.hasOwnProperty(j)&&
(e[j]||h.push(j));d(h,"updated");d(k,"deleted")}},25)}function d(a,b){a=[].concat(a||[]);if(b=="flushed"){var a=[],c;for(c in x)x.hasOwnProperty(c)&&a.push(c);b="deleted"}c=0;for(var e=a.length;c<e;c++)if(x[a[c]])for(var d=0,f=x[a[c]].length;d<f;d++)x[a[c]][d](a[c],b)}function e(){var a=(+new Date).toString();z=="localStorage"||z=="globalStorage"?u.jStorage_update=a:z=="userDataBehavior"&&(p.setAttribute("jStorage_update",a),p.save("jStorage"));c()}function f(){if(u.jStorage)try{o=g.parse(String(u.jStorage))}catch(a){u.jStorage=
"{}"}else u.jStorage="{}";A=u.jStorage?String(u.jStorage).length:0;if(!o.__jstorage_meta)o.__jstorage_meta={};if(!o.__jstorage_meta.CRC32)o.__jstorage_meta.CRC32={}}function j(){if(o.__jstorage_meta.PubSub){for(var a=+new Date-2E3,b=0,c=o.__jstorage_meta.PubSub.length;b<c;b++)if(o.__jstorage_meta.PubSub[b][0]<=a){o.__jstorage_meta.PubSub.splice(b,o.__jstorage_meta.PubSub.length-b);break}o.__jstorage_meta.PubSub.length||delete o.__jstorage_meta.PubSub}try{u.jStorage=g.stringify(o),p&&(p.setAttribute("jStorage",
u.jStorage),p.save("jStorage")),A=u.jStorage?String(u.jStorage).length:0}catch(e){}}function k(a){if(!a||typeof a!="string"&&typeof a!="number")throw new TypeError("Key name must be string or numeric");if(a=="__jstorage_meta")throw new TypeError("Reserved key name");return!0}function l(){var a,b,c,f,g=Infinity,h=!1,k=[];clearTimeout(D);if(o.__jstorage_meta&&typeof o.__jstorage_meta.TTL=="object"){a=+new Date;c=o.__jstorage_meta.TTL;f=o.__jstorage_meta.CRC32;for(b in c)c.hasOwnProperty(b)&&(c[b]<=
a?(delete c[b],delete f[b],delete o[b],h=!0,k.push(b)):c[b]<g&&(g=c[b]));g!=Infinity&&(D=setTimeout(l,g-a));h&&(j(),e(),d(k,"deleted"))}}function q(){if(o.__jstorage_meta.PubSub){for(var a,b=n,c=len=o.__jstorage_meta.PubSub.length-1;c>=0;c--)if(a=o.__jstorage_meta.PubSub[c],a[0]>n){var b=a[0],e=a[1];a=a[2];if(F[e])for(var d=0,f=F[e].length;d<f;d++)F[e][d](e,g.parse(g.stringify(a)))}n=b}}var r=window.jQuery||window.$||(window.$={}),g={parse:window.JSON&&(window.JSON.parse||window.JSON.decode)||String.prototype.evalJSON&&
function(a){return String(a).evalJSON()}||r.parseJSON||r.evalJSON,stringify:Object.toJSON||window.JSON&&(window.JSON.stringify||window.JSON.encode)||r.toJSON};if(!g.parse||!g.stringify)throw Error("No JSON support found, include //cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js to page");var o={__jstorage_meta:{CRC32:{}}},u={jStorage:"{}"},p=null,A=0,z=!1,x={},J=!1,N=0,F={},n=+new Date,D,P={isXML:function(a){return(a=(a?a.ownerDocument||a:0).documentElement)?a.nodeName!=="HTML":!1},encode:function(a){if(!this.isXML(a))return!1;
try{return(new XMLSerializer).serializeToString(a)}catch(b){try{return a.xml}catch(c){}}return!1},decode:function(a){var b="DOMParser"in window&&(new DOMParser).parseFromString||window.ActiveXObject&&function(a){var b=new ActiveXObject("Microsoft.XMLDOM");b.async="false";b.loadXML(a);return b};if(!b)return!1;a=b.call("DOMParser"in window&&new DOMParser||window,a,"text/xml");return this.isXML(a)?a:!1}},K=function(){};r.jStorage={version:"0.3.2",set:function(a,b,c){k(a);c=c||{};if(typeof b=="undefined")return this.deleteKey(a),
b;if(P.isXML(b))b={_is_xml:!0,xml:P.encode(b)};else if(typeof b=="function")return;else b&&typeof b=="object"&&(b=g.parse(g.stringify(b)));o[a]=b;for(var e=o.__jstorage_meta.CRC32,f=g.stringify(b),h=f.length,j=NaN^h,t=0,l;h>=4;)l=f.charCodeAt(t)&255|(f.charCodeAt(++t)&255)<<8|(f.charCodeAt(++t)&255)<<16|(f.charCodeAt(++t)&255)<<24,l=(l&65535)*1540483477+(((l>>>16)*1540483477&65535)<<16),l^=l>>>24,l=(l&65535)*1540483477+(((l>>>16)*1540483477&65535)<<16),j=(j&65535)*1540483477+(((j>>>16)*1540483477&
65535)<<16)^l,h-=4,++t;switch(h){case 3:j^=(f.charCodeAt(t+2)&255)<<16;case 2:j^=(f.charCodeAt(t+1)&255)<<8;case 1:j^=f.charCodeAt(t)&255,j=(j&65535)*1540483477+(((j>>>16)*1540483477&65535)<<16)}j^=j>>>13;j=(j&65535)*1540483477+(((j>>>16)*1540483477&65535)<<16);j^=j>>>15;e[a]="2."+(j>>>0);this.setTTL(a,c.TTL||0);K(a,b);d(a,"updated");return b},get:function(a,b){k(a);return a in o?o[a]&&typeof o[a]=="object"&&o[a]._is_xml?P.decode(o[a].xml):o[a]:typeof b=="undefined"?null:b},deleteKey:function(a){k(a);
return a in o?(delete o[a],typeof o.__jstorage_meta.TTL=="object"&&a in o.__jstorage_meta.TTL&&delete o.__jstorage_meta.TTL[a],delete o.__jstorage_meta.CRC32[a],K(a,void 0),j(),e(),d(a,"deleted"),!0):!1},setTTL:function(a,b){var c=+new Date;k(a);b=Number(b)||0;if(a in o){if(!o.__jstorage_meta.TTL)o.__jstorage_meta.TTL={};b>0?o.__jstorage_meta.TTL[a]=c+b:delete o.__jstorage_meta.TTL[a];j();l();e();return!0}return!1},getTTL:function(a){var b=+new Date;k(a);return a in o&&o.__jstorage_meta.TTL&&o.__jstorage_meta.TTL[a]?
(a=o.__jstorage_meta.TTL[a]-b)||0:0},flush:function(){o={__jstorage_meta:{CRC32:{}}};b("local",!0);j();e();d(null,"flushed");return!0},storageObj:function(){function a(){}a.prototype=o;return new a},index:function(){var a=[],b;for(b in o)o.hasOwnProperty(b)&&b!="__jstorage_meta"&&a.push(b);return a},storageSize:function(){return A},currentBackend:function(){return z},storageAvailable:function(){return!!z},listenKeyChange:function(a,b){k(a);x[a]||(x[a]=[]);x[a].push(b)},stopListening:function(a,b){k(a);
if(x[a])if(b)for(var c=x[a].length-1;c>=0;c--)x[a][c]==b&&x[a].splice(c,1);else delete x[a]},subscribe:function(a,b){a=(a||"").toString();if(!a)throw new TypeError("Channel not defined");F[a]||(F[a]=[]);F[a].push(b)},publish:function(a,b){a=(a||"").toString();if(!a)throw new TypeError("Channel not defined");var c;if(!o.__jstorage_meta)o.__jstorage_meta={};if(!o.__jstorage_meta.PubSub)o.__jstorage_meta.PubSub=[];o.__jstorage_meta.PubSub.unshift([+new Date,a,b]);j();e()},reInit:function(){a()}};(function(){var a=
!1;if("localStorage"in window)try{window.localStorage.setItem("_tmptest","tmpval"),a=!0,window.localStorage.removeItem("_tmptest")}catch(e){}if(a)try{if(window.localStorage)u=window.localStorage,z="localStorage",N=u.jStorage_update}catch(d){}else if("globalStorage"in window)try{if(window.globalStorage)u=window.globalStorage[window.location.hostname],z="globalStorage",N=u.jStorage_update}catch(g){}else if(p=document.createElement("link"),p.addBehavior){p.style.behavior="url(#default#userData)";document.getElementsByTagName("head")[0].appendChild(p);
try{p.load("jStorage")}catch(j){p.setAttribute("jStorage","{}"),p.save("jStorage"),p.load("jStorage")}a="{}";try{a=p.getAttribute("jStorage")}catch(h){}try{N=p.getAttribute("jStorage_update")}catch(k){}u.jStorage=a;z="userDataBehavior"}else{p=null;return}f();l();b("local");b("session");z=="localStorage"||z=="globalStorage"?"addEventListener"in window?window.addEventListener("storage",c,!1):document.attachEvent("onstorage",c):z=="userDataBehavior"&&setInterval(c,1E3);q();"addEventListener"in window&&
window.addEventListener("pageshow",function(a){a.persisted&&c()},!1)})()})();
(function(){var b=this,a=b._,c={},d=Array.prototype,e=Object.prototype,f=d.push,j=d.slice,k=d.concat,l=e.toString,q=e.hasOwnProperty,r=d.forEach,g=d.map,o=d.reduce,u=d.reduceRight,p=d.filter,A=d.every,z=d.some,x=d.indexOf,J=d.lastIndexOf,e=Array.isArray,N=Object.keys,F=Function.prototype.bind,n=function(a){if(a instanceof n)return a;if(!(this instanceof n))return new n(a);this._wrapped=a};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports)exports=module.exports=n;exports._=
n}else b._=n;n.VERSION="1.4.3";var D=n.each=n.forEach=function(a,b,e){if(a!=null)if(r&&a.forEach===r)a.forEach(b,e);else if(a.length===+a.length)for(var d=0,f=a.length;d<f;d++){if(b.call(e,a[d],d,a)===c)break}else for(d in a)if(n.has(a,d)&&b.call(e,a[d],d,a)===c)break};n.map=n.collect=function(a,b,c){var e=[];if(a==null)return e;if(g&&a.map===g)return a.map(b,c);D(a,function(a,d,f){e[e.length]=b.call(c,a,d,f)});return e};n.reduce=n.foldl=n.inject=function(a,b,c,e){var d=arguments.length>2;a==null&&
(a=[]);if(o&&a.reduce===o)return e&&(b=n.bind(b,e)),d?a.reduce(b,c):a.reduce(b);D(a,function(a,f,g){d?c=b.call(e,c,a,f,g):(c=a,d=!0)});if(!d)throw new TypeError("Reduce of empty array with no initial value");return c};n.reduceRight=n.foldr=function(a,b,c,e){var d=arguments.length>2;a==null&&(a=[]);if(u&&a.reduceRight===u)return e&&(b=n.bind(b,e)),d?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f)var g=n.keys(a),f=g.length;D(a,function(h,j,k){j=g?g[--f]:--f;d?c=b.call(e,c,a[j],j,k):(c=
a[j],d=!0)});if(!d)throw new TypeError("Reduce of empty array with no initial value");return c};n.find=n.detect=function(a,b,c){var e;P(a,function(a,d,f){if(b.call(c,a,d,f))return e=a,!0});return e};n.filter=n.select=function(a,b,c){var e=[];if(a==null)return e;if(p&&a.filter===p)return a.filter(b,c);D(a,function(a,d,f){b.call(c,a,d,f)&&(e[e.length]=a)});return e};n.reject=function(a,b,c){return n.filter(a,function(a,e,d){return!b.call(c,a,e,d)},c)};n.every=n.all=function(a,b,e){b||(b=n.identity);
var d=!0;if(a==null)return d;if(A&&a.every===A)return a.every(b,e);D(a,function(a,f,g){if(!(d=d&&b.call(e,a,f,g)))return c});return!!d};var P=n.some=n.any=function(a,b,e){b||(b=n.identity);var d=!1;if(a==null)return d;if(z&&a.some===z)return a.some(b,e);D(a,function(a,f,g){if(d||(d=b.call(e,a,f,g)))return c});return!!d};n.contains=n.include=function(a,b){return a==null?!1:x&&a.indexOf===x?a.indexOf(b)!=-1:P(a,function(a){return a===b})};n.invoke=function(a,b){var c=j.call(arguments,2),e=n.isFunction(b);
return n.map(a,function(a){return(e?b:a[b]).apply(a,c)})};n.pluck=function(a,b){return n.map(a,function(a){return a[b]})};n.where=function(a,b){return n.isEmpty(b)?[]:n.filter(a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})};n.max=function(a,b,c){if(!b&&n.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);if(!b&&n.isEmpty(a))return-Infinity;var e={computed:-Infinity,value:-Infinity};D(a,function(a,d,f){d=b?b.call(c,a,d,f):a;d>=e.computed&&(e={value:a,computed:d})});
return e.value};n.min=function(a,b,c){if(!b&&n.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);if(!b&&n.isEmpty(a))return Infinity;var e={computed:Infinity,value:Infinity};D(a,function(a,d,f){d=b?b.call(c,a,d,f):a;d<e.computed&&(e={value:a,computed:d})});return e.value};n.shuffle=function(a){var b,c=0,e=[];D(a,function(a){b=n.random(c++);e[c-1]=e[b];e[b]=a});return e};var K=function(a){return n.isFunction(a)?a:function(b){return b[a]}};n.sortBy=function(a,b,c){var e=K(b);return n.pluck(n.map(a,
function(a,b,d){return{value:a,index:b,criteria:e.call(c,a,b,d)}}).sort(function(a,b){var c=a.criteria,e=b.criteria;if(c!==e){if(c>e||c===void 0)return 1;if(c<e||e===void 0)return-1}return a.index<b.index?-1:1}),"value")};var I=function(a,b,c,e){var d={},f=K(b||n.identity);D(a,function(b,g){var h=f.call(c,b,g,a);e(d,h,b)});return d};n.groupBy=function(a,b,c){return I(a,b,c,function(a,b,c){(n.has(a,b)?a[b]:a[b]=[]).push(c)})};n.countBy=function(a,b,c){return I(a,b,c,function(a,b){n.has(a,b)||(a[b]=
0);a[b]++})};n.sortedIndex=function(a,b,c,e){for(var c=c==null?n.identity:K(c),b=c.call(e,b),d=0,f=a.length;d<f;){var g=d+f>>>1;c.call(e,a[g])<b?d=g+1:f=g}return d};n.toArray=function(a){return!a?[]:n.isArray(a)?j.call(a):a.length===+a.length?n.map(a,n.identity):n.values(a)};n.size=function(a){return a==null?0:a.length===+a.length?a.length:n.keys(a).length};n.first=n.head=n.take=function(a,b,c){return a==null?void 0:b!=null&&!c?j.call(a,0,b):a[0]};n.initial=function(a,b,c){return j.call(a,0,a.length-
(b==null||c?1:b))};n.last=function(a,b,c){return a==null?void 0:b!=null&&!c?j.call(a,Math.max(a.length-b,0)):a[a.length-1]};n.rest=n.tail=n.drop=function(a,b,c){return j.call(a,b==null||c?1:b)};n.compact=function(a){return n.filter(a,n.identity)};var M=function(a,b,c){D(a,function(a){n.isArray(a)?b?f.apply(c,a):M(a,b,c):c.push(a)});return c};n.flatten=function(a,b){return M(a,b,[])};n.without=function(a){return n.difference(a,j.call(arguments,1))};n.uniq=n.unique=function(a,b,c,e){n.isFunction(b)&&
(e=c,c=b,b=!1);var c=c?n.map(a,c,e):a,d=[],f=[];D(c,function(c,e){if(b?!e||f[f.length-1]!==c:!n.contains(f,c))f.push(c),d.push(a[e])});return d};n.union=function(){return n.uniq(k.apply(d,arguments))};n.intersection=function(a){var b=j.call(arguments,1);return n.filter(n.uniq(a),function(a){return n.every(b,function(b){return n.indexOf(b,a)>=0})})};n.difference=function(a){var b=k.apply(d,j.call(arguments,1));return n.filter(a,function(a){return!n.contains(b,a)})};n.zip=function(){for(var a=j.call(arguments),
b=n.max(n.pluck(a,"length")),c=Array(b),e=0;e<b;e++)c[e]=n.pluck(a,""+e);return c};n.object=function(a,b){if(a==null)return{};for(var c={},e=0,d=a.length;e<d;e++)b?c[a[e]]=b[e]:c[a[e][0]]=a[e][1];return c};n.indexOf=function(a,b,c){if(a==null)return-1;var e=0,d=a.length;if(c)if(typeof c=="number")e=c<0?Math.max(0,d+c):c;else return e=n.sortedIndex(a,b),a[e]===b?e:-1;if(x&&a.indexOf===x)return a.indexOf(b,c);for(;e<d;e++)if(a[e]===b)return e;return-1};n.lastIndexOf=function(a,b,c){if(a==null)return-1;
var e=c!=null;if(J&&a.lastIndexOf===J)return e?a.lastIndexOf(b,c):a.lastIndexOf(b);for(c=e?c:a.length;c--;)if(a[c]===b)return c;return-1};n.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0);for(var c=arguments[2]||1,e=Math.max(Math.ceil((b-a)/c),0),d=0,f=Array(e);d<e;)f[d++]=a,a+=c;return f};var s=function(){};n.bind=function(a,b){var c,e;if(a.bind===F&&F)return F.apply(a,j.call(arguments,1));if(!n.isFunction(a))throw new TypeError;c=j.call(arguments,2);return e=function(){if(!(this instanceof
e))return a.apply(b,c.concat(j.call(arguments)));s.prototype=a.prototype;var d=new s;s.prototype=null;var f=a.apply(d,c.concat(j.call(arguments)));return Object(f)===f?f:d}};n.bindAll=function(a){var b=j.call(arguments,1);b.length===0&&(b=n.functions(a));D(b,function(b){a[b]=n.bind(a[b],a)});return a};n.memoize=function(a,b){var c={};b||(b=n.identity);return function(){var e=b.apply(this,arguments);return n.has(c,e)?c[e]:c[e]=a.apply(this,arguments)}};n.delay=function(a,b){var c=j.call(arguments,
2);return setTimeout(function(){return a.apply(null,c)},b)};n.defer=function(a){return n.delay.apply(n,[a,1].concat(j.call(arguments,1)))};n.throttle=function(a,b){var c,e,d,f,g=0,h=function(){g=new Date;d=null;f=a.apply(c,e)};return function(){var j=new Date,k=b-(j-g);c=this;e=arguments;k<=0?(clearTimeout(d),d=null,g=j,f=a.apply(c,e)):d||(d=setTimeout(h,k));return f}};n.debounce=function(a,b,c){var e,d;return function(){var f=this,g=arguments,h=c&&!e;clearTimeout(e);e=setTimeout(function(){e=null;
c||(d=a.apply(f,g))},b);h&&(d=a.apply(f,g));return d}};n.once=function(a){var b=!1,c;return function(){if(b)return c;b=!0;c=a.apply(this,arguments);a=null;return c}};n.wrap=function(a,b){return function(){var c=[a];f.apply(c,arguments);return b.apply(this,c)}};n.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}};n.after=function(a,b){return a<=0?b():function(){if(--a<1)return b.apply(this,arguments)}};n.keys=N||function(a){if(a!==
Object(a))throw new TypeError("Invalid object");var b=[],c;for(c in a)n.has(a,c)&&(b[b.length]=c);return b};n.values=function(a){var b=[],c;for(c in a)n.has(a,c)&&b.push(a[c]);return b};n.pairs=function(a){var b=[],c;for(c in a)n.has(a,c)&&b.push([c,a[c]]);return b};n.invert=function(a){var b={},c;for(c in a)n.has(a,c)&&(b[a[c]]=c);return b};n.functions=n.methods=function(a){var b=[],c;for(c in a)n.isFunction(a[c])&&b.push(c);return b.sort()};n.extend=function(a){D(j.call(arguments,1),function(b){if(b)for(var c in b)a[c]=
b[c]});return a};n.pick=function(a){var b={},c=k.apply(d,j.call(arguments,1));D(c,function(c){c in a&&(b[c]=a[c])});return b};n.omit=function(a){var b={},c=k.apply(d,j.call(arguments,1)),e;for(e in a)n.contains(c,e)||(b[e]=a[e]);return b};n.defaults=function(a){D(j.call(arguments,1),function(b){if(b)for(var c in b)a[c]==null&&(a[c]=b[c])});return a};n.clone=function(a){return!n.isObject(a)?a:n.isArray(a)?a.slice():n.extend({},a)};n.tap=function(a,b){b(a);return a};var U=function(a,b,c,e){if(a===b)return a!==
0||1/a==1/b;if(a==null||b==null)return a===b;if(a instanceof n)a=a._wrapped;if(b instanceof n)b=b._wrapped;var d=l.call(a);if(d!=l.call(b))return!1;switch(d){case "[object String]":return a==String(b);case "[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case "[object Date]":case "[object Boolean]":return+a==+b;case "[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return!1;for(var f=
c.length;f--;)if(c[f]==a)return e[f]==b;c.push(a);e.push(b);var f=0,g=!0;if(d=="[object Array]"){if(f=a.length,g=f==b.length)for(;f--;)if(!(g=U(a[f],b[f],c,e)))break}else{var d=a.constructor,h=b.constructor;if(d!==h&&(!n.isFunction(d)||!(d instanceof d&&n.isFunction(h)&&h instanceof h)))return!1;for(var j in a)if(n.has(a,j)&&(f++,!(g=n.has(b,j)&&U(a[j],b[j],c,e))))break;if(g){for(j in b)if(n.has(b,j)&&!f--)break;g=!f}}c.pop();e.pop();return g};n.isEqual=function(a,b){return U(a,b,[],[])};n.isEmpty=
function(a){if(a==null)return!0;if(n.isArray(a)||n.isString(a))return a.length===0;for(var b in a)if(n.has(a,b))return!1;return!0};n.isElement=function(a){return!!(a&&a.nodeType===1)};n.isArray=e||function(a){return l.call(a)=="[object Array]"};n.isObject=function(a){return a===Object(a)};D(["Arguments","Function","String","Number","Date","RegExp"],function(a){n["is"+a]=function(b){return l.call(b)=="[object "+a+"]"}});if(!n.isArguments(arguments))n.isArguments=function(a){return!(!a||!n.has(a,"callee"))};
if(typeof/./!=="function")n.isFunction=function(a){return typeof a==="function"};n.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};n.isNaN=function(a){return n.isNumber(a)&&a!=+a};n.isBoolean=function(a){return a===!0||a===!1||l.call(a)=="[object Boolean]"};n.isNull=function(a){return a===null};n.isUndefined=function(a){return a===void 0};n.has=function(a,b){return q.call(a,b)};n.noConflict=function(){b._=a;return this};n.identity=function(a){return a};n.times=function(a,b,c){for(var e=
Array(a),d=0;d<a;d++)e[d]=b.call(c,d);return e};n.random=function(a,b){b==null&&(b=a,a=0);return a+Math.floor(Math.random()*(b-a+1))};var L={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};L.unescape=n.invert(L.escape);var h={escape:RegExp("["+n.keys(L.escape).join("")+"]","g"),unescape:RegExp("("+n.keys(L.unescape).join("|")+")","g")};n.each(["escape","unescape"],function(a){n[a]=function(b){return b==null?"":(""+b).replace(h[a],function(b){return L[a][b]})}});
n.result=function(a,b){if(a==null)return null;var c=a[b];return n.isFunction(c)?c.call(a):c};n.mixin=function(a){D(n.functions(a),function(b){var c=n[b]=a[b];n.prototype[b]=function(){var a=[this._wrapped];f.apply(a,arguments);a=c.apply(n,a);return this._chain?n(a).chain():a}})};var O=0;n.uniqueId=function(a){var b=++O+"";return a?a+b:b};n.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var t=/(.)^/,y={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t",
"\u2028":"u2028","\u2029":"u2029"},B=/\\|'|\r|\n|\t|\u2028|\u2029/g;n.template=function(a,b,c){var e,c=n.defaults({},c,n.templateSettings),d=RegExp([(c.escape||t).source,(c.interpolate||t).source,(c.evaluate||t).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(d,function(b,c,e,d,h){g+=a.slice(f,h).replace(B,function(a){return"\\"+y[a]});c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'");e&&(g+="'+\n((__t=("+e+"))==null?'':__t)+\n'");d&&(g+="';\n"+d+"\n__p+='");f=h+b.length;return b});g+=
"';\n";c.variable||(g="with(obj||{}){\n"+g+"}\n");g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{e=new Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h;}if(b)return e(b,n);b=function(a){return e.call(this,a,n)};b.source="function("+(c.variable||"obj")+"){\n"+g+"}";return b};n.chain=function(a){return n(a).chain()};n.mixin(n);D(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];n.prototype[a]=
function(){var c=this._wrapped;b.apply(c,arguments);(a=="shift"||a=="splice")&&c.length===0&&delete c[0];return this._chain?n(c).chain():c}});D(["concat","join","slice"],function(a){var b=d[a];n.prototype[a]=function(){var a=b.apply(this._wrapped,arguments);return this._chain?n(a).chain():a}});n.extend(n.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}})}).call(this);
(function(){var b=this,a=b.Backbone,c=[],d=c.push,e=c.slice,f=c.splice,j;j=typeof exports!=="undefined"?exports:b.Backbone={};j.VERSION="1.0.0";var k=b._;!k&&typeof require!=="undefined"&&(k=require("underscore"));j.$=b.jQuery||b.Zepto||b.ender||b.$;j.noConflict=function(){b.Backbone=a;return this};j.emulateHTTP=!1;j.emulateJSON=!1;var l=j.Events={on:function(a,b,c){if(!r(this,"on",a,[b,c])||!b)return this;this._events||(this._events={});(this._events[a]||(this._events[a]=[])).push({callback:b,context:c,
ctx:c||this});return this},once:function(a,b,c){if(!r(this,"once",a,[b,c])||!b)return this;var e=this,d=k.once(function(){e.off(a,d);b.apply(this,arguments)});d._callback=b;return this.on(a,d,c)},off:function(a,b,c){var e,d,f,g,h,j,l,p;if(!this._events||!r(this,"off",a,[b,c]))return this;if(!a&&!b&&!c)return this._events={},this;g=a?[a]:k.keys(this._events);h=0;for(j=g.length;h<j;h++)if(a=g[h],f=this._events[a]){this._events[a]=e=[];if(b||c){l=0;for(p=f.length;l<p;l++)d=f[l],(b&&b!==d.callback&&b!==
d.callback._callback||c&&c!==d.context)&&e.push(d)}e.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=e.call(arguments,1);if(!r(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;c&&g(c,b);d&&g(d,arguments);return this},stopListening:function(a,b,c){var e=this._listeners;if(!e)return this;var d=!b&&!c;typeof b==="object"&&(c=this);a&&((e={})[a._listenerId]=a);for(var f in e)e[f].off(b,c,this),d&&delete this._listeners[f];return this}},
q=/\s+/,r=function(a,b,c,e){if(!c)return!0;if(typeof c==="object"){for(var d in c)a[b].apply(a,[d,c[d]].concat(e));return!1}if(q.test(c)){c=c.split(q);d=0;for(var f=c.length;d<f;d++)a[b].apply(a,[c[d]].concat(e));return!1}return!0},g=function(a,b){var c,e=-1,d=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++e<d;)(c=a[e]).callback.call(c.ctx);break;case 1:for(;++e<d;)(c=a[e]).callback.call(c.ctx,f);break;case 2:for(;++e<d;)(c=a[e]).callback.call(c.ctx,f,g);break;case 3:for(;++e<d;)(c=
a[e]).callback.call(c.ctx,f,g,h);break;default:for(;++e<d;)(c=a[e]).callback.apply(c.ctx,b)}};k.each({listenTo:"on",listenToOnce:"once"},function(a,b){l[b]=function(b,c,e){var d=this._listeners||(this._listeners={}),f=b._listenerId||(b._listenerId=k.uniqueId("l"));d[f]=b;typeof c==="object"&&(e=this);b[a](c,e,this);return this}});l.bind=l.on;l.unbind=l.off;k.extend(j,l);var o=j.Model=function(a,b){var c,e=a||{};b||(b={});this.cid=k.uniqueId("c");this.attributes={};k.extend(this,k.pick(b,u));b.parse&&
(e=this.parse(e,b)||{});if(c=k.result(this,"defaults"))e=k.defaults({},e,c);this.set(e,b);this.changed={};this.initialize.apply(this,arguments)},u=["url","urlRoot","collection"];k.extend(o.prototype,l,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return k.clone(this.attributes)},sync:function(){return j.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return k.escape(this.get(a))},has:function(a){return this.get(a)!=
null},set:function(a,b,c){var e,d,f,g,h,j,l;if(a==null)return this;typeof a==="object"?(d=a,c=b):(d={})[a]=b;c||(c={});if(!this._validate(d,c))return!1;f=c.unset;g=c.silent;a=[];h=this._changing;this._changing=!0;if(!h)this._previousAttributes=k.clone(this.attributes),this.changed={};l=this.attributes;j=this._previousAttributes;if(this.idAttribute in d)this.id=d[this.idAttribute];for(e in d)b=d[e],k.isEqual(l[e],b)||a.push(e),k.isEqual(j[e],b)?delete this.changed[e]:this.changed[e]=b,f?delete l[e]:
l[e]=b;if(!g){if(a.length)this._pending=!0;b=0;for(e=a.length;b<e;b++)this.trigger("change:"+a[b],this,l[a[b]],c)}if(h)return this;if(!g)for(;this._pending;)this._pending=!1,this.trigger("change",this,c);this._changing=this._pending=!1;return this},unset:function(a,b){return this.set(a,void 0,k.extend({},b,{unset:!0}))},clear:function(a){var b={},c;for(c in this.attributes)b[c]=void 0;return this.set(b,k.extend({},a,{unset:!0}))},hasChanged:function(a){return a==null?!k.isEmpty(this.changed):k.has(this.changed,
a)},changedAttributes:function(a){if(!a)return this.hasChanged()?k.clone(this.changed):!1;var b,c=!1,e=this._changing?this._previousAttributes:this.attributes,d;for(d in a)if(!k.isEqual(e[d],b=a[d]))(c||(c={}))[d]=b;return c},previous:function(a){return a==null||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return k.clone(this._previousAttributes)},fetch:function(a){a=a?k.clone(a):{};if(a.parse===void 0)a.parse=!0;var b=this,c=a.success;a.success=function(e){if(!b.set(b.parse(e,
a),a))return!1;c&&c(b,e,a);b.trigger("sync",b,e,a)};O(this,a);return this.sync("read",this,a)},save:function(a,b,c){var e,d=this.attributes;a==null||typeof a==="object"?(e=a,c=b):(e={})[a]=b;if(e&&(!c||!c.wait)&&!this.set(e,c))return!1;c=k.extend({validate:!0},c);if(!this._validate(e,c))return!1;if(e&&c.wait)this.attributes=k.extend({},d,e);if(c.parse===void 0)c.parse=!0;var f=this,g=c.success;c.success=function(a){f.attributes=d;var b=f.parse(a,c);c.wait&&(b=k.extend(e||{},b));if(k.isObject(b)&&
!f.set(b,c))return!1;g&&g(f,a,c);f.trigger("sync",f,a,c)};O(this,c);a=this.isNew()?"create":c.patch?"patch":"update";if(a==="patch")c.attrs=e;a=this.sync(a,this,c);if(e&&c.wait)this.attributes=d;return a},destroy:function(a){var a=a?k.clone(a):{},b=this,c=a.success,e=function(){b.trigger("destroy",b,b.collection,a)};a.success=function(d){(a.wait||b.isNew())&&e();c&&c(b,d,a);b.isNew()||b.trigger("sync",b,d,a)};if(this.isNew())return a.success(),!1;O(this,a);var d=this.sync("delete",this,a);a.wait||
e();return d},url:function(){var a=k.result(this,"urlRoot")||k.result(this.collection,"url")||h();return this.isNew()?a:a+(a.charAt(a.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(a){return this._validate({},k.extend(a||{},{validate:!0}))},_validate:function(a,b){if(!b.validate||!this.validate)return!0;var a=k.extend({},this.attributes,a),c=this.validationError=
this.validate(a,b)||null;if(!c)return!0;this.trigger("invalid",this,c,k.extend(b||{},{validationError:c}));return!1}});k.each(["keys","values","pairs","invert","pick","omit"],function(a){o.prototype[a]=function(){var b=e.call(arguments);b.unshift(this.attributes);return k[a].apply(k,b)}});var p=j.Collection=function(a,b){b||(b={});if(b.url)this.url=b.url;if(b.model)this.model=b.model;if(b.comparator!==void 0)this.comparator=b.comparator;this._reset();this.initialize.apply(this,arguments);a&&this.reset(a,
k.extend({silent:!0},b))},A={add:!0,remove:!0,merge:!0},z={add:!0,merge:!1,remove:!1};k.extend(p.prototype,l,{model:o,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return j.sync.apply(this,arguments)},add:function(a,b){return this.set(a,k.defaults(b||{},z))},remove:function(a,b){a=k.isArray(a)?a.slice():[a];b||(b={});var c,e,d,f;c=0;for(e=a.length;c<e;c++)if(f=this.get(a[c])){delete this._byId[f.id];delete this._byId[f.cid];d=this.indexOf(f);
this.models.splice(d,1);this.length--;if(!b.silent)b.index=d,f.trigger("remove",f,this,b);this._removeReference(f)}return this},set:function(a,b){b=k.defaults(b||{},A);b.parse&&(a=this.parse(a,b));k.isArray(a)||(a=a?[a]:[]);var c,e,g,h,j,l=b.at,p=this.comparator&&l==null&&b.sort!==!1,n=k.isString(this.comparator)?this.comparator:null,q=[],o=[],r={};c=0;for(e=a.length;c<e;c++)if(g=this._prepareModel(a[c],b))(h=this.get(g))?(b.remove&&(r[h.cid]=!0),b.merge&&(h.set(g.attributes,b),p&&!j&&h.hasChanged(n)&&
(j=!0))):b.add&&(q.push(g),g.on("all",this._onModelEvent,this),this._byId[g.cid]=g,g.id!=null&&(this._byId[g.id]=g));if(b.remove){c=0;for(e=this.length;c<e;++c)r[(g=this.models[c]).cid]||o.push(g);o.length&&this.remove(o,b)}q.length&&(p&&(j=!0),this.length+=q.length,l!=null?f.apply(this.models,[l,0].concat(q)):d.apply(this.models,q));j&&this.sort({silent:!0});if(b.silent)return this;c=0;for(e=q.length;c<e;c++)(g=q[c]).trigger("add",g,this,b);j&&this.trigger("sort",this,b);return this},reset:function(a,
b){b||(b={});for(var c=0,e=this.models.length;c<e;c++)this._removeReference(this.models[c]);b.previousModels=this.models;this._reset();this.add(a,k.extend({silent:!0},b));b.silent||this.trigger("reset",this,b);return this},push:function(a,b){a=this._prepareModel(a,b);this.add(a,k.extend({at:this.length},b));return a},pop:function(a){var b=this.at(this.length-1);this.remove(b,a);return b},unshift:function(a,b){a=this._prepareModel(a,b);this.add(a,k.extend({at:0},b));return a},shift:function(a){var b=
this.at(0);this.remove(b,a);return b},slice:function(a,b){return this.models.slice(a,b)},get:function(a){return a==null?void 0:this._byId[a.id!=null?a.id:a.cid||a]},at:function(a){return this.models[a]},where:function(a,b){return k.isEmpty(a)?b?void 0:[]:this[b?"find":"filter"](function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){if(!this.comparator)throw Error("Cannot sort a set without a comparator");a||(a={});k.isString(this.comparator)||
this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(k.bind(this.comparator,this));a.silent||this.trigger("sort",this,a);return this},sortedIndex:function(a,b,c){b||(b=this.comparator);var e=k.isFunction(b)?b:function(a){return a.get(b)};return k.sortedIndex(this.models,a,e,c)},pluck:function(a){return k.invoke(this.models,"get",a)},fetch:function(a){a=a?k.clone(a):{};if(a.parse===void 0)a.parse=!0;var b=a.success,c=this;a.success=function(e){c[a.reset?"reset":
"set"](e,a);b&&b(c,e,a);c.trigger("sync",c,e,a)};O(this,a);return this.sync("read",this,a)},create:function(a,b){b=b?k.clone(b):{};if(!(a=this._prepareModel(a,b)))return!1;b.wait||this.add(a,b);var c=this,e=b.success;b.success=function(d){b.wait&&c.add(a,b);e&&e(a,d,b)};a.save(null,b);return a},parse:function(a){return a},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(a,b){if(a instanceof o){if(!a.collection)a.collection=
this;return a}b||(b={});b.collection=this;var c=new this.model(a,b);return!c._validate(a,b)?(this.trigger("invalid",this,a,b),!1):c},_removeReference:function(a){this===a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,e){(a==="add"||a==="remove")&&c!==this||(a==="destroy"&&this.remove(b,e),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],b.id!=null&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))}});k.each(["forEach",
"each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"],function(a){p.prototype[a]=function(){var b=e.call(arguments);b.unshift(this.models);return k[a].apply(k,b)}});k.each(["groupBy","countBy","sortBy"],function(a){p.prototype[a]=function(b,
c){var e=k.isFunction(b)?b:function(a){return a.get(b)};return k[a](this.models,e,c)}});var c=j.View=function(a){this.cid=k.uniqueId("view");this._configure(a||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()},x=/^(\S+)\s*(.*)$/,J=["model","collection","el","id","attributes","className","tagName","events"];k.extend(c.prototype,l,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();
this.stopListening();return this},setElement:function(a,b){this.$el&&this.undelegateEvents();this.$el=a instanceof j.$?a:j.$(a);this.el=this.$el[0];b!==!1&&this.delegateEvents();return this},delegateEvents:function(a){if(!a&&!(a=k.result(this,"events")))return this;this.undelegateEvents();for(var b in a){var c=a[b];k.isFunction(c)||(c=this[a[b]]);if(c){var e=b.match(x),d=e[1],e=e[2],c=k.bind(c,this);d+=".delegateEvents"+this.cid;if(e==="")this.$el.on(d,c);else this.$el.on(d,e,c)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+
this.cid);return this},_configure:function(a){this.options&&(a=k.extend({},k.result(this,"options"),a));k.extend(this,k.pick(a,J));this.options=a},_ensureElement:function(){if(this.el)this.setElement(k.result(this,"el"),!1);else{var a=k.extend({},k.result(this,"attributes"));if(this.id)a.id=k.result(this,"id");this.className&&(a["class"]=k.result(this,"className"));this.setElement(j.$("<"+k.result(this,"tagName")+">").attr(a),!1)}}});j.sync=function(a,b,c){var e=N[a];k.defaults(c||(c={}),{emulateHTTP:j.emulateHTTP,
emulateJSON:j.emulateJSON});var d={type:e,dataType:"json"};if(!c.url)d.url=k.result(b,"url")||h();if(c.data==null&&b&&(a==="create"||a==="update"||a==="patch"))d.contentType="application/json",d.data=JSON.stringify(c.attrs||b.toJSON(c));if(c.emulateJSON)d.contentType="application/x-www-form-urlencoded",d.data=d.data?{model:d.data}:{};if(c.emulateHTTP&&(e==="PUT"||e==="DELETE"||e==="PATCH")){d.type="POST";if(c.emulateJSON)d.data._method=e;var f=c.beforeSend;c.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",
e);if(f)return f.apply(this,arguments)}}if(d.type!=="GET"&&!c.emulateJSON)d.processData=!1;if(d.type==="PATCH"&&window.ActiveXObject&&(!window.external||!window.external.msActiveXFilteringEnabled))d.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")};a=c.xhr=j.ajax(k.extend(d,c));b.trigger("request",b,a,c);return a};var N={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};j.ajax=function(){return j.$.ajax.apply(j.$,arguments)};var F=j.Router=function(a){a||(a={});if(a.routes)this.routes=
a.routes;this._bindRoutes();this.initialize.apply(this,arguments)},n=/\((.*?)\)/g,D=/(\(\?)?:\w+/g,P=/\*\w+/g,K=/[\-{}\[\]+?.,\\\^$|#\s]/g;k.extend(F.prototype,l,{initialize:function(){},route:function(a,b,c){k.isRegExp(a)||(a=this._routeToRegExp(a));k.isFunction(b)&&(c=b,b="");c||(c=this[b]);var e=this;j.history.route(a,function(d){d=e._extractParameters(a,d);c&&c.apply(e,d);e.trigger.apply(e,["route:"+b].concat(d));e.trigger("route",b,d);j.history.trigger("route",e,b,d)});return this},navigate:function(a,
b){j.history.navigate(a,b);return this},_bindRoutes:function(){if(this.routes){this.routes=k.result(this,"routes");for(var a,b=k.keys(this.routes);(a=b.pop())!=null;)this.route(a,this.routes[a])}},_routeToRegExp:function(a){a=a.replace(K,"\\$&").replace(n,"(?:$1)?").replace(D,function(a,b){return b?a:"([^/]+)"}).replace(P,"(.*?)");return RegExp("^"+a+"$")},_extractParameters:function(a,b){var c=a.exec(b).slice(1);return k.map(c,function(a){return a?decodeURIComponent(a):null})}});var I=j.History=
function(){this.handlers=[];k.bindAll(this,"checkUrl");if(typeof window!=="undefined")this.location=window.location,this.history=window.history},M=/^[#\/]|\s+$/g,s=/^\/+|\/+$/g,U=/msie [\w.]+/,L=/\/$/;I.started=!1;k.extend(I.prototype,l,{interval:50,getHash:function(a){return(a=(a||this).location.href.match(/#(.*)$/))?a[1]:""},getFragment:function(a,b){if(a==null)if(this._hasPushState||!this._wantsHashChange||b){var a=this.location.pathname,c=this.root.replace(L,"");a.indexOf(c)||(a=a.substr(c.length))}else a=
this.getHash();return a.replace(M,"")},start:function(a){if(I.started)throw Error("Backbone.history has already been started");I.started=!0;this.options=k.extend({},{root:"/"},this.options,a);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==!1;this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!this.history||!this.history.pushState);var a=this.getFragment(),b=document.documentMode,b=U.exec(navigator.userAgent.toLowerCase())&&(!b||
b<=7);this.root=("/"+this.root+"/").replace(s,"/");if(b&&this._wantsHashChange)this.iframe=j.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(a);if(this._hasPushState)j.$(window).on("popstate",this.checkUrl);else if(this._wantsHashChange&&"onhashchange"in window&&!b)j.$(window).on("hashchange",this.checkUrl);else if(this._wantsHashChange)this._checkUrlInterval=setInterval(this.checkUrl,this.interval);this.fragment=a;a=this.location;b=a.pathname.replace(/[^\/]$/,
"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!b)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;else if(this._wantsPushState&&this._hasPushState&&b&&a.hash)this.fragment=this.getHash().replace(M,""),this.history.replaceState({},document.title,this.root+this.fragment+a.search);if(!this.options.silent)return this.loadUrl()},stop:function(){j.$(window).off("popstate",this.checkUrl).off("hashchange",
this.checkUrl);clearInterval(this._checkUrlInterval);I.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();a===this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe)));if(a===this.fragment)return!1;this.iframe&&this.navigate(a);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(a){var b=this.fragment=this.getFragment(a);return k.any(this.handlers,function(a){if(a.route.test(b))return a.callback(b),
!0})},navigate:function(a,b){if(!I.started)return!1;if(!b||b===!0)b={trigger:b};a=this.getFragment(a||"");if(this.fragment!==a){this.fragment=a;var c=this.root+a;if(this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,c);else if(this._wantsHashChange)this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace));else return this.location.assign(c);
b.trigger&&this.loadUrl(a)}},_updateHash:function(a,b,c){c?(c=a.href.replace(/(javascript:|#).*$/,""),a.replace(c+"#"+b)):a.hash="#"+b}});j.history=new I;o.extend=p.extend=F.extend=c.extend=I.extend=function(a,b){var c=this,e;e=a&&k.has(a,"constructor")?a.constructor:function(){return c.apply(this,arguments)};k.extend(e,c,b);var d=function(){this.constructor=e};d.prototype=c.prototype;e.prototype=new d;a&&k.extend(e.prototype,a);e.__super__=c.prototype;return e};var h=function(){throw Error('A "url" property or function must be specified');
},O=function(a,b){var c=b.error;b.error=function(e){c&&c(a,e,b);a.trigger("error",a,e,b)}}}).call(this);
(function(b){function a(a,b){if(!this.$parent_stack)this.$parent_stack={};var c=this.$parent_stack[a];this.$parent_stack[a]=c?c.constructor?c.constructor.__super__:null:this.constructor.__super__;var d=this.$parent_stack[a][a].apply(this,b||[]);this.$parent_stack[a]=c;return d}var c={},d=Backbone.View.extend({mixins:null,do_render:!0,_namespace:"",initialize:function(){this.mixins&&this._applyMixins();this._namespace&&this._attachNamespace();!this.$generated&&this.do_render&&this.render();this.init&&
this.init();this.$attached||this.addListeners()},$parent:a,render:function(){this.$generated=!0},addListeners:function(){this.$attached=!0;if(this.Eggshell)this.Eggshell.on("destroy",this.destroy.bind(this));return this},_applyMixins:function(){var a,b;for(a=0;b=this.mixins[a];a++)c[b]?c[b].call(this):b.call?b.call(this):console.warn("Trying to apply undefined mixin: "+b)},_attachNamespace:function(){function a(){}function c(d){if(!l[d]){var f=b.camelCase(d.replace(/ /g,"-")),f=r[f]?r[f].bind(r):
a;q.on(d,f);l[d]=!0}}function d(a){var b,e;if(a instanceof Array)for(e=0;b=a[e];e++)c(b);else for(b in a)c(b)}var k=Eggshell.getDefinition(this._namespace),l={},q=this.Eggshell,r=this;k&&k.config.inputs&&d(k.config.inputs)},destroy:function(){}});d.registerMixin=function(a,b){c[a]=b};C.define=function(a,b,c){c._namespace=a;Eggshell.define(a,b,d.extend(c));return a};d.$parent=a;d.mixins=c;C.CheggView=d})(window.Zepto||window.jQuery);
(function(){C.CheggView.registerMixin("Attacher",function(){function b(){var b,d;for(b=0;d=a[b];b++)d.fn?d.target.off(d.name,d.ns,d.fn):d.target.off(d.name,d.ns);a=null}var a=[];this.attach=function(b,d,e,f){b.on||(b=$(b));if(f)b.on(d,e,f);else b.on(d,e);a.push({target:b,name:d,ns:e,fn:f});return this};if(this.Eggshell)this.Eggshell.on("destroy",b);this.dettach=b})})(window.Zepto||window.jQuery);(function(){C.CheggView.registerMixin("$parent",function(){this.$parent=C.CheggView.$parent})})();
C.CheggView.registerMixin("Options",function(){this.setOptions=function(b){function a(b,d){for(var e in b)d.hasOwnProperty(e)&&b.hasOwnProperty(e)&&(typeof d[e]=="object"?a(b[e],d[e]):b[e]=d[e])}a(this.options,b);return this}});
C.CheggView.registerMixin("Generator",function(){var b=this["generator:elements"],a=_.result(this,"generator:getData"),c=this["generator:template"],a=typeof c=="function"?c.call(this,a):c,d;if(a)this.element=$(a);if(b&&this.element)for(d in this.elements={},b)this.elements[d]=$(b[d],this.element);if(this.Eggshell)this.Eggshell.on("destroy",function f(){this.Eggshell.off("destroy",f);this.element&&this.element.remove();this.elements={}}.bind(this))});
C.CheggView.registerMixin("Bind",function(){var b,a;this.bound=function(a){if(!this.bound[a])try{this.bound[a]=this[a].bind(this)}catch(b){utils.warn("Trying to bind undefined method "+a);return}return this.bound[a]};if(this.bind)for(b=0;a=this.bind[b];b++)this.bound(a)});
Eggshell.define("C.report.GA",{inputs:["report custom event","report","register"],outputs:["custom report sent"],singleton:!0,immueToDestroyAll:!0},function(b){var a=b?b:[],c=Eggshell.find(this),d=!1,e=[],f=setInterval($.proxy(function(){if(typeof _gaq=="undefined")d=!1;else{d=!0;clearInterval(f);for(var a=e.length,b=0;b<a;b++)j(null,e.shift())}},this),1E3),j=function(a,b){if(!d)return e.push(b),"";_gaq.push(["_trackEvent",b.page,b.section,b.link]);var f=$.proxy(function(){this.trigger("custom report sent")},
c);_gaq.push(f)},b=function(b){if(b.action!=="register"){var c=b.channel,b=b.action,f=null;if(a&&a[c]&&a[c][b]){f=a[c][b];if(!d)return e.push(f),"";_gaq.push(["_trackEvent",f.page,f.section,f.link])}else if((c=Eggshell.find(c))&&c.getClass())if(c=c.getClass(),a&&a[c]&&a[c][b]){f=a[c][b];if(!d)return e.push(f),"";_gaq.push(["_trackEvent",f.page,f.section,f.link])}}};Eggshell.on("*","*",b,this);Eggshell.find(this).on("report",b).on("report custom event",j).on("register",function(b,c){if(c)for(var e in c){var d=
c[e],f;for(f in d){var j=d[f];a[e]||(a[e]={});a[e][f]=j}}});return{}});
Eggshell.module("Factory",["Logger","DefinitionRegistry","Api"],function(b,a){Eggshell.loader.setFactory({escapeCss:function(a){return a=a.replace(/[!\"#$%&'\(\)\*\+,\.\/:;<=>\?\@\[\\\]\^`\{\|\}~]/g,"-")},instantiate:function(b,d,e,f){typeof f!="object"&&(f={});var j=a.get(d);if(f.createSafeDomContainer!==!1&&f.newNode!==!1&&(j===null||j&&j.config===null||j&&j.config&&j.config.newNode!==!1)){if(!f.el)f.el=$("body");if(!f.el.jquery)f.el=$(f.el);if(f.el.jquery)f.el=$.extend({},f.el);if(f.el.attr("id")!=
this.escapeCss(b))f.el=$("<div/>").appendTo(f.el);f.el.attr("id",this.escapeCss(b));f.el.addClass(this.escapeCss(d));f.className&&f.el.addClass(f.className)}else if(f.el){if(!f.el.jquery)f.el=$(f.el);f.el.attr("id",this.escapeCss(b));f.el.addClass(this.escapeCss(d));f.className&&f.el.addClass(f.className)}if((b=new e(f))&&b.Eggshell)b.Eggshell.listen("show",function(){this.$el&&this.$el.show()}),b.Eggshell.listen("hide",function(){this.$el&&this.$el.hide()}),b.Eggshell.on("track impression",function(){this.component.activityTracking=
{};this.component.activityTracking.$el=this.el;this.component.activityTracking.isSeen=!1;this.component.activityTracking.scrollDetector=Eggshell.create("C.Eggshell.window.scroll.tracker");this.component.activityTracking.scrollDetected=$.proxy(function(){this.el.height()>0&&this.el.offset().top+Math.floor(this.el.height()/2)>=window.pageYOffset&&this.el.offset().top+Math.floor(this.el.height()/2)<window.pageYOffset+$(window).height()&&(this.component.activityTracking.scrollDetector.off("scrolled",
this.component.activityTracking.scrollDetected,this),Eggshell.find(this.component).trigger("impression fired"))},this);this.component.activityTracking.scrollDetector.on("scrolled",this.component.activityTracking.scrollDetected,this);setTimeout(this.component.activityTracking.scrollDetected,1)},{component:b,el:f.el});return b},destroy:function(a,b){b.unbind&&b.unbind();b.model&&b.model.unbind&&(b.model.unbind(),delete this.model);b.collection&&b.collection.unbind&&(b.collection.unbind(),delete this.collection);
b.remove&&b.remove();this.$el&&delete this.$el;this.el&&delete this.el;$("#"+this.escapeCss(a)).remove()}})});
(function(b){Eggshell.define("C.eggshell.component.ajax.client",{inputs:["push","flush all"],outputs:[],singleton:!0},function(){var a=this,c={},d={},e=function(a){for(var b=0;b<c[a].length;b++)delete c[a][b];c[a]=[]},f=function(a){if(!a)throw"Empty payload.";if(typeof a.url!="string"||!a.url)throw"Invalid URL.";},j=function(a){var b="";if(a.type)b=a.type;b+=a.url;b[b.length-1]!="?"&&(b+="?");if(a.data)for(var c in a.data)b+=c+"="+encodeURIComponent(a.data[c])+"&";return b},k=function(a,b,c){return{request:a,
response:b,arguments:c}},l=function(b,e,d,f){for(var j=0;j<c[b].length;j++){var l=k(c[b][j],d,f);a.Eggshell.trigger(e,l)}};a.Eggshell.listen("ajax",function(q,r){f(r);if(typeof r.cache=="undefined")r.cache=!0;var g=j(r);c[g]||(c[g]=[]);c[g].push(r);if(!(r.cache&&c[g].length>1))if(r.cache&&d[g])l.call(a,g,"success",d[g].response,[d[g].response]),l.call(a,g,"ready",d[g].response,[d[g].response]),e(g);else{var o=function(){},o=b.extend({},r,{done:o,success:o,fail:o,error:o,always:o,complete:o}),o=b.ajax(b.extend({},
o,{context:this}));o.done(function(){l.call(a,g,"success",arguments[0],arguments);l.call(a,g,"ready",arguments[0],arguments);e(g);r.cache&&(d[g]=k(r,arguments[0],arguments))});o.fail(function(b,c,d){l.call(a,g,"error",null,arguments);l.call(a,g,"ready",null,arguments);e(g)})}});a.Eggshell.listen("push",function(a,b){if(!b)throw"Invalid payload";if(!b.settings)throw"Invalid ajax settings";if(!b.response)throw"Invalid ajax response";var c=b.settings,e=b.response;f(c);var l=j(c);d[l]=k(c,e,null)});a.Eggshell.listen("flush all",
function(){d={}})});b.cjax=function(){var a=Eggshell.create("C.eggshell.component.ajax.client");Eggshell.immuneToDestroyAll(a);Eggshell.input(a,"success",function(a,b){var e=b.request,f=e.context;e.done?e.done.apply(f,b.arguments):e.success&&e.success.apply(f,b.arguments)});Eggshell.input(a,"error",function(a,b){var e=b.request,f=e.context;e.fail?e.fail.apply(f,b.arguments):e.error&&e.error.apply(f,b.arguments)});Eggshell.input(a,"ready",function(a,b){var e=b.request,f=e.context;e.always?e.always.apply(f,
b.arguments):e.complete&&e.complete.apply(f,b.arguments)});return function(){var b={};if(arguments.length==1)typeof arguments[0]=="string"?b.url=arguments[0]:b=arguments[0];else if(arguments.length==2)b=arguments[1],b.url=arguments[0];if(!b.context)b.context=this;Eggshell.trigger(a,"ajax",b)}}()})(window.$);Eggshell.define("C.Eggshell.window.scroll.tracker",{outputs:["scrolled"],singleton:!0},function(){$(window).scroll($.proxy(function(){this.Eggshell.trigger("scrolled")},this))});
Eggshell.define("C.common.tracking",{inputs:{"enable automatic tracking":{},"disable automatic tracking":{},"push class matcher":{payload:"string"},"set page information":{payload:{page:{name:"string",namespace:"string"}}}},singleton:!0,immueToDestroyAll:!0},Backbone.Model.extend({initialize:function(){this.reset();Eggshell.find(this).on("reset",this.reset).on("push class matcher",this.pushClassMatcher,this).on("set page information",this.setPageInfo).on("enable automatic tracking",this.enable).on("disable automatic tracking",
this.disable);Eggshell.on("*","*",this.track,this)},reset:function(){this.clear();this.set({enabled:!0,"class":[]})},pushClassMatcher:function(b,a){var c=this.get("class");c.push(a);this.set("class",c)},setPageInfo:function(b,a){this.set("page",a)},enable:function(){this.set("enabled",!0)},disable:function(){this.set("enabled",!1)},track:function(b){if(this.get("enabled")){var a=b.action;if((a.indexOf("clicked")>=0||a.indexOf("focused")>=0||a.indexOf("blurred")>=0)&&b.namespace)for(var b=Eggshell.shell(b.namespace).getConstructorNamespace(),
c=this.get("class"),d=0;d<c.length;d++)if(b.indexOf(c[d])>=0){b=b===c[d]?b.substr(b.lastIndexOf(".")+1):b.replace(c[d]+".","");b=b.replace(/\./g," ");b=b.charAt(0).toUpperCase()+b.slice(1);c=this.get("page")&&this.get("page").name?this.get("page").name:$("title").html();Eggshell.create("C.report.GA").trigger("report custom event",{page:c,section:b,link:a});break}}}}));
if(!C.resource)C.resource=function(){var b=function(a,b,c){if(!a||typeof a!=="string")throw"Invalid language";if(!b||typeof b!=="string")throw"Invalid country";c||(c="");this.toString=function(){var e=a.toLowerCase()+"-"+b.toUpperCase();c&&(e+="-"+c);return e}},a=function(){var a={};this.add=function(b,c){if(!b||typeof b!=="string")throw"Invalid key";if(!c||typeof c!=="string")throw"Invalid message";a[b]=c};this.remove=function(b){if(!b||typeof b!=="string")throw"Invalid key";delete a[b]};this.fetch=
function(b){if(!b||typeof b!=="string")throw"Invalid key";return a[b]};this.fetchAll=function(){return a}},c=!1,d=new b("en","US"),e={},f=function(){var b,k,l;if(arguments.length==1&&typeof arguments[0]==="object")for(k in arguments[0])l=arguments[0][k],f(k,l);else if(arguments.length==2&&typeof arguments[1]==="object"){b=arguments[0];if(!b)throw"Invalid locale";for(k in arguments[1])l=arguments[1][k],f(b,k,l)}else{if(arguments.length==2)b=d,k=arguments[0],l=arguments[1];else if(arguments.length==
3)b=arguments[0],k=arguments[1],l=arguments[2];else throw"Invalid arguments";if(!b)throw"Invalid locale";if(!k||typeof k!=="string")throw"Invalid key";if(!l||typeof l!=="string")throw"Invalid message";e[b.toString()]||(e[b.toString()]=new a);e[b.toString()].add(k,l);c&&console.log("message added",b.toString(),k,l)}};return{Locale:b,setDebug:function(a){c=!!a},setDefaultLocale:function(a){if(!a instanceof b)throw"Invalid locale";d=a;c&&console.log("default locale registered",a)},getDefaultLocale:function(){return d},
add:f,fetch:function(){var a,f,l=null,q=[];if(arguments.length==1)a=d,f=arguments[0];else if(arguments.length==2)arguments[0]instanceof b?(a=arguments[0],f=arguments[1]):(a=d,f=arguments[0],q=arguments[1]);else if(arguments.length==3)a=arguments[0],f=arguments[1],q=arguments[2];else throw"Invalid arguments";if(!a)throw"Invalid locale";if(!f||typeof f!=="string")throw"Invalid key";e[a.toString()]&&(l=e[a.toString()].fetch(f));q&&_.each(q,function(a,b){l=l.replace("{"+b+"}",a)},this);c&&console.log("message fetched",
a.toString(),f,l);return l},toJSON:function(){var a=d;arguments.length==1&&(a=arguments[0]);return e[a.toString()]?e[a.toString()].fetchAll():{}}}}();
(function(b){for(var b=b||{},a=["debug","info","warn","error","assert","clear","dir","dirxml","trace","group","groupCollapsed","groupEnd","time","timeEnd","profile","profileEnd","count","exception","table"],c=0;c<a.length;c++)b[a[c]]=b[a[c]]||function(){};var b=C.utility.getParams(),d;for(d in b)if(d=="profile")C("global").profile=1;C("global").profile&&console.profile("Global package profiler")})(window.console);C("support");C.support.touch="ontouchstart"in document.documentElement;
C.support.placeholder=C.utility.attrSupportedByEl("input","placeholder");
(function(){var b=document.createElement("p");try{b.style.color="rgba(1,1,1,0.5)"}catch(a){}C.support.rgba=/^rgba/.test(b.style.color);b=null;C.support.util={moved:!1,slideRight:!1,slideLeft:!1,resetTouch:function(){C.support.util.moved=!1;C.support.util.slideRight=!1;C.support.util.slideLeft=!1;C.support.util.startX=0;C.support.util.startY=0;C.support.util.diffX=0;C.support.util.diffY=0;C.support.util.changeX=0;C.support.util.changeY=0},onTouchMove:function(a){a=a.originalEvent.touches[0];C.support.util.diffX=
a.clientX-C.support.util.startX;C.support.util.diffY=a.clientY-C.support.util.startY;C.support.util.changeX=Math.abs(C.support.util.diffX);C.support.util.changeY=Math.abs(C.support.util.diffY);if(C.support.util.changeX>15||C.support.util.changeY>15)C.support.util.moved=!0;C.support.util.diffX>60&&C.support.util.changeY<50?C.support.util.slideRight=!0:C.support.util.diffX<-60&&C.support.util.changeY<50?C.support.util.slideLeft=!0:(C.support.util.slideRight=!1,C.support.util.slideLeft=!1)},onTouchStart:function(a){a=
a.originalEvent.touches[0];C.support.util.resetTouch();C.support.util.startX=a.clientX;C.support.util.startY=a.clientY}};C.support.util.resetTouch();$("body").on("touchstart",C.support.util.onTouchStart).on("touchmove",C.support.util.onTouchMove)})();
(function(){var b={},a,c,d,e,f,j;for(j in document.body.style)if(c=j.match(/^(webkit|Moz|O|ms)/),a=j,c?(e||(e=c[0]?c[0].toLowerCase():null,f=RegExp("/-"+e+"-/","g")),c=("-"+j.replace(/([A-Z])/g,function(a){return"-"+a}).toLowerCase()).replace("--","-"),d=c.replace("-"+e+"-","")):(a=j,d=c=j.replace(/([A-Z])/g,function(a){return"-"+a}).toLowerCase()),!b[d]&&!(d in document.body.style&&(a!=d||c!=d)))b[d]={css:c,js:a};$.fn._css=$.fn.css;$.fn.css=function(){if(arguments.length&&Object.prototype.toString.call(arguments[0])==
"[object Object]")for(var a in arguments[0])Object.prototype.toString.call(arguments[0][a])=="[object String]"&&(arguments[0][a]=arguments[0][a].replace(f,"")),b[a]&&b[a].js!=a&&(arguments[0][b[a].js]=arguments[0][a],delete arguments[0][a]);return this._css.apply(this,arguments)}})();C("dom");C.dom.$window=$(window);C.dom.$html=$(document.documentElement);C.dom.$header=$(".chg-header");C.dom.$headerRoot=$(".chg-hdr-root");C.dom.$content=$(".chg-content");C.dom.$nav=$(".chg-nav");C.dom.$body=$(document.body);
C.dom.$root=$(".chg-root");C.dom.$container=$(".chg-container");C.dom.$navToggle=$(".icn-menu-toggle");(function(b,a){var c=b.History=b.History||{},d=b.jQuery;if(typeof c.Adapter!=="undefined")throw Error("History.js Adapter has already been loaded...");c.Adapter={bind:function(a,b,c){d(a).bind(b,c)},trigger:function(a,b,c){d(a).trigger(b,c)},extractEventData:function(b,c,d){return c&&c.originalEvent&&c.originalEvent[b]||d&&d[b]||a},onDomLoad:function(a){d(a)}};typeof c.init!=="undefined"&&c.init()})(window);
(function(b,a){var c=b.console||a,d=b.document,e=b.navigator,f=b.setTimeout,j=b.clearTimeout,k=b.setInterval,l=b.clearInterval,q=b.JSON,r=b.alert,g=b.History=b.History||{},o=b.history;q.stringify=q.stringify||q.encode;q.parse=q.parse||q.decode;if(typeof g.init!=="undefined")throw Error("History.js Core has already been loaded...");g.init=function(){if(typeof g.Adapter==="undefined")return!1;typeof g.initCore!=="undefined"&&g.initCore();typeof g.initHtml4!=="undefined"&&g.initHtml4();return!0};g.initCore=
function(){if(typeof g.initCore.initialized!=="undefined")return!1;else g.initCore.initialized=!0;g.options=g.options||{};g.options.hashChangeInterval=g.options.hashChangeInterval||100;g.options.safariPollInterval=g.options.safariPollInterval||500;g.options.doubleCheckInterval=g.options.doubleCheckInterval||500;g.options.storeInterval=g.options.storeInterval||1E3;g.options.busyDelay=g.options.busyDelay||250;g.options.debug=g.options.debug||!1;g.options.initialTitle=g.options.initialTitle||d.title;
g.intervalList=[];g.clearAllIntervals=function(){var a,b=g.intervalList;if(typeof b!=="undefined"&&b!==null){for(a=0;a<b.length;a++)l(b[a]);g.intervalList=null}};g.debug=function(){g.options.debug&&g.log.apply(g,arguments)};g.log=function(){var a=!(typeof c==="undefined"||typeof c.log==="undefined"||typeof c.log.apply==="undefined"),b=d.getElementById("log"),e,f,g,j;a?(f=Array.prototype.slice.call(arguments),e=f.shift(),typeof c.debug!=="undefined"?c.debug.apply(c,[e,f]):c.log.apply(c,[e,f])):e="\n"+
arguments[0]+"\n";f=1;for(g=arguments.length;f<g;++f){j=arguments[f];if(typeof j==="object"&&typeof q!=="undefined")try{j=q.stringify(j)}catch(k){}e+="\n"+j+"\n"}b?(b.value+=e+"\n-----\n",b.scrollTop=b.scrollHeight-b.clientHeight):a||r(e);return!0};g.getInternetExplorerMajorVersion=function(){return g.getInternetExplorerMajorVersion.cached=typeof g.getInternetExplorerMajorVersion.cached!=="undefined"?g.getInternetExplorerMajorVersion.cached:function(){for(var a=3,b=d.createElement("div"),c=b.getElementsByTagName("i");(b.innerHTML=
"<\!--[if gt IE "+ ++a+"]><i></i><![endif]--\>")&&c[0];);return a>4?a:!1}()};g.isInternetExplorer=function(){return g.isInternetExplorer.cached=typeof g.isInternetExplorer.cached!=="undefined"?g.isInternetExplorer.cached:Boolean(g.getInternetExplorerMajorVersion())};g.emulated={pushState:!Boolean(b.history&&b.history.pushState&&b.history.replaceState&&!(/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(e.userAgent)||/AppleWebKit\/5([0-2]|3[0-2])/i.test(e.userAgent))),hashChange:Boolean(!("onhashchange"in
b||"onhashchange"in d)||g.isInternetExplorer()&&g.getInternetExplorerMajorVersion()<8)};g.enabled=!g.emulated.pushState;g.bugs={setHash:Boolean(!g.emulated.pushState&&e.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),safariPoll:Boolean(!g.emulated.pushState&&e.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),ieDoubleCheck:Boolean(g.isInternetExplorer()&&g.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(g.isInternetExplorer()&&
g.getInternetExplorerMajorVersion()<7)};g.isEmptyObject=function(a){for(var b in a)return!1;return!0};g.cloneObject=function(a){a?(a=q.stringify(a),a=q.parse(a)):a={};return a};g.getRootUrl=function(){var a=d.location.protocol+"//"+(d.location.hostname||d.location.host);d.location.port&&(a+=":"+d.location.port);a+="/";return a};g.getBaseHref=function(){var a=d.getElementsByTagName("base"),b=null,b="";a.length===1&&(b=a[0],b=b.href.replace(/[^\/]+$/,""));(b=b.replace(/\/+$/,""))&&(b+="/");return b};
g.getBaseUrl=function(){return g.getBaseHref()||g.getBasePageUrl()||g.getRootUrl()};g.getPageUrl=function(){return((g.getState(!1,!1)||{}).url||d.location.href.replace(/#.*/,"")).replace(/\/+$/,"").replace(/[^\/]+$/,function(a){return/\./.test(a)?a:a+"/"})};g.getBasePageUrl=function(){return d.location.href.replace(/[#\?].*/,"").replace(/[^\/]+$/,function(a){return/[^\/]$/.test(a)?"":a}).replace(/\/+$/,"")+"/"};g.getFullUrl=function(a,b){var c=a,e=a.substring(0,1),b=typeof b==="undefined"?!0:b;/[a-z]+\:\/\//.test(a)||
(c=e==="/"?g.getRootUrl()+a.replace(/^\/+/,""):e==="#"?g.getPageUrl().replace(/#.*/,"")+a:e==="?"?g.getPageUrl().replace(/[\?#].*/,"")+a:b?g.getBaseUrl()+a.replace(/^(\.\/)+/,""):g.getBasePageUrl()+a.replace(/^(\.\/)+/,""));return c.replace(/\#$/,"")};g.getShortUrl=function(a){var b=g.getBaseUrl(),c=g.getRootUrl();g.emulated.pushState&&(a=a.replace(b,""));a=a.replace(c,"/");g.isTraditionalAnchor(a)&&(a="./"+a);return a=a.replace(/^(\.\/)+/g,"./").replace(/\#$/,"")};g.store={};g.idToState=g.idToState||
{};g.stateToId=g.stateToId||{};g.urlToId=g.urlToId||{};g.storedStates=g.storedStates||[];g.savedStates=g.savedStates||[];g.normalizeStore=function(){g.store.idToState=g.store.idToState||{};g.store.urlToId=g.store.urlToId||{};g.store.stateToId=g.store.stateToId||{}};g.getState=function(a,b){typeof a==="undefined"&&(a=!0);typeof b==="undefined"&&(b=!0);var c=g.getLastSavedState();!c&&b&&(c=g.createStateObject());if(a)c=g.cloneObject(c),c.url=c.cleanUrl||c.url;return c};g.getIdByState=function(a){var b=
g.extractId(a.url),c;if(!b)if(c=g.getStateString(a),typeof g.stateToId[c]!=="undefined")b=g.stateToId[c];else if(typeof g.store.stateToId[c]!=="undefined")b=g.store.stateToId[c];else{for(;;)if(b=(new Date).getTime()+String(Math.random()).replace(/\D/g,""),typeof g.idToState[b]==="undefined"&&typeof g.store.idToState[b]==="undefined")break;g.stateToId[c]=b;g.idToState[b]=a}return b};g.normalizeState=function(a){var b;if(!a||typeof a!=="object")a={};if(typeof a.normalized!=="undefined")return a;if(!a.data||
typeof a.data!=="object")a.data={};b={normalized:!0};b.title=a.title||"";b.url=g.getFullUrl(g.unescapeString(a.url||d.location.href.replace(/#.*/,"")));b.hash=g.getShortUrl(b.url);b.data=g.cloneObject(a.data);b.id=g.getIdByState(b);b.cleanUrl=b.url.replace(/\??\&_suid.*/,"");b.url=b.cleanUrl;a=!g.isEmptyObject(b.data);if(b.title||a)b.hash=g.getShortUrl(b.url).replace(/\??\&_suid.*/,""),/\?/.test(b.hash)||(b.hash+="?"),b.hash+="&_suid="+b.id;b.hashedUrl=g.getFullUrl(b.hash);if((g.emulated.pushState||
g.bugs.safariPoll)&&g.hasUrlDuplicate(b))b.url=b.hashedUrl;return b};g.createStateObject=function(a,b,c){a={data:a,title:b,url:c};return a=g.normalizeState(a)};g.getStateById=function(b){b=String(b);return g.idToState[b]||g.store.idToState[b]||a};g.getStateString=function(a){a={data:g.normalizeState(a).data,title:a.title,url:a.url};return q.stringify(a)};g.getStateId=function(a){return g.normalizeState(a).id};g.getHashByState=function(a){return g.normalizeState(a).hash};g.extractId=function(a){return((a=
/(.*)\&_suid=([0-9]+)$/.exec(a))?String(a[2]||""):"")||!1};g.isTraditionalAnchor=function(a){return!/[\/\?\.]/.test(a)};g.extractState=function(a,b){var c=null,e,d,b=b||!1;(e=g.extractId(a))&&(c=g.getStateById(e));c||(d=g.getFullUrl(a),(e=g.getIdByUrl(d)||!1)&&(c=g.getStateById(e)),!c&&b&&!g.isTraditionalAnchor(a)&&(c=g.createStateObject(null,null,d)));return c};g.getIdByUrl=function(b){return g.urlToId[b]||g.store.urlToId[b]||a};g.getLastSavedState=function(){return g.savedStates[g.savedStates.length-
1]||a};g.getLastStoredState=function(){return g.storedStates[g.storedStates.length-1]||a};g.hasUrlDuplicate=function(a){var b=!1;return b=(b=g.extractState(a.url))&&b.id!==a.id};g.storeState=function(a){g.urlToId[a.url]=a.id;g.storedStates.push(g.cloneObject(a));return a};g.isLastSavedState=function(a){var b=!1;if(g.savedStates.length)a=a.id,b=g.getLastSavedState(),b=b.id,b=a===b;return b};g.saveState=function(a){if(g.isLastSavedState(a))return!1;g.savedStates.push(g.cloneObject(a));return!0};g.getStateByIndex=
function(a){var b=null;return b=typeof a==="undefined"?g.savedStates[g.savedStates.length-1]:a<0?g.savedStates[g.savedStates.length+a]:g.savedStates[a]};g.getHash=function(){return g.unescapeHash(d.location.hash)};g.unescapeString=function(a){return a};g.unescapeHash=function(a){a=g.normalizeHash(a);return a=g.unescapeString(a)};g.normalizeHash=function(a){return a.replace(/[^#]*#/,"").replace(/#.*/,"")};g.setHash=function(a,b){var c,e;if(b!==!1&&g.busy())return g.pushQueue({scope:g,callback:g.setHash,
args:arguments,queue:b}),!1;c=g.escapeHash(a);g.busy(!0);if((e=g.extractState(a,!0))&&!g.emulated.pushState)g.pushState(e.data,e.title,e.url,!1);else if(d.location.hash!==c)g.bugs.setHash?(e=g.getPageUrl(),g.pushState(null,null,e+"#"+c,!1)):d.location.hash=c;return g};g.escapeHash=function(a){a=g.normalizeHash(a);a=b.escape(a);g.bugs.hashEscape||(a=a.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?"));return a};g.getHashByUrl=function(a){a=String(a).replace(/([^#]*)#?([^#]*)#?(.*)/,
"$2");return a=g.unescapeHash(a)};g.setTitle=function(a){var b=a.title,c;b||(c=g.getStateByIndex(0))&&c.url===a.url&&(b=c.title||g.options.initialTitle);try{d.getElementsByTagName("title")[0].innerHTML=b.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(e){}d.title=b;return g};g.queues=[];g.busy=function(a){if(typeof a!=="undefined")g.busy.flag=a;else if(typeof g.busy.flag==="undefined")g.busy.flag=!1;if(!g.busy.flag){j(g.busy.timeout);var b=function(){var a,c;if(!g.busy.flag)for(a=
g.queues.length-1;a>=0;--a)if(c=g.queues[a],c.length!==0)c=c.shift(),g.fireQueueItem(c),g.busy.timeout=f(b,g.options.busyDelay)};g.busy.timeout=f(b,g.options.busyDelay)}return g.busy.flag};g.busy.flag=!1;g.fireQueueItem=function(a){return a.callback.apply(a.scope||g,a.args||[])};g.pushQueue=function(a){g.queues[a.queue||0]=g.queues[a.queue||0]||[];g.queues[a.queue||0].push(a);return g};g.queue=function(a,b){typeof a==="function"&&(a={callback:a});if(typeof b!=="undefined")a.queue=b;g.busy()?g.pushQueue(a):
g.fireQueueItem(a);return g};g.clearQueue=function(){g.busy.flag=!1;g.queues=[];return g};g.stateChanged=!1;g.doubleChecker=!1;g.doubleCheckComplete=function(){g.stateChanged=!0;g.doubleCheckClear();return g};g.doubleCheckClear=function(){if(g.doubleChecker)j(g.doubleChecker),g.doubleChecker=!1;return g};g.doubleCheck=function(a){g.stateChanged=!1;g.doubleCheckClear();if(g.bugs.ieDoubleCheck)g.doubleChecker=f(function(){g.doubleCheckClear();g.stateChanged||a();return!0},g.options.doubleCheckInterval);
return g};g.safariStatePoll=function(){var a=g.extractState(d.location.href.replace(/#.*/,""));if(!g.isLastSavedState(a))return a||g.createStateObject(),g.Adapter.trigger(b,"popstate"),g};g.back=function(a){if(a!==!1&&g.busy())return g.pushQueue({scope:g,callback:g.back,args:arguments,queue:a}),!1;g.busy(!0);g.doubleCheck(function(){g.back(!1)});o.go(-1);return!0};g.forward=function(a){if(a!==!1&&g.busy())return g.pushQueue({scope:g,callback:g.forward,args:arguments,queue:a}),!1;g.busy(!0);g.doubleCheck(function(){g.forward(!1)});
o.go(1);return!0};g.go=function(a,b){var c;if(a>0)for(c=1;c<=a;++c)g.forward(b);else if(a<0)for(c=-1;c>=a;--c)g.back(b);else throw Error("History.go: History.go requires a positive or negative integer passed.");return g};if(g.emulated.pushState){var u=function(){};g.pushState=g.pushState||u;g.replaceState=g.replaceState||u}else g.onPopState=function(a,c){var e=!1,e=!1;g.doubleCheckComplete();(e=(e=g.Adapter.extractEventData("state",a,c)||!1)?g.getStateById(e):g.expectedStateId?g.getStateById(g.expectedStateId):
g.extractState(d.location.href.replace(/#.*/,"")))||(e=g.createStateObject(null,null,d.location.href.replace(/#.*/,"")));g.expectedStateId=!1;if(g.isLastSavedState(e))return g.busy(!1),!1;g.storeState(e);g.saveState(e);g.setTitle(e);g.Adapter.trigger(b,"statechange");g.busy(!1);return!0},g.Adapter.bind(b,"popstate",g.onPopState),g.pushState=function(a,c,e,d){if(g.getHashByUrl(e)&&g.emulated.pushState)throw Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(d!==
!1&&g.busy())return g.pushQueue({scope:g,callback:g.pushState,args:arguments,queue:d}),!1;g.busy(!0);var f=g.createStateObject(a,c,e);g.isLastSavedState(f)?g.busy(!1):(g.storeState(f),g.expectedStateId=f.id,o.pushState(f.id,f.title,f.url),g.Adapter.trigger(b,"popstate"));return!0},g.replaceState=function(a,c,e,d){if(g.getHashByUrl(e)&&g.emulated.pushState)throw Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(d!==!1&&g.busy())return g.pushQueue({scope:g,
callback:g.replaceState,args:arguments,queue:d}),!1;g.busy(!0);var f=g.createStateObject(a,c,e);g.isLastSavedState(f)?g.busy(!1):(g.storeState(f),g.expectedStateId=f.id,o.replaceState(f.id,f.title,f.url),g.Adapter.trigger(b,"popstate"));return!0};g.store={};g.normalizeStore();g.Adapter.bind(b,"beforeunload",g.clearAllIntervals);g.Adapter.bind(b,"unload",g.clearAllIntervals);g.saveState(g.storeState(g.extractState(d.location.href.replace(/#.*/,""),!0)));if(!g.emulated.pushState&&(g.bugs.safariPoll&&
g.intervalList.push(k(g.safariStatePoll,g.options.safariPollInterval)),e.vendor==="Apple Computer, Inc."||(e.appCodeName||"")==="Mozilla"))if(g.Adapter.bind(b,"hashchange",function(){g.Adapter.trigger(b,"popstate")}),g.getHash())g.Adapter.onDomLoad(function(){g.Adapter.trigger(b,"hashchange")})};g.init()})(window);
window.matchMedia=window.matchMedia||function(b){var a,c=b.documentElement,d=c.firstElementChild||c.firstChild,e=b.createElement("body"),f=b.createElement("div");f.id="mq-test-1";f.style.cssText="position:absolute;top:-100em";e.style.background="none";e.appendChild(f);return function(b){f.innerHTML='&shy;<style media="'+b+'"> #mq-test-1 { width: 42px; }</style>';c.insertBefore(e,d);a=f.offsetWidth==42;c.removeChild(e);return{matches:a,media:b}}}(document);
(function(b){b.fn.placeholder=function(a){return this.each(function(){function c(a){d(b(a.target))}function d(){if(f.val()===""){if(f.attr("type")==="password")try{f.attr("type","text")}catch(a){return!1}f.val(j);f.addClass("ui-placeholder")}}function e(){f.removeClass("ui-placeholder");f.val()===j&&f.val("")}var f=b(this),j,k="placeholder"in document.createElement("input");j=a===void 0?b(this).attr("placeholder"):a;k?f.attr("placeholder",j):(d(f.blur(c).focus(e).addClass("ui-placeholder")),f.parents("form").submit(function(){f.val()===
j&&f.val("")}))})}})(jQuery);
(function(){var b=!1,a=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(c){var d=this.prototype;b=!0;var e=new this;b=!1;for(var f in c)e[f]=typeof c[f]=="function"&&typeof d[f]=="function"&&a.test(c[f])?function(a,b){return function(){var c=this._super;this._super=d[a];var e=b.apply(this,arguments);this._super=c;return e}}(f,c[f]):c[f];f=function(){!b&&this.init&&this.init.apply(this,arguments)};f.prototype=e;f.prototype.constructor=f;f.extend=arguments.callee;
return f}})();C("widget");
C.widget.__base={init:function(){this.instanceNumber=++C.global.instanceCounter;C("widget."+this.instanceNumber);C.widget[this.instanceNumber]._widget=[];this.eventNamespace="widget"+this.instanceNumber;this.construct.apply(this,arguments)},destroy:function(){this.destruct();if(this.eventNamespace){var b="."+this.eventNamespace;$(window).off(b);$("*").off(b)}for(b=0;b<C.widget[this.instanceNumber]._widget.length;b++)C.widget[this.instanceNumber]._widget[b].destroy?C.widget[this.instanceNumber]._widget[b].destroy():C.log("Widget "+
b+" does not have a destroy method");for(;C.widget[this.instanceNumber]._widget.length;)C.widget[this.instanceNumber]._widget.pop()},addWidget:function(b){C.widget[this.instanceNumber]._widget.push(b);return b},construct:function(){C.log("Missing widget construct(opts) function!")},destruct:function(){C.log("Missing widget destruct() function!")}};C.widget._base=Class.extend(C.widget.__base);C("widget.backbone");C.widget.backbone.view=Backbone.View.extend(_.extend(C.widget.__base,{initialize:function(b){this.init(b)}}));
C("page");
C.page._base=Class.extend({init:function(){this.arguments=arguments;C.page._widget=C.page._widget||[];this.instanceNumber=++C.global.pageCounter;this.eventNamespace="page"+this.instanceNumber;this.construct.apply(this,arguments)},getData:function(){return this.arguments},destroy:function(){this.destruct();if(this.eventNamespace){var b="."+this.eventNamespace;$(window).off(b);$("*").off(b)}for(b=0;b<C.page._widget.length;b++)C.page._widget[b].destroy?C.page._widget[b].destroy():C.log("Widget "+C.page._widget[b].toString()+
" does not have a destroy method");for(;C.page._widget.length;)C.page._widget.pop()},addWidget:function(b){C.page._widget.push(b);return b},construct:function(){C.log("Missing page construct(opts) function!")},destruct:function(){C.log("Missing page destruct() function!")}});C.Events=_.extend({},Backbone.Events);C.Collection=Backbone.Collection.extend({objName:"C.Collection",destroy:function(){for(this.log("destroy");this.length>0;)this.at(0).destroy(),this.remove(this.at(0));this.trigger("destroy")}});
C.Model=Backbone.Model.extend({objName:"C.Model",destroy:function(){this.trigger("destroy")}});C.View=Backbone.View.extend({objName:"C.View"});C.Collection.prototype.log=C.Model.prototype.log=C.View.prototype.log=function(){var b=Array.prototype.slice.call(arguments);b.unshift(this.objName);C.log.apply(this,b)};jQuery.extend(jQuery,{escapeSelector:function(){var b=RegExp("(#|&|~|=|>|'|:|\"|!|;|,|\\.|\\*|\\+|\\||\\[|\\]|\\(|\\)|\\/|\\^|\\$)","g");return function(a){return a.replace(b,"\\$1")}}()});
$.fn.serializeObject=function(){var b={},a=this.serializeArray();$.each(a,function(){b[this.name]?(b[this.name].push||(b[this.name]=[b[this.name]]),b[this.name].push(this.value||"")):b[this.name]=this.value||""});return b};
$.safeAjax=function(b){function a(a){return String(a).replace(/[&<>"'\/]/g,function(a){return d[a]})}function c(b){if(typeof b==="string")return a(b);else if(typeof b==="object")for(var e in b)b[e]=c(b[e]);return b}var d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},e=b.success;b.success=function(a,b,d){a=c(a);e&&e(a,b,d)};return $.ajax(b)};
$.fn.observe=function(){var b=arguments,a,c,d,e=b[0],f,j=this,k=function(a,b){for(var a=a.split(/\s+/),c=[],e=0;e<a.length;e++)c.push(a[e]+b);return c.join(" ")};if(b.length==2){a=b[1];f=typeof a.eventNamespace=="string"?"."+a.eventNamespace:"";for(var l in e)(function(b){j.on(k(b,f),function(c){return e[b].call(a,c)})})(l)}else if(b.length==3)if(typeof e=="object")for(l in d=b[1],a=b[2],f=typeof a.eventNamespace=="string"?"."+a.eventNamespace:"",e)(function(b){j.on(k(b,f),d,function(c){return e[b].call(a,
c)})})(l);else c=b[1],a=b[2],f=typeof a.eventNamespace=="string"?"."+a.eventNamespace:"",this.on(k(e,f),function(b){return c.call(a,b)});else b.length==4&&(d=b[1],c=b[2],a=b[3],f=typeof a.eventNamespace=="string"?"."+a.eventNamespace:"",this.on(k(e,f),d,function(b){return c.call(a,b)}));return this};
$.fn.unobserve=function(){var b=arguments,a,c=b[0],d=function(a,b){for(var a=a.split(/\s+/),c=[],e=0;e<a.length;e++)c.push(a[e]+b);return c.join(" ")};if(b.length==2)if(b=b[1],b=typeof b.eventNamespace=="string"?"."+b.eventNamespace:"",typeof c=="object")for(var e in c)this.off(d(e,b));else this.off(d(c,b));else if(b.length==3)if(a=b[1],b=b[2],b=typeof b.eventNamespace=="string"?"."+b.eventNamespace:"",typeof c=="object")for(e in c)this.off(d(e,b),a);else this.off(d(c,b),a);return this};
(function(b){C("widget");C.widget.spinner=C.widget._base.extend({construct:function(a){this.options=b.extend({spokes:16,animTime:75,color:"#666666",type:"round"},a);this.$set=this.options.canvas.jquery?this.options.canvas:b(this.options.canvas);this.canvases=this.getAndValidateCanvases(this.$set);if(this.canvases.length)this.rotation=Math.PI*2/this.options.spokes,this.rgbColor=this.getRGBColor(this.options.color),this.contexts=this.setupContexts(this.canvases),this.draw()},draw:function(){var a=this;
this.translateContexts(this.contexts);this.drawIntervalID=setInterval(function(){a.paintFrame()},this.options.animTime)},clearFrame:function(a){a.ctx.clearRect(a.negHalf,a.negHalf,a.size,a.size)},paintFrame:function(){for(var a=0;a<this.contexts.length;a++){var b=this.contexts[a];if(this.isPresent(b.ctx.canvas)){this.clearFrame(b);b.ctx.rotate(this.rotation);for(var d=0;d<this.options.spokes;d++)b.ctx.rotate(this.rotation),b.ctx.strokeStyle=this.rgbColor+d/this.options.spokes+")",b.ctx.beginPath(),
b.ctx.moveTo(0,b.startPos),b.ctx.lineTo(0,b.endPos),b.ctx.stroke()}else this.contexts.splice(a,1),a--}if(!this.contexts.length)for(b in clearInterval(this.drawIntervalID),this.contexts)this.contexts.hasOwnProperty(b)&&(b=this.contexts[b],this.clearFrame(b),this.translateContext(b,!0))},isPresent:function(a){return!!b(a).closest("body").length},getAndValidateCanvases:function(a){var b=[];a.each(function(a,e){e.nodeName==="CANVAS"&&b.push(e)});return b},setupContexts:function(a){var c=[],d;for(d in a)if(a.hasOwnProperty(d)){d=
a[d];var e=b(d);if(e.is(":visible")){var e=e.height(),f=0.5*e,j=-1*f,k=Math.floor(1/3*e),l=e*(e<30?0.08:0.0625),q=Math.floor(0.5*e)-l,r=d.getContext("2d");r.lineWidth=l;r.lineCap=this.options.type;c.push({ctx:r,size:e,halfSize:f,negHalf:j,startPos:k,endPos:q,thickness:l})}}return c},translateContext:function(a,b){b?a.ctx.translate(a.negHalf,a.negHalf):a.ctx.translate(a.halfSize,a.halfSize)},translateContexts:function(a,b){for(var d in a)a.hasOwnProperty(d)&&(d=a[d],this.translateContext(d,b))},getRGBColor:function(a){function b(a){return a.charAt(0)==
"#"?a.substring(1,7):a}return["rgba(",parseInt(b(a).substring(0,2),16),",",parseInt(b(a).substring(2,4),16),",",parseInt(b(a).substring(4,6),16),","].join("")},clearAllCanvases:function(){if(this.contexts)for(var a=0;a<this.contexts.length;a++){var b=this.contexts[a];this.isPresent(b.ctx.canvas)?this.clearFrame(b):(this.contexts.splice(a,1),a--)}},destruct:function(){clearInterval(this.drawIntervalID);this.clearAllCanvases()}})})(jQuery);
(function(b){C("widget");C.widget.autoComplete=C.widget._base.extend({construct:function(a){C.log("autocomplete:construct");this.opts=b.extend({minChar:1,delay:200,paramName:"search_by",ajaxParamName:"search_by",button:".search-submit",dropdownOverride:null,overrideActiveClass:null,topOffset:0,showTypeIcons:!1,showCommentCounts:!1,limitParamsString:"",additionalGetParamsString:"",cssPositioning:"absolute",combineResultSets:!1,callback:null,lastItem:null,lastItemCallback:null,track:null,refreshAfterSchoolChange:!1,
urlToNavigateToAfterSchoolChange:null,schoolChangeCallback:null,useSpinner:!1,onTextboxBlur:null,attachToParent:null,overrideSolutionsImage:!1},a);if(this.opts.type=="answers")this.opts.subType="answers",this.opts.type="instantAnswers";this.mouseInDropdown=!1;this.$initializationElement=this.opts.el.jquery?this.opts.el:b(this.opts.el);this.$lastItem=this.opts.lastItem?this.opts.lastItem.jquery?this.opts.lastItem:b(this.opts.lastItem):null;if(this.$initializationElement.length){this.$initializationElement.is("input")||
this.$initializationElement.is("textarea")?(this.$input=this.$initializationElement,this.$el=this.$input.offsetParent(),this.inputInitialized=!0):(this.$el=this.$initializationElement,this.favorWrapElem=!0,this.$input=this.$el.find("input[name="+this.opts.paramName+"]"),this.inputInitialized=!1);this.activeQuestionsListWidget=null;this.needsQuestionsLists=!1;if(!this.type)this.type=this.opts.type||"combined";this.determineQuestionsListNeeded();this.isHeaderChild=(this.$parentHeaderSelector=this.$input.closest(".chg-header, .chg-hdr-root"))&&
this.$parentHeaderSelector.length;this.isDialogChild=(this.$dialogParentSelector=this.$input.closest(".dialog-widget"))&&this.$dialogParentSelector.length;this.$appendTarget=this.opts.attachToParent?this.opts.attachToParent:this.isHeaderChild?C.dom.$headerRoot:C.dom.$root;this.isFixedCss=this.opts.cssPositioning.toLowerCase()==="fixed";this.$input.attr("autocomplete","off");this.$form=this.$input.parents("form");this.$button=this.$form.parent().find(this.opts.button);this.buttonRestoreHtml=this.$button.html();
this.submitButtonSpinner=this.liRestoreHtml=null;this.url="_ajax/autocomplete";this.trackId=this.generateTrackId();this.xhrCounter=0;this.xhr=[];this.canShow=0;this.lastQuery=this.suggestVal="";this.userForcedSubmission=!1;this.saveClickedHeader=null;this.changeSchoolUrl="_ajax/user/changeschool";this.createDropdownContainer();this.doBind();this.hasRoundedCorners=parseInt(this.$input.css("border-bottom-right-radius"),10)}},generateTrackId:function(){return("000000000"+Math.abs(Math.random()*4294967295<<
0).toString(16)).slice(-8)},destruct:function(){C.log("autocomplete:destruct");this.$dropdown&&this.opts.dropdownOverride&&this.opts.overrideActiveClass?(this.$dropdown.hasClass(this.opts.overrideActiveClass)||this.$dropdown.addClass(this.opts.overrideActiveClass),this.$dropdown.remove()):(this.activeQuestionsListWidget&&this.activeQuestionsListWidget.destroy(),this.submitButtonSpinner&&this.submitButtonSpinner.destroy(),this.$dropdown&&this.$dropdown.length&&this.$dropdown.remove())},determineQuestionsListNeeded:function(){var a=
/instantanswers/i,b=/homeworkhelp/i,d=this.type;if(/question/i.test(d)||a.test(d)||b.test(d))this.needsQuestionsLists=!0;if(this.opts.subType=="answers")this.needsQuestionsLists=!1},createDropdownContainer:function(){if(this.opts.dropdownOverride&&this.opts.overrideActiveClass){if(typeof this.opts.dropdownOverride==="string")this.opts.dropdownOverride=b(this.opts.dropdownOverride);this.$dropdown=this.opts.dropdownOverride;this.$dropdown.addClass("chg-autocomplete-container")}else this.$dropdown=b('<div class="chg-autocomplete-container" id="autocomplete-'+
this.instanceNumber+'"></div>').appendTo(this.$appendTarget).hide().css({position:this.opts.cssPositioning,zIndex:-1,width:this.opts.width})},doBind:function(){var a=this;this.$input.observe({"focus.autocomplete":this.onTextboxFocus,"blur.autocomplete":this.opts.onTextboxBlur||this.onTextboxBlur,"keydown.autocomplete":this.onKeyDown,"keyup.autocomplete":this.onKeyUp},this);this.$input.observe("paste",function(){var b=arguments;setTimeout(function(){a.onKeyUp.apply(a,b)},0)},this);this.$dropdown.observe({mouseover:this.onMouseOverSelection,
mousedown:this.onSelectionClick,mouseenter:this.onMouseEnter,mouseleave:this.onMouseLeave},this);this.$button.observe("click",this.onButtonClick,this);b(window).observe("resize",this.hideDropdown,this)},getParsedUrl:function(){var a="",b="",d="",e="";this.opts.additionalGetParamsString.length&&(e=this.opts.additionalGetParamsString.substring(1)=="&"?"":"&",a=e+this.opts.additionalGetParamsString);this.opts.limitParamsString.length&&(e=this.opts.limitParamsString.substring(1)=="&"?"":"&",b=e+this.opts.limitParamsString);
this.opts.combineResultSets&&(d="&combine_results="+this.opts.combineResultsString);return this.url+"?"+this.opts.ajaxParamName+"="+encodeURIComponent(this.$input.val())+"&type="+this.type+a+b+d+"&trackid="+this.trackId},fireAjax:function(){clearTimeout(this.ajaxTimeout);var a=this;this.ajaxTimeout=setTimeout(function(){a.callAjax()},this.opts.delay)},callAjax:function(){if(this.canShow){if(this.opts.useSpinner&&this.$button.length&&this.buttonRestoreHtml&&!this.submitButtonSpinner){this.$button.html('<canvas class="loading" width="15" height="15"><img src="/s/_global/images/ajax-loader.gif"></canvas>');
var a=this.$button.find("canvas.loading");this.submitButtonSpinner=new C.widget.spinner({canvas:a,color:"#000000"})}this.xhr.push(b.ajax({url:this.getParsedUrl(),dataType:"json",context:this,success:this.onAjaxSuccess,error:this.onAjaxError}))}},onAjaxSuccess:function(a,b,d){if(this.canShow&&this.isResponseInOrder(d))this.onAjaxResponse(a)},onAjaxError:function(){},isResponseInOrder:function(a){var b;for(b=0;b<this.xhr.length;b++)if(this.xhr[b]===a)break;return b>=this.xhrCounter?(this.xhrCounter=
b,!0):!1},onAjaxResponse:function(a){if(this.buildAutocompleteDropdown(a)){if(this.$button.length&&this.submitButtonSpinner)this.$button.html(this.buttonRestoreHtml),this.submitButtonSpinner=null;this.showDropdown();b("body").trigger("autocomplete:success",{data:a})}else b("body").trigger("autocomplete:noResults")},showDropdown:function(){if(this.canShow&&!this.userForcedSubmission)if(this.opts.dropdownOverride&&this.opts.overrideActiveClass)this.$dropdown&&!this.$dropdown.hasClass(this.opts.overrideActiveClass)&&
this.$dropdown.addClass(this.opts.overrideActiveClass),this.$dropdown.find("p").css({visibility:"hidden"}).each(function(){var a=this,c=b(this),e=c.text(),d=c.find("span").text(),f,j="",u,p;a.scrollHeight<=a.offsetHeight?c.css({visibility:"visible"}):(f=e.split(/\s+/),u=0,p=setInterval(function(){f[u]?(j+=f[u]+" ",c.text(j),a.scrollHeight>a.offsetHeight?(f=f.slice(0,u-1),f=f.join(" ")+"...",d.length&&($regex=RegExp("("+d+")"),f=f.replace($regex,'<span class="chg-suggest-term">$1</span>')),c.html(f),
clearInterval(p),c.css({visibility:"visible"})):u++):(clearInterval(p),c.css({visibility:"visible"}))},0))});else{var a=this.opts.width||this.$input.outerWidth()-2,c=this.$input.offset(),d=this.favorWrapElem?this.$initializationElement:this.$input;this.isFixedCss?d.position():d.offset();var e=d.outerHeight(!0),f=c.left;e+=this.opts.topOffset;var j=[0];this.$input.parents().each(function(a,c){j.push(+b(c).css("zIndex")||0)});j=C.utility.max(j)+1;this.opts.cssPositioning!=="fixed"&&!this.isHeaderChild?
(d=this.$input.scrollTop(),e+=d+c.top):this.isDialogChild&&(e+=d.position().top+parseInt(this.$dialogParentSelector.css("top"),10));this.$dropdown.css({position:this.opts.cssPositioning,zIndex:j,width:a+"px",left:f+"px",top:e+"px"}).show();this.opts.attachToParent&&this.$dropdown.css({position:"relative",left:"0px",top:"0px"});this.hasRoundedCorners&&this.$input.css({"border-radius":"5px 5px 0 0"});this.userForcedSubmission=!1}},hideDropdown:function(){var a=this;this.opts.dropdownOverride&&this.opts.overrideActiveClass?
this.$dropdown.hasClass(this.opts.overrideActiveClass)&&this.$dropdown.removeClass(this.opts.overrideActiveClass):setTimeout(function(){a.hasRoundedCorners&&a.$input.css({"border-radius":"5px"});a.$dropdown.hide()},300)},onTextboxFocus:function(){if(this.$input.val().length&&this.$dropdown.html().length)this.canShow=1,this.showDropdown()},onTextboxBlur:function(){if(!this.mouseInDropdown&&!this.$input.is(":focus"))this.canShow=0,this.hideDropdown()},onMouseEnter:function(){if(!this.mouseInDropdown)this.mouseInDropdown=
!0},onMouseLeave:function(){if(this.mouseInDropdown)this.mouseInDropdown=!1,this.onTextboxBlur()},onKeyUp:function(a){if(a.keyCode==13)this.userForcedSubmission=!0,this.hideDropdown();else if(a=b.trim(this.$input.val()),this.lastQuery!=a){this.lastQuery=a;var c=String(this.$input.attr("textvalue"));if(a==c||a===""||a.length<this.opts.minChar){if(this.$button.length&&this.submitButtonSpinner)this.$button.html(this.buttonRestoreHtml),this.submitButtonSpinner=null;this.canShow=0;this.hideDropdown()}else this.canShow=
1,this.suggestVal="",this.fireAjax(),this.userForcedSubmission=!1}},onKeyDown:function(a){if(a.keyCode==40)this.doNextSelection(a),a.preventDefault();else if(a.keyCode==38)this.doPrevSelection(a),a.preventDefault();else if(a.keyCode==27)this.$input.blur();else if(a.keyCode==13)this.onSubmit(a)},onMouseOverSelection:function(a){var c=this.getTargetedLi(a),a=a.currentTarget;c.hasClass("disabled")||(c.length&&(b(a).find("li").removeClass("suggest-selected"),c.addClass("suggest-selected")),this.changeSelection(c))},
getTargetedLi:function(a){return b(a.target).closest("li")},doNextSelection:function(a){var b=this.$dropdown.find("li"),d=b.index(this.$dropdown.find("li.suggest-selected"));b.removeClass("suggest-selected");b=d==-1||d>=b.length-1?b.eq(0).addClass("suggest-selected"):b.eq(d+1).addClass("suggest-selected");if(b.hasClass("disabled"))return this.doNextSelection(a),!1;this.changeSelection(b)},doPrevSelection:function(a){var b=this.$dropdown.find("li"),d=b.index(this.$dropdown.find("li.suggest-selected"));
b.removeClass("suggest-selected");b=d==-1||d===0?b.eq(b.length-1).addClass("suggest-selected"):b.eq(d-1).addClass("suggest-selected");if(b.hasClass("disabled"))return this.doPrevSelection(a),!1;this.changeSelection(b)},onButtonClick:function(){var a=b.trim(this.$input.val());a==this.$input.attr("textvalue")||a===""||this.$form.submit();return!1},changeSelection:function(a){this.$curLi=a;a=this.$curLi.find(".autocomplete-hdr");this.suggestVal=this.saveClickedHeader=a.length?a.text():null},onSubmit:function(a){if(!this.$curLi){if(this.opts.track){var b=
this.opts.track.split("=");this.$form.append('<input type="hidden" name="'+b[0]+'" value="'+b[1]+'" />')}this.opts.callback&&this.opts.callback(a);return!0}if(this.$curLi.hasClass("disabled"))return a.preventDefault(),!1;if(this.suggestVal.length){a.preventDefault();this.hideDropdown();b=this.$curLi.find(".autocomplete-hdr");if(b.length)this.saveClickedHeader=b.text();if(this.opts.callback&&this.$curLi)return this.opts.callback(a,this.$curLi,this.$initializationElement),!1;if(this.$curLi.hasClass("school-change"))return this.changeUserSchool(a,
this.$curLi),!1;a=this.$curLi.attr("data-url");b=this.$curLi.attr("data-ii");b!=void 0&&(a=a.indexOf("?")==-1?a+"?ii="+b:a+"&ii="+b,this.opts.track&&(a+="&"+this.opts.track));top.location.href=a;return!1}return!0},getDisabledItems:function(a){if(!this.opts)this.opts={};if(!this.opts.disabledItems||typeof this.opts.disabledItems!=="object")this.opts.disabledItems={};var c=[];this.opts.disabledItems[a]&&typeof this.opts.disabledItems[a]==="object"&&_.each(this.opts.disabledItems[a],function(a){c.push(b.trim(a))});
return c},convertItemsToArray:function(a){return!a?[]:typeof a!=="object"?[a]:a},setDisabledItems:function(a,b){var d=this.getDisabledItems(a);a&&typeof a==="string"&&(this.opts.disabledItems[a]=this.convertItemsToArray(b));d.toString()!=this.getDisabledItems(a).toString()&&(this.hideDropdown(),this.$dropdown.html(""));return this},addDisabledItems:function(a,b){var d=_.union(this.getDisabledItems(a),this.convertItemsToArray(b));return this.setDisabledItems(a,d)},removeDisabledItems:function(a,b){var d=
_.difference(this.getDisabledItems(a),this.convertItemsToArray(b));return this.setDisabledItems(a,d)},checkItemIsDisabled:function(a){if(!a||typeof a!=="object"||!_.size(a))return!1;if(a.hasOwnProperty("disabled")&&a.disabled==!0)return!0;var b=!1,d=this;_.each(a,function(a,f){if(_.indexOf(d.getDisabledItems(f),a)>-1)return b=!0,!1});return b},buildAutocompleteSectionItem:function(a,c){var d=[],e=a.title?a.title.toLowerCase().indexOf("question")>=0:!1,f=e?a.replaceIsSafe:!0,e=e&&f?b.trim(a.replaceTerm):
b.trim(this.$input.val()),e=RegExp("("+this.RegExpQuote(e)+")","i"),j=b("<div/>").html(a.title).text(),k=typeof a.hasTBS!=="undefined"&&a.hasTBS?a.hasTBS:!1,l='<li data-ii="'+c+'" ',q="",r=this.checkItemIsDisabled(a.attributes)?"disabled ":"";if(a.listClass){if(typeof a.itemType!=="undefined"&&a.itemType.indexOf("school")>-1&&(a.attributes["data-schoolId"].length>1||a.attributes["data-schoolId"]>1))q="chgent_school chgentid_"+a.attributes["data-schoolId"]+" ";r+=" "+q+a.listClass+" "}r&&(l+='class="'+
b.trim(r)+'" ');d.push(l);if(a.attributes)for(var g in a.attributes)d.push(g+'="'+a.attributes[g]+'" ');d.push(">");a.img&&(a.img.url&&(d.push('<img src="'+a.img.url+'"'),d.push(' alt="'+(a.img.alt?a.img.alt:"chegg image")+'"'),a.img.width&&d.push(' width="'+a.img.width+'"'),a.img.height&&d.push(' height="'+a.img.height+'"'),a.img.onError&&d.push('this.onerror=null; onError="'+a.img.onError+'"'),d.push(" />")),d.push("<div>"));a.typeicon&&this.opts.showTypeIcons&&(a.typeicon.type==="count"&&a.countDisplay?
d.push('<span class="icn-count-22 '+a.typeicon.iconclass+'">'+a.countDisplay+"</span>"):d.push('<span class="autocomplete-type-icon '+a.typeicon.iconclass+'">'+a.typeicon.type+"</span>"));typeof a.starRating!=="undefined"&&a.starRating&&d.push('<div class="autocomplete-star-rating"><span class="star-'+a.starRating+'-sm">'+a.starRating+" Stars</span></div>");k&&a.solutionsUrl&&!this.opts.overrideSolutionsImage&&d.push('<a class = "autocomplete-hasTBS" href ='+a.solutionsUrl+"></a>");a.title&&(g=f?
j.replace(e,'<span class="chg-suggest-term">$1</span>'):a.title,d.push('<p class="autocomplete-hdr">'+g+"</p>"));a.subtitle&&(f=f?a.subtitle.replace(e,'<span class="chg-suggest-term">$1</span>'):a.subtitle,d.push('<p class="autocomplete-subtitle">'+f+"</p>"));a.author&&(f=a.author.replace(e,'<span class="chg-suggest-term">$1</span>'),d.push('<p class="autocomplete-author">'+f+"</p>"));a.isbnText&&(f=a.isbnText.replace(e,'<span class="chg-suggest-term">$1</span>'),f=f.replace("&amp;nbsp;"," &nbsp; "),
a.editionNo&&a.editionNo!=0&&(f="Edition: "+a.editionNo+" "+f),d.push('<p class="autocomplete-isbn">'+f+"</p>"));a.coursename&&(e=a.coursename.replace(e,'<span class="chg-suggest-term">$1</span>'),d.push('<p class="autocomplete-course">'+e+"</p>"));this.showCommentCounts&&a.commentCount>0&&d.push('<span class="comment-count">'+a.commentCount+"</span>");a.button&&d.push("<button"+(a.button.id?' id="'+a.button.id+'"':"")+(a.button.btnclass?' class="'+a.button.btnclass+'"':"btn-primary-mini")+">"+(a.button.text?
a.button.text:"go")+"</button>");a.img&&d.push("</div>");d.push("</li>");return d.join("")},buildAutocompleteDropdown:function(a){if(a=typeof a=="object"?a:jQuery.parseJSON(a)){var c='<div id="'+this.opts.type.replace("|","_")+'_autocomplete"></div>',c=b(c),d=1;if(a){for(var e in a)if(a[e].title){c.append(b('<p class="automplete-sec-hdr">'+a[e].title+"</p>"));var f=b("<ul></ul>");this.needsQuestionsLists&&f.addClass("questions-list");for(var j in a[e].items){var k=this.buildAutocompleteSectionItem(a[e].items[j],
d),k=b(k);k.data("itemDetail",a[e].items[j]);f.append(k);d++}this.$lastItem&&(this.$lastItem.addClass("last-item"),f.append(this.$lastItem));c.append(f)}this.$lastItem&&c.find("ul").length==0&&(this.$lastItem.addClass("last-item"),e=b("<ul></ul>"),e.append(this.$lastItem),c.append(e));this.$dropdown.html(c).find("li:last-child").css({borderBottom:0});return c.html()==""?!1:!0}}},wireQuestionsList:function(a){this.activeQuestionsListWidget&&this.activeQuestionsListWidget.destroy();var b=this.$dropdown.find(".questions-list");
if(b.length)this.activeQuestionsListWidget=new C.widget.questionsList({el:b,removeCourseButton:!0,disableAnswering:!0});(a=a||null)&&this.activeQuestionsListWidget&&this.activeQuestionsListWidget.getAjaxQuestion(a)},RegExpQuote:function(a){return(a+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},onSelectionClick:function(a){if(b(a.target).hasClass("autocomplete-hasTBS"))this.hideDropdown();else if(!b(a.target).hasClass("automplete-sec-hdr")&&a.which===1){var c=this.getTargetedLi(a);if(!c.hasClass("disabled")){this.$curLi=
c;this.hideDropdown();if(this.$curLi.hasClass("last-item"))return this.opts.lastItemCallback&&this.opts.lastItemCallback(a,this.$curLi,this.$initializationElement),!1;if(this.opts.callback)this.opts.callback(a,this.$curLi,this.$initializationElement);else{c=this.$curLi.find(".autocomplete-hdr");if(c.length)this.saveClickedHeader=c.text(),this.updateInputVal();this.liRestoreHtml=this.$curLi.html();this.$curLi.html('<canvas class="loading" width="20" height="20"><img src="/s/_global/images/ajax-loader.gif"></canvas>');
c=this.$curLi.find("canvas.loading");new C.widget.spinner({canvas:c,color:"#000000"});if(this.$curLi.hasClass("school-change"))return this.changeUserSchool(a,this.$curLi),!1;a=this.$curLi.attr("data-url");c=this.$curLi.attr("data-ii");c!=void 0&&(a=a.indexOf("?")==-1?a+"?ii="+c:a+"&ii="+c,this.opts.track&&(a+="&"+this.opts.track));if(this.liRestoreHtml)this.$curLi.html(this.liRestoreHtml),this.liRestoreHtml=null;top.location.href=a;return!1}}}},changeType:function(a,c){var d=c||{},e=this.opts;typeof a!==
"string"&&JSON.stringify(a);this.type=a;this.opts=b.extend({type:a},e,d);this.$dropdown&&(this.hideDropdown(),this.$dropdown.html(""));this.determineQuestionsListNeeded()},setPlaceholder:function(a){this.$input.attr("placeholder",a)},changeUserSchool:function(a,c){var d=c.jQuery?c:b(c),e=d.attr("data-schoolid");d.addClass("chgent_school chgentid_"+e);this.updateInputVal();if(this.liRestoreHtml)this.$curLi.html(this.liRestoreHtml),this.liRestoreHtml=null;if(this.opts.schoolChangeCallback)return this.opts.schoolChangeCallback(a,
d),!1;this.submitUserSchool(e)},submitUserSchool:function(a){var a={gid:a},c=this;this.addAPITokenTo(a);var d=this.opts.refreshAfterSchoolChange,e=this.opts.urlToNavigateToAfterSchoolChange;b.ajax({type:"POST",dataType:"json",url:this.changeSchoolUrl,data:a,success:function(a){e?C.utility.navigate(e):(d&&(b(".chg-content > div").css({opacity:0.5}),top.location.reload()),c.opts.schoolChangeSuccessCallback&&c.opts.schoolChangeSuccessCallback(a))},error:function(){return!1}})},updateInputVal:function(){if(this.saveClickedHeader)this.$input.off(".autocomplete"),
this.$input.val(this.saveClickedHeader),this.$input.blur(),this.$input.observe({"focus.autocomplete":this.onTextboxFocus,"blur.autocomplete":this.onTextboxBlur,"keydown.autocomplete":this.onKeyDown,"keyup.autocomplete":this.onKeyUp},this),this.saveClickedHeader=null},addAPITokenTo:function(a){a.token=C.global.csrfToken}})})(jQuery);
(function(b){C.widget.autoCompleteHeader=C.widget.autoComplete.extend({construct:function(a){C.log("autocomplete:construct");this.GAclient=Eggshell.create("C.report.GA");this.opts=b.extend({minChar:1,delay:200,paramName:"search_by",ajaxParamName:"search_by",button:".search-magnify-btn",dropdownOverride:null,overrideActiveClass:null,topOffset:0,showTypeIcons:!1,showCommentCounts:!1,limitParamsString:"",additionalGetParamsString:"",cssPositioning:"absolute",combineResultSets:!1,callback:null,lastItem:null,
lastItemCallback:null,track:null,refreshAfterSchoolChange:!1,urlToNavigateToAfterSchoolChange:null,schoolChangeCallback:null,useSpinner:!1,inHeader:!1,psycicResults:"#autosuggest-psycic",autoSuggestResults:"#autosuggest-results",container:"#autosuggest-results-container",thumbWidth:70,thumbHeight:85,thumbLetterBox:!0,showResultsFlag:!1,slideDown:!0},a);this.mouseInDropdown=!1;this.$initializationElement=this.opts.el.jquery?this.opts.el:b(this.opts.el);this.$lastItem=this.opts.lastItem?this.opts.lastItem.jquery?
this.opts.lastItem:b(this.opts.lastItem):null;if(this.$initializationElement.length){this.$el=this.$initializationElement;this.favorWrapElem=!0;this.$input=this.$el.find("input[name="+this.opts.paramName+"]");this.inputInitialized=!1;if(!this.type)this.type=this.opts.type||"combined";this.isHeaderChild=(this.$parentHeaderSelector=this.$input.closest(".chg-header, .chg-hdr-root"))&&this.$parentHeaderSelector.length;this.isDialogChild=(this.$dialogParentSelector=this.$input.closest(".dialog-widget"))&&
this.$dialogParentSelector.length;this.$appendTarget=this.isHeaderChild?C.dom.$headerRoot:C.dom.$root;this.isFixedCss=this.opts.cssPositioning.toLowerCase()==="fixed";this.$input.attr("autocomplete","off");this.$form=this.$input.parents("form");this.$button=this.$form.parent().find(this.opts.button);this.buttonRestoreHtml=this.$button.html();this.submitButtonSpinner=this.liRestoreHtml=null;this.url="_ajax/autocomplete";this.trackId=this.generateTrackId();this.xhrCounter=0;this.xhr=[];this.canShow=
0;this.lastQuery=this.suggestVal="";this.userForcedSubmission=!1;this.saveClickedHeader=null;this.changeSchoolUrl="_ajax/user/changeschool";this.getSchoolUrl="_ajax/school/info";this.gid=C.utility.getCookie("gid");this.schoolInfo={};this.evaluateSchoolData(this.gid);this.createDropdownContainer();this.doBind();b("#header_autocomplete").removeAttr("disabled").blur();b("#header_autocomplete_close").removeClass("icn-disabled");b(".chg-header input#header_autocomplete").keyup(function(a){a.keyCode==
13&&(b("li.suggest-selected").length>0?C.logger.doSessionLog({src:"header"}):C.logger.doSessionLog({src:"header",action:"enter"}))});b(".chg-header #header_autocomplete_submit").click(function(){C.logger.doSessionLog({src:"header",action:"button"})})}},createDropdownContainer:function(){if(this.opts.dropdownOverride&&this.opts.overrideActiveClass){if(typeof this.opts.dropdownOverride==="string")this.opts.dropdownOverride=b(this.opts.dropdownOverride);this.$dropdown=this.opts.dropdownOverride;this.$psycic=
this.opts.psycicResults}else this.$dropdown=b('<div class="chg-autocomplete-container" id="autocomplete-'+this.instanceNumber+'"></div>').appendTo(this.$appendTarget).hide().css({position:this.opts.cssPositioning,zIndex:-1,width:this.opts.width})},doBind:function(){this.$input.observe({"focus.autocomplete":this.onTextboxFocus,"blur.autocomplete":this.onTextboxBlur,"keydown.autocomplete":this.onKeyDown,"keyup.autocomplete":this.onKeyUp},this);this.$dropdown.observe({mouseover:this.onMouseOverSelection,
mousedown:this.onSelectionClick,mouseenter:this.onMouseEnter,mouseleave:this.onMouseLeave},this);b(this.opts.psycicResults).observe({mousedown:this.onSelectionClick,mouseover:this.onMouseOverSelection},this);this.$button.observe("click",this.onButtonClick,this);b(".chg-container").observe({mousedown:this.hideAS},this);b(".chg-header").observe({mousedown:this.hideAS},this);b("#header_autocomplete_close").observe({click:this.hideAS},this);b(window).observe("resize",this.hideDropdown,this)},getParsedUrl:function(){var a=
"",b="",d="",e="";this.opts.additionalGetParamsString.length&&(e=this.opts.additionalGetParamsString.substring(1)=="&"?"":"&",a=e+this.opts.additionalGetParamsString);this.opts.limitParamsString.length&&(e=this.opts.limitParamsString.substring(1)=="&"?"":"&",b=e+this.opts.limitParamsString);this.opts.combineResultSets&&(d="&combine_results="+this.opts.combineResultsString);return this.url+"?"+this.opts.ajaxParamName+"="+encodeURIComponent(this.$input.val())+"&type="+this.type+a+b+d+"&trackid="+this.trackId},
onTextboxFocus:function(){if(this.$input.val().length&&this.$dropdown.html().length)this.canShow=1;this.animateContainerOpen()},onTextboxBlur:function(){if(!this.mouseInDropdown){if(!this.$input.is(":focus"))this.canShow=0,this.hideDropdown(),this.$input.val()||this.clearSearchInput();this.opts.showResultsFlag=!1}},onButtonClick:function(){var a=b.trim(this.$input.val());a==this.$input.attr("textvalue")||a===""||this.$form.submit();return!1},callAjax:function(){if(this.canShow){if(this.opts.useSpinner&&
this.$button.length&&this.buttonRestoreHtml&&!this.submitButtonSpinner){this.$button.html('<canvas class="loading" width="15" height="15"><img src="/s/_global/images/ajax-loader.gif"></canvas>');var a=this.$button.find("canvas.loading");this.submitButtonSpinner=new C.widget.spinner({canvas:a,color:"#FFFFFF"})}this.xhr.push(b.ajax({url:this.getParsedUrl(),dataType:"json",context:this,success:this.onAjaxSuccess,error:this.onAjaxError}))}},onAjaxResponse:function(a){if(this.buildAutocompleteDropdown(a)){if(this.$button.length&&
this.submitButtonSpinner)this.$button.html(this.buttonRestoreHtml),this.submitButtonSpinner=null}else b("body").trigger("autocomplete:noResults")},onKeyUp:function(a){if(a.keyCode==13)a=b("#autosuggest-psycic li.autosuggest-result-psycic.suggest-selected a"),a.length>0&&(a.removeClass("suggest-selected"),this.GAclient.trigger("report custom event",{page:"Header",section:"Psycic search",link:a.attr("data-reportlink")})),this.userForcedSubmission=!0,this.hideDropdown();else if(a=b.trim(this.$input.val()),
this.lastQuery!=a){this.lastQuery=a;var c=String(this.$input.attr("textvalue"));if(a==c||a===""||a.length<this.opts.minChar){if(this.$button.length&&this.submitButtonSpinner)this.$button.html(this.buttonRestoreHtml),this.submitButtonSpinner=null;this.canShow=0;b("#autosuggest-results").hide().removeClass("active");b(this.opts.psycicResults).show().css("height","auto").addClass("active");b(this.opts.psycicResults).find("li").removeClass("suggest-selected")}else this.canShow=1,this.suggestVal="",this.fireAjax(),
this.userForcedSubmission=!1,b(this.opts.psycicResults).hide(),b(this.opts.psycicResults).find("li").removeClass("suggest-selected"),this.onTextboxFocus()}},animateContainerOpen:function(){if(C.global.pageObject.schoolId)this.responseId=C.global.pageObject.schoolId;this.canShow?(b(this.opts.autoSuggestResults).removeAttr("style").addClass("active"),b(this.opts.autoSuggestResults).show(),this.showDropdown()):(this.GAclient.trigger("report custom event",{page:"Header",section:"Psycic search",link:"Show"}),
this.updatePsycicMarkup(),b(this.opts.psycicResults).removeAttr("style").addClass("active"),b(this.opts.psycicResults).show(),b(".icn-x").show(),this.opts.showResultsFlag=!0);this.opts.slideDown==!0?b(this.opts.container).slideDown(300):b(this.opts.container).css("display","block");this.resizeTitleContainer()},clearSearchInput:function(){b("#header_autocomplete").val("");b(".icn-x").hide();b("#header_autocomplete").focusout()},onMouseEnter:function(){if(!this.mouseInDropdown)this.mouseInDropdown=
!0},onMouseOverSelection:function(a){var c=this.getTargetedLi(a),a=a.currentTarget;c.length&&(b(a).find("li").removeClass("suggest-selected"),c.addClass("suggest-selected"));this.changeSelection(c)},showDropdown:function(){if(this.canShow&&!this.userForcedSubmission)if(this.opts.dropdownOverride&&this.opts.overrideActiveClass)this.$dropdown&&!this.$dropdown.hasClass(this.opts.overrideActiveClass)&&this.$dropdown.addClass(this.opts.overrideActiveClass);else{var a=this.opts.width||this.$input.outerWidth(),
c=this.$input.offset(),d=this.favorWrapElem?this.$initializationElement:this.$input;this.isFixedCss?d.position():d.offset();var e=d.outerHeight(!0),f=c.left;e+=this.opts.topOffset;var j=[0];this.$input.parents().each(function(a,c){j.push(+b(c).css("zIndex")||0)});j=C.utility.max(j)+1;this.opts.cssPositioning!=="fixed"&&!this.isHeaderChild?(d=this.$input.scrollTop(),e+=d+c.top):this.isDialogChild&&(e+=d.position().top+parseInt(this.$dialogParentSelector.css("top"),10));this.$dropdown.css({position:this.opts.cssPositioning,
zIndex:j,width:a+"px",left:f+"px",top:e+"px"}).show();this.userForcedSubmission=!1}},hideDropdown:function(){b("#autosuggest-results-container").hide();this.$dropdown.hide();b("#header_autocomplete").focusout()},hideAS:function(a){var a=a.target,c=document.getElementById("autosuggest-results-container"),d=b.contains(c,a),e=a==document.getElementById("header_autocomplete");b(c).find("li").removeClass("suggest-selected");if(b(a).hasClass("icn-magnify")==!1)!d&&!e&&(b(c).hide(),b(this.opts.autoSuggestResults).hide(),
b("#header_autocomplete").blur().val("")),this.canShow=0,this.opts.showResultsFlag=!1},toOrdinal:function(a){var b=a%10;return b==1&&a!=11?a+"st":b==2&&a!=12?a+"nd":b==3&&a!=13?a+"rd":a+"th"},buildAutocompleteSectionItem:function(a,c){var d=[],e=a.title?a.title.toLowerCase().indexOf("question")>=0:!1,f=e?a.replaceIsSafe:!0,e=e&&f?b.trim(a.replaceTerm):b.trim(this.$input.val()),j=RegExp("("+this.RegExpQuote(e)+")","i"),k=b("<div/>").html(a.title).text(),e=a.typeicon&&a.typeicon.type=="course",l=a.itemType?
a.itemType:"book";if(a.title)f=f?k.replace(j,'<span class="chg-suggest-term">$1</span>'):a.title,a.title=f;if(a.isbnText)f=a.isbnText.replace(j,'<span class="chg-suggest-term">$1</span>'),f=f.replace("&amp;nbsp;"," &nbsp; "),a.editionNo&&a.editionNo!=0&&(f=this.toOrdinal(a.editionNo)+" Edition - "+f),l=="ebook"&&(f=f.replace("ISBN","eISBN"),f=f.replace("ISBN13","eISBN13")),a.isbnText=f;if(a.img&&a.img.url)a.img.alt=a.img.alt?a.img.alt:"chegg image";typeof a.itemPromo=="object"&&(a.itemPromo.hasTBS||
a.itemPromo.hasInstantAccess||a.itemPromo.hasEbook)?(f=a.itemPromo,a.hasItemPromo=!0,a.hasTBS=f.hasTBS?f.hasTBS:!1,a.hasInstantAccess=f.hasInstantAccess?f.hasInstantAccess:!1,a.hasEbook=f.hasEbook?f.hasEbook:!1,a.availableEbookText=a.hasEbook&&a.hasTBS?'<span class="skip-available">eTextbook</span>':'<span class="emphasis">Available:</span> eTextbook'):a.hasItemPromo=!1;a.courseClassName=courseClassName=e?" autosuggest-result-course":" ";a.iiCount=c;switch(l){case "ebook":f=template.ebook({item:a});
break;case "course":f=template.course({item:a});break;case "dac":f=template.dac({item:a});break;default:f=template.book({item:a})}d.push(f);return d.join("")},onKeyDown:function(a){if(a.keyCode==40)this.doNextSelection(a),a.preventDefault();else if(a.keyCode==38)this.doPrevSelection(a),a.preventDefault();else if(a.keyCode==27)this.$input.val(""),this.$input.blur(),this.hideDropdown();else if(a.keyCode==13)this.onSubmit(a)},doNextSelection:function(){var a=this.$dropdown.hasClass("active")?this.$dropdown:
this.$psycic,c=b(a).find("li.autosuggest-result"),a=c.index(b(a).find("li.suggest-selected"));c.removeClass("suggest-selected");this.changeSelection(a==-1||a>=c.length-1?c.eq(0).addClass("suggest-selected"):c.eq(a+1).addClass("suggest-selected"))},doPrevSelection:function(){var a=this.$dropdown.hasClass("active")?this.$dropdown:this.$psycic,c=b(a).find("li.autosuggest-result"),a=c.index(b(a).find("li.suggest-selected"));c.removeClass("suggest-selected");this.changeSelection(a==-1||a===0?c.eq(c.length-
1).addClass("suggest-selected"):c.eq(a-1).addClass("suggest-selected"))},evaluateSchoolData:function(a){savedId=C.utility.getLocal("schoolId");savedName=C.utility.getLocal("schoolName");if(!a)return!1;if(a&&savedId&&savedName&&a==savedId)return this.schoolInfo={schoolName:savedName,schoolId:savedId},!0;else this.getSchool(a)},updatePsycicMarkup:function(){b("#autosuggest-psycic").html(template.psycic({schoolInfo:this.schoolInfo}))},getSchool:function(a){var c=this;b.ajax({type:"GET",dataType:"json",
url:this.getSchoolUrl,data:{school:a},success:function(a){a=a.schoolInfo;C.utility.setLocal("schoolId",a.schoolId);C.utility.setLocal("schoolName",a.nickname?a.nickname:a.longName);c.schoolInfo={schoolName:a.nickname?a.nickname:a.longName,schoolId:a.schoolId};c.updatePsycicMarkup();return!0},error:function(){return!1}})},onSelectionClick:function(a){if(b(a.target).hasClass("autocomplete-show-more"))this.hideAS(a.target),C.utility.navigate(a.target.href);else if(b(a.target).parents().hasClass("autosuggest-result-psycic")){var c=
b(a.target).parents("a").attr("href")!=void 0?b(a.target).parents("a").attr("href"):b(a.target).attr("href");this.GAclient.trigger("report custom event",{page:"Header",section:"Psycic search",link:b(a.target).parents("a").attr("data-reportlink")});C.utility.navigate(c)}else if(!b(a.target).parents().hasClass("autosuggest-no-results")&&!b(a.target).hasClass("autocomplete-hasTBS")&&a.which===1){this.$curLi=this.getTargetedLi(a);this.hideDropdown();if(this.$curLi.hasClass("last-item"))return this.opts.lastItemCallback&&
this.opts.lastItemCallback(a,this.$curLi,this.$initializationElement),!1;if(this.$curLi.hasClass("question-get")&&!this.$curLi.hasClass("no-modal")&&this.opts.subType!="answers")return this.wireQuestionsList(this.$curLi.attr("data-qid")),!1;if(this.opts.callback)this.opts.callback(a,this.$curLi,this.$initializationElement);else{c=this.$curLi.find(".autocomplete-hdr");if(c.length)this.saveClickedHeader=c.text(),this.updateInputVal();this.liRestoreHtml=this.$curLi.html();this.$curLi.html('<canvas class="loading" width="20" height="20"><img src="/s/_global/images/ajax-loader-white.gif"></canvas>');
c=this.$curLi.find("canvas.loading");new C.widget.spinner({canvas:c,color:"#000000"});if(this.$curLi.hasClass("school-change"))return this.changeUserSchool(a,this.$curLi),!1;c=this.$curLi.attr("data-url");a=this.$curLi.attr("data-ii");a!=void 0&&(c=c.indexOf("?")==-1?c+"?ii="+a:c+"&ii="+a,this.opts.track&&(c+="&"+this.opts.track));if(this.liRestoreHtml)this.$curLi.html(this.liRestoreHtml),this.liRestoreHtml=null;C.logger.doSessionLog({src:"header"});C.utility.navigate(c);return!1}}},resizeTitleContainer:function(){var a=
b(".autosuggest-result-data").width(),a=parseInt(a)-30;b(".autosuggest-result-title").css("width",a)},onSubmit:function(a){if(!this.$curLi){if(this.opts.track){var c=this.opts.track.split("=");this.$form.append('<input type="hidden" name="'+c[0]+'" value="'+c[1]+'" />')}return!0}var d=this.$curLi.find(".autocomplete-hdr"),c=this.$input.val();if(this.suggestVal&&this.suggestVal.length||c!=""){a.preventDefault();this.hideDropdown();if(d.length)this.saveClickedHeader=d.text();if(this.opts.callback&&
this.$curLi)return this.opts.callback(a,this.$curLi,this.$initializationElement),!1;if(this.$curLi.hasClass("school-change"))return this.changeUserSchool(a,this.$curLi),!1;a=this.$curLi.attr("data-url");d=this.$curLi.attr("data-ii");if(d!=void 0){var e=b(".autosuggest-result"),f=!1;b.each(e,function(){b(this).hasClass("suggest-selected")&&(f=!0)});if(f)a=a.indexOf("?")==-1?a+"?ii="+d:a+"&ii="+d,this.opts.track&&(a+="&"+this.opts.track);else return C.utility.navigate("/search/"+c+"/books"),!1}else a=
"/search/"+c+"/books"}else a=this.$curLi.find("a").attr("href");C.utility.navigate(a);return!1},buildAutocompleteDropdown:function(a){if(a=typeof a=="object"?a:jQuery.parseJSON(a)){var c='<div id="'+this.opts.type.replace("|","_")+'_autocomplete"></div>',c=b(c),d=1;if(a[0].items[0]==void 0)return this.$dropdown.html(c),b(this.opts.psycicResults).hide().removeClass("active"),b(this.opts.autoSuggestResults).show().addClass("active"),c.append(template.noresults()),!0;if(a){for(var e in a)if(a[e].title){var f=
b("<ul></ul>");this.needsQuestionsLists&&f.addClass("questions-list");for(var j in a[e].items){var k=this.buildAutocompleteSectionItem(a[e].items[j],d),k=b(k);f.append(k);d++}c.append(f)}this.$dropdown.html(c);b(this.opts.psycicResults).hide().removeClass("active");b(this.opts.autoSuggestResults).show().addClass("active");if(c.html()=="")return!1;this.schoolInfo.query=this.$input.val();c.append(template.showall({schoolInfo:this.schoolInfo}));this.resizeTitleContainer();return!0}}}})})(jQuery);
var template={};template.book=_.template('<li class="autosuggest-result" data-ii="<%= item.iiCount %>" data-url="<%= item.attributes["data-url"] %>"><a href="<%= item.attributes["data-url"] %>"><span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last"><div class="autosuggest-result-meta"><% if(_.isEqual(item.hasItemPromo,true)){ %><span class="autosuggest-icon-meta"></span><div class="autosuggest-results-meta-info"><% if(_.isEqual(item.hasTBS,true)){ %><span class="autosuggest-results-meta-info-item"><span class="emphasis">Available:</span> Step-by-step Solutions</span><% } %><% if(_.isEqual(item.hasEbook,true)){ %><span class="autosuggest-results-meta-info-item"><%= item.availableEbookText %><% } %><% if(_.isEqual(item.hasInstantAccess,true)){ %><span class="autosuggest-results-meta-info-item"><span class="emphasis">Includes:</span> Free 7-day eTextbook Access</span><% } %></div><% } %></div><div class="autosuggest-result-data"><span class="img-wrapper"><img src="<%= item.img.url %>" alt="<%= item.imgAlt %>"></span><div class="autosuggest-result-bookinfo-sizer"><div class="autosuggest-result-bookinfo"><span class="autosuggest-result-title autocomplete-hdr"><%= item.title %></span><span class="autosuggest-result-author"><%= item.author %></span><span class="autosuggest-result-info"><%= item.isbnText %></span></div></div></div></span></span></span></a></li>');
template.ebook=_.template('<li class="autosuggest-result" data-ii="<%= item.iiCount %>" data-url="<%= item.attributes["data-url"] %>"><a href="<%= item.attributes["data-url"] %>"><span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last"><div class="autosuggest-result-meta"><% if(_.isEqual(item.hasItemPromo,true)){ %><span class="autosuggest-icon-meta"></span><div class="autosuggest-results-meta-info"><% if(_.isEqual(item.hasTBS,true)){ %><span class="autosuggest-results-meta-info-item"><span class="emphasis">Available:</span> Step-by-step Solutions</span><% } %><% if(_.isEqual(item.hasInstantAccess,true)){ %><span class="autosuggest-results-meta-info-item"><span class="emphasis">Includes:</span> Free 7-day eTextbook Access</span><% } %></div><% } %></div><div class="autosuggest-result-data"><span class="autosuggest-icon autosuggest-icon-etextbook-sml"></span><span class="img-wrapper"><img src="<%= item.img.url %>" alt="<%= item.imgAlt %>"></span><div class="autosuggest-result-bookinfo-sizer"><div class="autosuggest-result-bookinfo"><span class="autosuggest-result-title autocomplete-hdr"><%= item.title %></span><span class="autosuggest-result-author"><%= item.author %></span><span class="autosuggest-result-info"><%= item.isbnText %></span></div></div></div></span></span></span></a></li>');
template.dac=_.template('<li class="autosuggest-result" data-ii="<%= item.iiCount %>" data-url="<%= item.attributes["data-url"] %>"><a href="<%= item.attributes["data-url"] %>"><span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last"><div class="autosuggest-result-meta"><% if(_.isEqual(item.hasItemPromo,true)){ %><span class="autosuggest-icon-meta"></span><div class="autosuggest-results-meta-info"><% if(_.isEqual(item.hasTBS,true)){ %><span class="autosuggest-results-meta-info-item"><span class="emphasis">Available:</span> Step-by-step Solutions</span><% } %><% if(_.isEqual(item.hasEbook,true)){ %><span class="autosuggest-results-meta-info-item"><%= item.availableEbookText %><% } %><% if(_.isEqual(item.hasInstantAccess,true)){ %><span class="autosuggest-results-meta-info-item"><span class="emphasis">Includes:</span> Free 7-day eTextbook Access</span><% } %></div><% } %></div><div class="autosuggest-result-data"><span class="autosuggest-icon autosuggest-icon-etextbook-sml"></span><span class="img-wrapper icon-dac"></span><div class="autosuggest-result-bookinfo-sizer"><div class="autosuggest-result-bookinfo"><span class="autosuggest-result-title autocomplete-hdr"><%= item.title %></span><span class="autosuggest-result-author"><%= item.author %></span><span class="autosuggest-result-info"><%= item.isbnText %></span></div></div></div></span></span></span></a></li>');
template.course=_.template('<li class="autosuggest-result autosuggest-result-course" data-ii="<%= item.iiCount %>" data-url="<%= item.attributes["data-url"] %>"><a href="<%= item.attributes["data-url"] %>"><span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last"><div class="autosuggest-result-data"><span class="autosuggest-icon autosuggest-icon-course"></span><div class="autosuggest-result-courseinfo"><span class="autosuggest-result-title autocomplete-hdr"><%= item.title %><span class="small"> at <%= item.attributes["data-schoolName"] %></span></span><span class="autosuggest-result-info"><%= item.subtitle %></span></div></div></span></span></span></a></li>');
template.psycic=_.template('<ul><li class="autosuggest-result autosuggest-result-psycic" data-url="topbooks"><a data-reportLink="Top textbooks" href="/psearch/top-textbooks<% if(_.isNumber(schoolInfo.schoolId)){ %>?schoolId=<%= schoolInfo.schoolId %><% } %>"><span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last"><span class="autosuggest-icon autosuggest-icon-textbook"></span>Top Textbooks<% if(!_.isEmpty(schoolInfo.schoolName)){ %> at <%= schoolInfo.schoolName %><% } %></span></span></span></a></li><li class="autosuggest-result autosuggest-result-psycic" data-url="topebooks"><a data-reportLink="Top eTextbooks" href="/psearch/top-etextbooks<% if(_.isNumber(schoolInfo.schoolId)){ %>?schoolId=<%= schoolInfo.schoolId %><% } %>"><span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last"><span class="autosuggest-icon autosuggest-icon-etextbook"></span>Top eTextbooks<% if(!_.isEmpty(schoolInfo.schoolName)){ %> at <%= schoolInfo.schoolName %><% } %></span></span></span></a></li><li class="autosuggest-result autosuggest-result-psycic" data-url="topsolutions"><a data-reportLink="Top textbook solutions" href="/psearch/top-textbooksolutions<% if(_.isNumber(schoolInfo.schoolId)){ %>?schoolId=<%= schoolInfo.schoolId %><% } %>"><span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last"><span class="autosuggest-icon autosuggest-icon-solution"></span>Top Textbook Solutions<% if(!_.isEmpty(schoolInfo.schoolName)){ %> at <%= schoolInfo.schoolName %><% } %></span></span></span></a></li><li class="autosuggest-result autosuggest-result-psycic" data-url="sell-textbooks"><a data-reportLink="Sell textbooks" href="/sell-textbooks" class="psychic-sell-textbooks"><span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last"><span class="autosuggest-icon autosuggest-icon-selltextbooks"></span>Sell your books</span></span></span></a></li></ul>');
template.noresults=_.template('<ul class="autosuggest-no-results"><li class="autosuggest-result autosuggest-result-psycic"><span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last"><div class="autosuggest-result-data"><span class="img-wrapper"></span><div class="autosuggest-result-bookinfo-sizer"><div class="autosuggest-result-bookinfo">No Search Results Were Found.</div></div></div></span></span></span></li></ul>');template.showall=_.template('<div class="autosuggest-morelinks"><ul><li><a href="/search/<% if(!_.isEmpty(schoolInfo.query)){ %><%= schoolInfo.query %><% } %>/books" class="autocomplete-show-more">Search For Books <span>&raquo;</span></a></li><li><a href="/search/<% if(!_.isEmpty(schoolInfo.query)){ %><%= schoolInfo.query %><% } %>/books#p=1&eBook=1" class="autocomplete-show-more">Search For eBooks <span>&raquo;</span></a></li><% if(!_.isEmpty(schoolInfo.schoolName) && _.isNumber(schoolInfo.schoolId)){ %><li><a href="/search/<% if(!_.isEmpty(schoolInfo.query)){ %><%= schoolInfo.query %><% } %>/courses/<%= schoolInfo.schoolName %>#p=1" class="autocomplete-show-more">Search For Courses <span>&raquo;</span></a></li><% } %></ul></div>');
(function(b){C("widget");C.widget.floatingMenu=C.widget._base.extend({construct:function(a){this.opts=b.extend({contentArea:C.dom.$content,fixedClass:null,lastFixTopOffset:0},a);this.elem=a.el.jquery?a.el:b(a.el);this.marginTop=a.marginTop;this.cssPosition=this.elem.css("position");this.cssTop=this.elem.css("top");this.cssWidth=this.elem.width();this.setDiv=b("<div></div>");this.elem.before(this.setDiv);C.dom.$window.observe("scroll",this.doScroll,this);C.dom.$window.observe("resize",this.doScroll,
this);this.doScroll()},doScroll:function(){var a=this.setDiv.offset().top-this.marginTop;if(b(window).scrollTop()>=a){this.elem.css({visibility:"hidden",position:"fixed",top:this.marginTop,"min-width":this.cssWidth});this.opts.fixedClass&&this.elem.addClass(this.opts.fixedClass);var a=this.getContentBottom(),c=this.getElemBottom();this.opts.lastFixTopOffset&&c>=this.opts.lastFixTopOffset?this.elem.css({position:this.cssPosition,top:this.cssTop,"min-width":this.cssWidth}):c>=a&&this.elem.css("top",
this.marginTop-(c-a));this.elem.css("visibility","visible")}else this.opts.fixedClass&&this.elem.removeClass(this.opts.fixedClass),this.elem.css({position:this.cssPosition,top:this.cssTop,"min-width":this.cssWidth})},getContentBottom:function(){var a=this.opts.contentArea;return a.length===0?0:a.offset().top+a.outerHeight()},getElemBottom:function(){return this.elem.length===0?0:this.elem.offset().top+this.elem.outerHeight()+parseFloat(this.elem.css("margin-bottom").replace("px",""))},destruct:function(){this.setDiv.remove()}})})(jQuery);
C("widget");
C.widget.dialog=C.widget._base.extend({construct:function(b){this.opts=$.extend({top:"50",type:"string",content:"",overlay:!0,background:"#000",opacity:0.4,overlayClose:!0,resizeClose:!1,successCallback:null,errorCallback:null,showPaging:!1,pageRightCallback:null,pageLeftCallback:null,contentChangeCallback:null,fixed:!0,afterHideCallback:null,afterHideCallbackContext:null,destroyOnClose:!1,noAutoScroll:!1},b);this.$root=C.dom.$root;this.$window=C.dom.$window;if(this.$root.length&&this.$window.length)this.closeDialog=".chg-dialog-close",
this.isHidden=!0,this.$body=C.dom.$body||null,this.isResizing=!1,this.overlayZIndex=0,this.createOverlay(),this.createDialog(),this.createPagingButtons(),this.doBind(),this.handlingScroll=!1,this.lastScrollTop=null,this.opts.content.length&&(this.opts.type=="ajax"?this.doAjax():this.opts.type=="string"&&this.doString())},createOverlay:function(){this.overlayZIndex=C.utility.getMaxIndex()+1;if(this.opts.overlay)this.$overlay=$('<div style="position:fixed;top:0;left:0;z-index:-1;" id="overlay-'+this.eventNamespace+
'"></div>').appendTo(this.$root).css({background:this.opts.background,opacity:this.opts.opacity}).hide()},createDialog:function(){var b=this.opts.fixed?"fixed":"absolute";this.$dialog=$('<div id="dialog-'+this.eventNamespace+'" class="dialog-widget"></div>').appendTo(this.$root).css({position:b,zIndex:-1,top:"-9999px",left:"-9999px"})},styleDropdown:function(b){this.$dialog.find(b||"select").chosen({disable_search_threshold:8})},createPagingButtons:function(){if(this.opts.showPaging)this.$pageLeft=
this.$pageLeft||$('<div class="dialog-pg-lt-wrap"><button class="dialog-pg-lt" type="button"> </button></div>'),this.$pageRight=this.$pageRight||$('<div class="dialog-pg-rt-wrap"><button class="dialog-pg-rt" type="button"> </button></div>')},positionPagingButtons:function(){if(this.$dialog&&this.opts.showPaging&&(this.$dialog.find(".dialog-pg-lt-wrap").length||(this.$dialog.append(this.$pageLeft),this.$dialog.append(this.$pageRight)),this.$pageLeft&&this.$pageRight))if(this.opts.fixed){var b=($(document).width()-
this.$dialog.width())/2,a=+this.$dialog.outerWidth(),a=b+a;this.$pageLeft.css({left:b-50+"px"});this.$pageRight.css({left:a+"px"})}else b=$(".dialog-pg-lt-wrap"),a=$(".dialog-pg-rt-wrap"),b.css({position:"absolute",top:"100px"}),a.css({position:"absolute",top:"100px"}),this.$pageLeft.css({left:"-50px"}),this.$pageRight.css({right:"-50px"})},showOverLay:function(b){if(this.$overlay){var a=$(document),c=a.width(),a=a.height();this.$overlay.css({width:c+"px",height:a+"px"}).show();this.isHidden=!1;b&&
this.$overlay.css({zIndex:this.overlayZIndex})}},showDialog:function(){var b=$(document).width(),a=this.overlayZIndex+1;this.$dialog.css({top:this.getDialogTopPositionVal()+"px",left:(b-this.$dialog.width())/2+"px",zIndex:a});this.opts.fixed&&this.setMaxDialogContentHeight();this.$dialog.show();this.showOverLay(1);this.isHidden=!1},applySizeChangeAfterHide:function(){var b=$(document),a=b.width(),b=b.height();this.$overlay.css({width:a+"px",height:b+"px"});var b=this.overlayZIndex+1,c=this.getDialogTopPositionVal();
this.$dialog.css({zIndex:b});this.$dialog.css({top:c+"px",left:(a-this.$dialog.width())/2+"px"});this.opts.fixed&&this.setMaxDialogContentHeight();this.positionPagingButtons()},getDialogTopPositionVal:function(){var b=parseInt(this.opts.top,10);this.opts.fixed||(b+=parseInt(C.dom.$window.scrollTop(),10));return b},handleResize:function(){if(this.$dialog&&!this.isResizing)this.isResizing=!0,this.opts.resizeClose?(this.hideDialog(),this.hideOverlay(),this.applySizeChangeAfterHide()):(!this.$overlay&&
this.opts.overlay&&this.createOverlay(),this.$dialog||this.createDialog(),this.isHidden?this.applySizeChangeAfterHide():this.showDialog(),this.positionPagingButtons(),this.isResizing=!1)},setMaxDialogContentHeight:function(){if(this.$dialog){var b=this.$dialog.find(".dialog-hdr"),a=this.$dialog.find(".dialog-ftr"),c=this.$dialog.find(".dialog-content"),b=+b.outerHeight(),a=+a.outerHeight(),a=$(window).height()-2*+this.opts.top-b-a;c.css({"max-height":a+"px","overflow-y":this.opts.noAutoScroll?"":
"auto"})}},doBind:function(){this.$dialog.observe("click",this.closeDialog,this.fireClose,this);this.opts.overlayClose&&this.$overlay.observe("click",this.hide,this);this.$window.observe("resize",this.handleResize,this);this.$window.observe("scroll",this.pagerButtonsHandleScroll,this);this.opts.showPaging&&(this.$pageLeft.observe("click",this.handlePageLeft,this),this.$pageRight.observe("click",this.handlePageRight,this),this.$body&&this.$body.observe("keyup",this.pagingKeyUp,this),C.support.touch&&
this.$dialog.observe("touchend",function(b){this.isHidden||(C.support.util.slideLeft?(this.handlePageRight(),b.preventDefault(),b.stopPropagation()):C.support.util.slideRight&&(this.handlePageLeft(),b.preventDefault(),b.stopPropagation()))},this))},pagerButtonsHandleScroll:function(){if(this.opts.showPaging&&!this.handlingScroll&&!this.opts.fixed)this.handlingScroll=!0,setTimeout($.proxy(function(){var b=$(".dialog-pg-lt-wrap"),a=$(".dialog-pg-rt-wrap"),c=parseInt(b.css("top")),d=parseInt(this.$dialog.css("top"),
10),e=C.dom.$body.scrollTop()-d,f=this.$dialog.outerHeight(),j=f-d-100;if(f<200)this.handlingScroll=!1;else{c=this.lastScrollTop&&e<this.lastScrollTop?c-e:c+e;c>j&&(c=j);if(c<100||C.dom.$body.scrollTop()<d)c=100;this.lastScrollTop=c;b.animate({top:c+"px"},250);a.animate({top:c+"px"},250);var k=this;setTimeout(function(){k.handlingScroll=!1},300)}},this),1E3)},pagingKeyUp:function(b){if(!this.isHidden&&this.$dialog){var a=$(":focus");if(!this.$dialog.find(".mceIframeContainer").length&&!a.is("textarea, input"))return b=
b.which,b===39&&this.handlePageRight(),b===37&&this.handlePageLeft(),!1}},handlePageRight:function(){this.opts.pageRightCallback()},handlePageLeft:function(){this.opts.pageLeftCallback()},disablePaging:function(){this.disablePageLeft();this.disablePageRight()},disablePageLeft:function(){this.$pageLeft&&(this.$pageLeft.find(".dialog-pg-lt").attr("disabled","disabled"),this.$pageLeft.off("click"))},disablePageRight:function(){this.$pageRight&&(this.$pageLeft.find(".dialog-pg-rt").attr("disabled","disabled"),
this.$pageRight.off("click"))},show:function(){this.opts.overlay&&(this.$overlay||this.createOverlay(),this.$overlay.show());this.$dialog||this.createDialog();this.opts.fixed||this.$dialog.css({top:this.getDialogTopPositionVal()+"px"});this.$dialog.show();this.isHidden=!1},fireClose:function(b){b&&b.preventDefault();this.opts.destroyOnClose?this.destroy():(this.hide(),C.dom.$body.trigger("hideModerator"))},hide:function(){this.hideOverlay();this.hideDialog();this.opts.afterHideCallback&&(this.opts.afterHideCallbackContext?
this.opts.afterHideCallback.call(this.opts.afterHideCallbackContext):this.opts.afterHideCallback())},hideOverlay:function(){this.$overlay.hide()},getHiddenValue:function(){return this.isHidden},hideDialog:function(){this.$dialog.hide();this.isHidden=!0},remove:function(){this.$dialog&&this.$dialog.remove();this.$overlay&&this.$overlay.remove()},doAjax:function(){this.$dialog.css({"min-width":"600px"});this.showLoader();$.ajax({url:this.opts.content,context:this,success:this.onAjaxSuccess,error:this.onAjaxError})},
showLoader:function(){this.populateDialog('<canvas class="chg-dialog-spinner" width="40" height="40"><div class="chg-dialog-spinner-fallback"></div></canvas>');this.showDialog();new C.widget.spinner({canvas:".chg-dialog-spinner",color:"#ffffff",spokes:15,thickness:3})},onAjaxSuccess:function(b){this.showLoader();this.populateDialog(b);this.opts.successCallback&&this.opts.successCallback()},populateDialog:function(b){this.$dialog&&(typeof b=="string"?this.$dialog.html(b):(this.$dialog.empty(),this.$dialog.append(b)),
this.opts.showPaging&&this.positionPagingButtons(),this.setMaxDialogContentHeight(),this.onDialogContentChange())},doString:function(){this.populateDialog(this.opts.content);this.showDialog()},onAjaxError:function(){this.opts.errorCallback&&this.opts.errorCallback()},onDialogContentChange:function(){typeof this.opts.onContentChange=="function"&&this.opts.contentChangeCallback()},destruct:function(){C.log("dialog:destruct");this.$overlay.remove();this.$dialog.remove()}});C("widget");
C.widget.popup=C.widget._base.extend({construct:function(b){var a={color:"#fff",borderRadius:"5px",background:"rgba(0,0,0,0.8)",shadow:"rgba(0,0,0,0.25)",borderColor:"transparent"};if(b&&b.opacity&&typeof b.opacity=="number"&&b.opacity<=1)a.background="rgba(0,0,0,"+b.opacity+")";b&&b.template&&(b.template=="gray"?a={color:"#333",borderRadius:"5px",background:"rgba(230,230,230,1)",shadow:"rgba(0,0,0,0.25)",borderColor:"transparent"}:b.template=="white"?a={color:"#000",borderRadius:"5px",background:"#fff",
shadow:"rgba(0,0,0,0.25)",borderColor:"transparent"}:b.template=="header"?a={color:"#666",borderRadius:"0",background:"white",shadow:"rgba(0,0,0,0.25)",borderColor:"#f07d00"}:b.template=="headerGray"&&(a={color:"#666",borderRadius:"0",background:"#f5f5f5",shadow:"rgba(0,0,0,0.25)",borderColor:"#f07d00"}));this.opts=$.extend({className:"popup-widget",padding:"15px",side:"right",width:"auto",height:"auto",margin:5,overhang:15,pointerEdgePadding:15,pointerSize:10,content:"attr",attr:"title",trigger:"hover",
template:null,url:"",method:"get",autoCenter:!1,showDelay:0,hideTimeout:500,resizeClose:!1,needFlush:!0,centerContent:!1,animation:!1},a,b);if(!C.support.rgba)this.opts.color=C.utility.rgba2rgb(this.opts.color),this.opts.background=C.utility.rgba2rgb(this.opts.background),this.opts.shadow=C.utility.rgba2rgb(this.opts.shadow);this.hideTimer=this.delayTimer=null;this.isShowed=!1;this.$el=b.el.jquery?b.el:$(b.el);this.$appendTarget=(this.isHeaderChild=(this.$parentHeaderSelector=this.$el.closest(".chg-header, .chg-hdr-root"))&&
this.$parentHeaderSelector.length)?C.dom.$headerRoot:C.dom.$root;this.createPopup();this.doBind();this.opts.needFlush||this.$container.html(this.opts.content);this.opts.centerContent&&this.$container.css("text-align","center")},setContent:function(b){this.$container.html(b)},destruct:function(){clearTimeout(this.delayTimer);clearTimeout(this.hideTimer);this.$container.length&&this.$container.remove()},createPopup:function(){this.$container=this.$container||$('<div id="popup-'+this.instanceNumber+
'"><div></div></div>').appendTo(this.$appendTarget).children().css({position:"absolute","border-radius":this.opts.borderRadius,"background-color":this.opts.background,padding:this.opts.padding,color:this.opts.color,width:this.opts.width,"z-index":-1,visibility:"hidden",border:"1px solid "+this.opts.borderColor});var b={top:0,right:1,bottom:2,left:3};if(this.opts.borderColor=="transparent"){var a=["transparent","transparent","transparent","transparent"];a[b[this.opts.side]]=this.opts.background;var c=
[this.opts.pointerSize-1,this.opts.pointerSize-1,this.opts.pointerSize-1,this.opts.pointerSize-1];c[b[this.opts.side]]=this.opts.pointerSize;a={width:0,height:0,position:"absolute",borderColor:a.join(" "),borderStyle:"solid",borderWidth:c.join("px ")+"px"};this.$pointer=$("<div></div>").css(a);this.$innerPointer=$("<div></div>")}else a=["transparent","transparent","transparent","transparent"],a[b[this.opts.side]]=this.opts.borderColor,a={width:0,height:0,position:"absolute",borderColor:a.join(" "),
borderStyle:"solid",borderWidth:this.opts.pointerSize},this.$pointer=$("<div></div>").css(a),a=["transparent","transparent","transparent","transparent"],a[b[this.opts.side]]=this.opts.background,a={width:0,height:0,position:"absolute",top:-this.opts.pointerSize+2,left:-this.opts.pointerSize+1,borderColor:a.join(" "),borderStyle:"solid",borderWidth:this.opts.pointerSize-1},this.$innerPointer=$("<div></div>").css(a)},doBind:function(){if(this.opts.trigger=="hover")this.$el.observe({mouseover:this.toggleContainer,
mouseout:this.hidePopup},this),this.$container.observe({mouseover:this.holdContainer,mouseout:this.hidePopup},this);else if(this.opts.trigger=="click"&&(C.dom.$body.observe({click:this.toggleContainer},this.opts.el,this),!this.outsideClickEventHandler))this.outsideClickEventHandler=$("a,div,span,html").on("click",$.proxy(function(){($(".popup-widget:hover").length==0||$(".popup-widget").find("a:hover").length>0)&&this.isShowed&&this.hidePopup()},this));this.opts.resizeClose&&C.dom.$window.observe("resize",
this.hidePopup,this)},holdContainer:function(){clearTimeout(this.hideTimer)},toggleContainer:function(){clearTimeout(this.hideTimer);if(this.isShowed)this.hidePopup();else{var b=this.opts.el.jquery?this.opts.el:$(this.opts.el),a=this.opts.getData?this.opts.getData.call(this,b):this.getData(b),c=this;if(a&&a.length)this.delayTimer=setTimeout(function(){c.showPopup(b,a)},this.opts.showDelay)}},hidePopup:function(){clearTimeout(this.delayTimer);clearTimeout(this.hideTimer);var b=this;this.hideTimer=
setTimeout(function(){b.opts.animation?b.$container.show().fadeOut(function(){b.$container.css({zIndex:-1,visibility:"hidden"})}):b.$container.css({zIndex:-1,visibility:"hidden"})},this.opts.hideTimeout);this.isShowed=!1;$(this.opts.el).removeClass("pop-active")},getData:function(b){var a=this;if(this.opts.content=="attr"){if(this.opts.attr=="title"){if(!this.title)this.title=b.attr(this.opts.attr),b.removeAttr(this.opts.attr);return this.title}return b.attr(this.opts.attr)}else if(this.opts.content==
"ajax")$.ajax({url:this.opts.url,method:this.opts.method,success:function(c){a.showPopup(b,c)}});else return this.opts.content},positionPopup:function(b){var a=b.offset(),c,d,e;this.isHeaderChild&&(a=b.position());this.opts.side=="top"?this.opts.autoCenter?(c=b.outerWidth(),b.outerHeight(),b=this.$container.outerWidth(),e=this.$container.outerHeight(),c={top:a.top-e-this.opts.pointerSize-this.opts.margin,left:a.left+c/2-b/2,"box-shadow":"2px -2px 2px "+this.opts.shadow},e={bottom:this.opts.pointerSize*
-2,left:b/2-this.opts.pointerSize}):(c={top:a.top-this.$container.outerHeight()-this.opts.pointerSize-this.opts.margin,left:a.left-this.opts.overhang,"box-shadow":"2px -2px 2px "+this.opts.shadow},e={bottom:this.opts.pointerSize*-2,left:this.opts.pointerEdgePadding}):this.opts.side=="left"?this.opts.autoCenter?(b.outerWidth(),d=b.outerHeight(),b=this.$container.outerWidth(),e=this.$container.outerHeight(),c={top:a.top+d/2-e/2,left:a.left-b-this.opts.pointerSize-this.opts.margin},e={right:this.opts.pointerSize*
-2,top:e/2-this.opts.pointerSize}):(c={top:a.top-this.opts.overhang,left:a.left-this.$container.outerWidth()-this.opts.pointerSize-this.opts.margin},e={right:this.opts.pointerSize*-2,top:this.opts.pointerEdgePadding}):this.opts.side=="right"?this.opts.autoCenter?(c=b.outerWidth(),d=b.outerHeight(),this.$container.outerWidth(),e=this.$container.outerHeight(),c={top:a.top+d/2-e/2,left:a.left+c+this.opts.pointerSize+this.opts.margin},e={left:this.opts.pointerSize*-2,top:e/2-this.opts.pointerSize}):(c=
{top:a.top-this.opts.overhang,left:a.left+b.outerWidth()+this.opts.pointerSize+this.opts.margin},e={left:this.opts.pointerSize*-2,top:this.opts.pointerEdgePadding}):this.opts.side=="bottom"&&(this.opts.autoCenter?(c=b.outerWidth(),d=b.outerHeight(),b=this.$container.outerWidth(),this.$container.outerHeight(),c={top:a.top+d+this.opts.pointerSize+this.opts.margin,left:a.left+c/2-b/2,"box-shadow":"2px 2px 2px "+this.opts.shadow},e={top:this.opts.pointerSize*-2,left:b/2-this.opts.pointerSize}):(c={top:a.top+
b.outerHeight()+this.opts.pointerSize+this.opts.margin,left:a.left-this.opts.overhang,"box-shadow":"0 2px 2px "+this.opts.shadow},e={top:this.opts.pointerSize*-2,left:this.opts.pointerEdgePadding}));this.$container.css(c);this.$pointer.css(e);this.$container.addClass(this.opts.className)},showPopup:function(b,a){if(a&&a.length)this.opts.needFlush&&this.$container.html(a),this.opts.positionCallback?this.opts.positionCallback.call(this,b):this.positionPopup(b),this.opts.afterInsertCallback&&this.opts.afterInsertCallback.call(this,
b,this.$container),this.$container.append(this.$pointer.append(this.$innerPointer)).css({zIndex:C.utility.getMaxIndex()+1,visibility:"visible"}),this.opts.animation&&this.$container.hide().fadeIn(),this.isShowed=!0,$(this.opts.el).addClass("pop-active")},fadeIn:function(){}});C("ever");C.ever.kv={};C.ever.set=function(b,a){a===void 0||a==="undefined"||(a=$.trim(a),C.ever.setWindow(b,a),C.ever.setLocal(b,a),C.ever.setCookie(b,a),C.ever.kv[b]=a)};
C.ever.get=function(b){var a;a=(a=(a=(a=a||C.ever.getWindow(b))||C.ever.getLocal(b))||C.ever.getCookie(b))||C.ever.kv[b];C.ever.set(b,a);return $.trim(a)};C.ever.setCookie=function(b,a){var c=C.global&&C.global.cookieDomain?";domain="+C.global.cookieDomain:"";document.cookie=b+"=; expires=Mon, 20 Sep 2010 00:00:00 UTC; path=/"+c;document.cookie=b+"="+a+"; expires=Tue, 31 Dec 2050 00:00:00 UTC; path=/"+c};C.ever.getCookie=function(b){return C.ever.getFromSerializedString(document.cookie,";",b,1)};
C.ever.setWindow=function(b,a){window.name=C.ever.getSetIntoSerializedStringResult(window.name,"&",b,a,1)};C.ever.getWindow=function(b){if(window.name)return C.ever.getFromSerializedString(window.name,"&",b,1)};C.ever.setLocal=function(b,a){window.localStorage&&window.localStorage.setItem&&localStorage.setItem(b,a)};C.ever.getLocal=function(b){if(window.localStorage&&window.localStorage.getItem)return localStorage.getItem(b)};
C.ever.getSetIntoSerializedStringResult=function(b,a,c,d,e){c+="=";if(!b.length)return c+(e?escape(d):d);for(var f=0,b=b.split(a),j=0;j<b.length;j++)b[j].indexOf(c)===0&&(b[j]=c+(e?escape(d):d),f=1);f||b.push(c+(e?escape(d):d));return b.join(a)};C.ever.getFromSerializedString=function(b,a,c,d){b=b.split(a);c+="=";for(a=0;a<b.length;a++)if($.trim(b[a]).indexOf(c)===0)return $.trim(d?unescape(b[a].replace(c,"")):b[a].replace(c,""))};
C.dom.$window.bind("beforeunload",function(){for(var b in C.ever.kv)C.ever.set(b,C.ever.kv[b])});C("widget");
C.widget.dropmenu=C.widget._base.extend({construct:function(b){this.opts=$.extend({trigger:".drop-menu-trigger",header:""},b);this.setupDropdownMenu();this.doBaseBind()},destruct:function(){C.dom.$body.unobserve("mousedown."+this.instanceNumber,this);C.dom.$window.unobserve("resize."+this.instanceNumber,this);this.$widget.remove()},setupDropdownMenu:function(){this.$widget=$('<div class="drop-menu-widget"><div class="drop-menu-close"></div><div class="drop-menu-tab"><span>'+this.opts.header+'</span> <b></b></div><div class="drop-menu-content"></div></div>').hide().appendTo(document.body);
this.$close=this.$widget.find(".drop-menu-close");this.$tabText=this.$widget.find(".drop-menu-tab span");this.$content=this.$widget.find(".drop-menu-content");this.setContentAndBind&&this.setContentAndBind()},show:function(b,a){this.$widget.css({top:a,left:b-10}).show()},hide:function(){this.$widget.hide()},doBaseBind:function(){C.dom.$body.observe("mousedown."+this.instanceNumber,this.opts.trigger,this.onClickTrigger,this);C.dom.$window.observe("resize."+this.instanceNumber,this.onScrollOrResize,
this);this.$close.observe("click",this.hide,this)},onScrollOrResize:function(){var b=this;clearTimeout(this.hideTimer);this.hideTimer=setTimeout(function(){b.hide()},0)},onClickTrigger:function(b){var a=$(b.currentTarget),c=a.offset();this.$curTrigger=a;this.show(c.left,c.top,a);b.preventDefault();b.stopPropagation();this.reset&&this.reset(a)}});C("widget");
C.widget.moderator=C.widget.dropmenu.extend({construct:function(b){this.opts=$.extend({trigger:".abuse-flag",header:"Report abuse",maxDescLength:300},b);this.isMod=$(".content-moderation-view").length;this.setupDropdownMenu();this.doBaseBind();this.doBind();this.reset()},reset:function(b){this.$textarea.val("");this.$content.find("input:selected").removeAttr("checked").prop("checked",0);this.onTextboxKeyup();this.$button.removeAttr("disabled","disabled");this.$reportForm.show();this.$reportNotice.hide();
this.arid=this.rid=this.cid=this.aid=this.qid="";if(b&&b.length)this.aid=b.attr("data-answerid")||"",this.qid=b.attr("data-questionid")||"",this.cid=b.attr("data-commentid")||"",this.rid=b.attr("data-ratingid")||"",this.arid=b.attr("data-appratingid")||""},setContentAndBind:function(){this.$content.html(this.getContent());this.$textarea=this.$content.find("textarea");this.$button=this.$content.find("button");this.$wordsLeft=this.$content.find(".words-left");this.$form=this.$content.find("form");this.$reportForm=
this.$content.find(".report-form");this.$reportNotice=this.$content.find(".report-notice")},getContent:function(){var b=this.isMod?"Remove content":"Report Abuse";return'<form onsubmit="return false"><div class="report-reason"><div class="report-form">'+this.getReasons()+'<div class="words-left"></div><textarea name="description" placeholder="Leave a comment (optional)" maxlength="'+this.opts.maxDescLength+'"></textarea><div class="moderator-button"><button class="btn-secondary-dk-mini">'+b+'</button></div></div><div class="report-notice"></div></div></form>'},
getReasons:function(){return function(b){var a="",c="checked",d=0,e;for(e in b)e!="All"&&(a+='<li><input type="radio" '+c+' name="reason" id="reason-'+d+'" value="'+e+'" /><label class="form-radio" for="reason-'+d+'"></label> <label for="reason-'+d+'">'+b[e]+"</label></li>",d++,c="");return"<ul>"+a+"</ul>"}({Adult_Or_Inappropriate:"Adult/Inappropriate",Harassment:"Harassment",Spam:"Spam",Solicitation:"Solicitation",Threats_Or_Violence:"Threats/Violence",Other:"Other"})},wordsLeft:function(){return this.opts.maxDescLength-
this.$textarea.val().length},doBind:function(){this.$button.observe("click",this.onClickSubmit,this);this.$textarea.observe("keyup",this.onTextboxKeyup,this)},onScrollOrResize:function(){var b=this;clearTimeout(this.hideTimer);this.hideTimer=setTimeout(function(){b.hide()},100)},onClickSubmit:function(){var b=this.$widget.find(":checked"),a;if(b.length){if(this.$button.attr("disabled","disabled"),$.ajax({url:"_ajax/hwh/moderate/?token="+C.global.csrfToken+"&aid="+this.aid+"&qid="+this.qid+"&cid="+
this.cid+"&rid="+this.rid+"&arid="+this.arid+"&reason="+b.val()+"&comment="+encodeURIComponent($.trim(this.$textarea.val())),success:$.proxy(function(){this.$reportForm.hide();this.$reportNotice.html('<div class="msg-info-dk-sm"><div class="msg-icon"><div class="msg-text">Success</div></div></div>').show()},this),error:$.proxy(function(){this.$reportForm.hide();this.$reportNotice.html('<div class="msg-info-dk-sm"><div class="msg-icon"><div class="msg-text">We encountered an error. Please try again</div></div></div>').show()},
this)}),this.isMod){a=this.$curTrigger.parents(".question, li").find(".content-moderation").first();var b=a.attr("data-type"),c=a.attr("data-id");a=a.attr("data-extra-id");b={id:c,type:b,token:C.global.csrfToken};if(a)b.id_extra=a;$.ajax({type:"post",dataType:"json",url:"_ajax/hwh/delete",data:b,context:this,success:function(){}})}}else alert("Please select a reason")},onTextboxKeyup:function(){this.$wordsLeft.html(this.wordsLeft()+" left")}});C("utility");
C.utility.profiler=function(){var b=document.location.hostname.indexOf("cheggnet")>0||C.utility.getCookie("logging")!=null,a;return{show:function(){if(b){$(".api-profiler").remove();var c='<div class="api-profiler"><div class="api-profiler-hotspots" onclick="C.utility.profiler.toggleHotspots()">hotspots<br/>OFF</div><div class="api-profiler-timings"><span title="DOM Loading">'+((C.global.domLoading-C.global.navigationStart)/1E3).toFixed(2)+'s</span><br/><span title="DOM Interactive">'+((C.global.domInteractive-
C.global.navigationStart)/1E3).toFixed(2)+'s</span><br/></div><div class="api-profiler-more" style="display: none; background-color: white;" onclick="C.utility.profiler.showStack()"></div></div>';$(c).prependTo(".chg-header-content");var d=function(){if(C.global.domComplete===null)a=setTimeout(d,300);else{var b=C.global.domComplete-C.global.navigationStart,c='<span title="Total Load Time">'+(b/1E3).toFixed(2)+"s</span><br/>";$(c).appendTo(".api-profiler-timings");b>0&&b<2E3?$(".api-profiler-timings").css("background-color",
"#ddffdd"):b==0||b>4500?$(".api-profiler-timings").css("background-color","#ffdddd"):$(".api-profiler-timings").css("background-color","#ffffdd")}};d();c=function(){$.ajax({url:"_ajax/ajaxApiStack?countOnly=1",type:"post",success:function(a){if(a){var b=a.experiment.automation?"Automation":"Normal";$(".api-profiler-more").show().html(a.fail+"/"+(a.fail+a.success)+"<br/>"+b).css("color",a.fail>0?"#cc0000":"")}}})};c();setInterval(c,6E4)}},reset:function(){if(b)clearTimeout(a),C.global.navigationStart=
null,C.global.domLoading=null,C.global.domInteractive=null,C.global.domComplete=null,$(".api-profiler").html('<div class="api-profiler-timings">loading...</div>')},showStack:function(){b&&(console.log("Fetching API calls caused by this page load in the last 10 minutes..."),$.ajax({url:"_ajax/ajaxApiStack",type:"post",success:function(a){console.log(a);C.dom.$window.trigger("apiStackShown",[a])}}))},toggleHotspots:function(){b&&($('.api-profiler-hotspots:contains("ON")').length?($(".api-profiler-hotspots").html("hotspots<br/>OFF"),
$(".chg-tracking-label").remove(),$(".chg-tracking-section").removeClass("chg-tracking-section"),$(".chg-tracking-entity").removeClass("chg-tracking-entity")):($(".api-profiler-hotspots").html("hotspots<br/>ON"),$("[class*=chgsec_]").each(function(a,b){var e=$(b),f=e.attr("class").match(RegExp("(^|\\s)(chgsec_|chgser_|chgsub_)[^ ]*","g"));if(f){e.addClass("chg-tracking-section");var j=e.offset(),f=$('<div class="chg-tracking-label" style="color: red;">'+f.join()+"</div>");e.prepend(f);f.offset(j)}}),
$("[class*=chgent_]").each(function(a,b){var e=$(b),f=e.attr("class").match(RegExp("(^|\\s)(chgent_|chgentid_)[^ ]*","g"));if(f){e.addClass("chg-tracking-entity");var j=e.offset(),f=$('<div class="chg-tracking-label" style="color: blue;">'+f.join()+"</div>");e.prepend(f);f.offset(j)}})))}}}();C("logger");
C.logger=function(){var b=function(a,b){0&&$.ajax({url:"_ajax/log",type:"GET",data:{type:a.type,value:JSON.stringify(a)},success:function(){typeof b==="function"&&b()},error:function(b){C.log(a.type+" log failed with error: "+JSON.stringify(b))}})};return{doEventLog:function(a,c){a.parent_page_url=window.location.href;a.parent_page_timestamp=C.logger.loadTime;a.page_track_id=C.logger.pageTrackId;a.referrer_url=window.location.href;a.destination_url=window.location.href;a.type="event";b(a,
c)},doSessionLog:function(a,c){a.page_track_id=C.logger.pageTrackId;a.destination_url=window.location.href;a.referrer_url=C.logger.referrer_url;a.type="session";b(a,c)}}}();
Eggshell.define("C.common.log",{inputs:["event log","session log","heap track"],outputs:["log success","log error"]},Backbone.View.extend({initialize:function(){Eggshell.find(this).on("event log",this.doEventLog);Eggshell.find(this).on("session log",this.doSessionLog);Eggshell.find(this).on("heap track",this.doHeapTrack)},doEventLog:function(b,a){var c,d;C&&C.logger?(c=C.logger.pageTrackId,d=C.logger.loadTime):(c=mChegg.global.pageTrackId,d=null);if(d!==null)a.parent_page_timestamp=d;a.event_uuid=
"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=Math.random()*16|0;return(a=="x"?b:b&3|8).toString(16)});a.parent_page_url=window.location.href;a.page_track_id=c;a.destination_url=window.location.href;a.referrer_url=window.location.href;a.type="event";this.doLog(a)},doSessionLog:function(b,a){var c,d;C&&C.logger?(c=C.logger.pageTrackId,d=C.logger.referrer_url):(c=mChegg.global.pageTrackId,d=document.referrer);a.page_track_id=c;a.destination_url=window.location.href;a.referrer_url=
d;a.type="session";this.doLog(a)},doLog:function(b){0&&$.ajax({url:"_ajax/log",type:"GET",context:this,data:{type:b.type,value:JSON.stringify(b)},success:function(){Eggshell.find(this).trigger("log success")},error:function(a){Eggshell.find(this).trigger("log error",a)}})},doHeapTrack:function(b,a){window.heap?this.doHeapFire(a):setTimeout($.proxy(function(){this.doHeapTrack(null,a)},this),500)},doHeapFire:function(b){if(b&&b["event.name"]){var a=b["event.name"],c=[],d=!0,e;for(e in b)e==="no.validation"&&
b[e]?d=!1:c[e]=JSON.stringify(b[e]);location.hostname.indexOf("cheggnet")>-1&&d?$.ajax({type:"post",url:"_ajax/odin",data:{url:"/v1/de-event",payload:{schema:"edge",event:JSON.stringify(b)},method:"POST",token:C.global.csrfToken},context:this,success:function(){this.doHeapTrackSuccess(a,c)},error:function(){this.doHeapTrackError(b)}}):this.doHeapTrackSuccess(a,c)}else this.doHeapTrackError(b)},doHeapTrackSuccess:function(b,a){heap.track(b,a);Eggshell.find(this).trigger("log success")},doHeapTrackError:function(b){Eggshell.find(this).trigger("log error");
location.hostname.indexOf("cheggnet")>-1&&$(".chg-content").prepend('<div class="msg-error-lg"><div class="msg-icon"><div class="msg-header">Invalid Event Schema</div><div class="msg-text">'+JSON.stringify(b)+"</div></div></div>")}}));C("facebook");window.fbAsyncInit=function(){return;FB.init({appId:"107051471700",channelUrl:"/channel.php",status:!0,cookie:!0,xfbml:!0,version:"v2.2"});C.facebook.initialized=!0};
C.facebook.queue=function(b,a,c){if(!c)c=location.href;if(a||location.href==c)C.facebook.initialized?b():setTimeout(function(){C.facebook.queue(b,a,c)},500)};(function(b){return; var a=b.getElementsByTagName("script")[0];if(!b.getElementById("facebook-jssdk"))b=b.createElement("script"),b.id="facebook-jssdk",b.async=!0,b.src="//connect.facebook.net/en_US/all.js",a.parentNode.insertBefore(b,a)})(document);C("logs.events");C.logs.events.common={getOnlyEventName:function(b){return{event_name:b}}};
Eggshell.define("C.common.navigation",{inputs:["expand navigation bar","collapse navigation bar","render","refresh left nav","hide group","set left nav type"],outputs:[],singleton:!0,newNode:!1},function(){var b=Backbone.Model.extend({load:function(){$.ajax({url:"_ajax/navigation",type:"post",dataType:"json",data:{},context:this,success:$.proxy(function(a){this.polishResults(a);this.set("originalResult",a);this.trigger("loaded")},this),error:function(){this.trigger("error")}})},polishResults:function(a){var b=
[],d={};$.each(a,function(a,f){typeof f.group!="undefined"&&f.subGroup==null&&(b.push(f),f.group in d||(d[f.group]=[]))});$.each(a,function(a,b){typeof b.group!="undefined"&&b.subGroup!=null&&d[b.group].push(b)});this.set("groups",b);this.set("subGroups",d)},getSubgroup:function(a){var b=this.get("subGroups");return a in b?b[a]:{}}});return Backbone.View.extend({navigationBarCollapsedWidth:50,navigationBarExpandedWidth:210,mainTemplate:_.template('<div class="leftnav"></div>'),linkTemplate:_.template('<%if(link) {%><a href ="<%- link %>" class="<%-classes%>"><% if(newIndicator) { %>\t<span class="global-nav-list-new">NEW</span><% } %><%=text%></a><%} else {%><div class="<%-classes%>"><%=text%></div><%}%>'),
initialize:function(){this.model=new b;this.setListeners();this.load()},setListeners:function(){this.model.on("loaded",this.render,this);this.model.on("errored",this.renderError,this);Eggshell.find(this).on("render",this.load,this).on("expand navigation bar",this.expandNavigationBar,this).on("collapse navigation bar",this.collapseNavigationBar,this).on("refresh left nav",this.load,this)},openOverlayLeftNav:function(){var a=C.utility.getMaxIndex()+1;$(".chg-global-nav").css({width:this.navigationBarExpandedWidth+
"px","z-index":a+1,"box-shadow":"1px 0px 2px #999",overflow:"hidden"});$(".chg-global-nav-home").css({opacity:0,visibility:"hidden"});$(".chg-global-nav-list").css({visibility:"visible",opacity:1});$(".chg-global-screen-blocker").css({"z-index":a,opacity:0.6})},closeOverlayLeftNav:function(){$(".chg-global-nav").css({width:this.navigationBarCollapsedWidth+"px","box-shadow":"none"});$(".chg-global-nav-home").css({opacity:1,visibility:"visible"});$(".chg-global-nav-list").css({visibility:"hidden",opacity:0});
$(".chg-global-screen-blocker").css({"z-index":-1,opacity:0})},expandNavigationBar:function(){this.closeOverlayLeftNav();$(".chg-body").removeClass("chegg-content-nav-collapsed").addClass("chegg-content-nav-expanded");$(".chg-global-nav").css({width:this.navigationBarExpandedWidth+"px"});this.$el.find(".chg-global-nav-home").css({opacity:0,visibility:"hidden"});this.$el.find(".chg-global-nav-list").css({visibility:"visible",opacity:1});$(".chg-global-content").css("margin-left","210px");$(".chg-global-nav").off("mouseover").off("mouseleave")},
collapseNavigationBar:function(){$(".chg-global-content").css("margin-left","50px");$(".chg-body").hasClass("chegg-content-nav-collapsed")?this.closeOverlayLeftNav():($(".chg-body").removeClass("chegg-content-nav-expanded").addClass("chegg-content-nav-collapsed"),$(".chg-global-nav").css({width:this.navigationBarCollapsedWidth+"px"}),this.$el.find(".chg-global-nav-home").css({opacity:1,visibility:"visible"}),this.$el.find(".chg-global-nav-list").css({visibility:"hidden",opacity:0}));$(".chg-global-nav").hasClass("chg-global-nav-autosliding")&&
($(".chg-global-nav").on("mouseover",$.proxy(function(){$(".chg-body").hasClass("chegg-content-nav-collapsed")&&this.openOverlayLeftNav()},this)),$(".chg-global-nav").on("mouseleave",$.proxy(function(){$(".chg-body").hasClass("chegg-content-nav-collapsed")&&this.closeOverlayLeftNav()},this)))},load:function(){this.model.load()},render:function(){$(".chg-global-nav").append(this.$el);this.$el.html(this.mainTemplate());this.renderLeftNav()},renderLeftNav:function(){var a=this.model.get("groups");this.$el.find(".leftnav").append('<a class="chg-global-nav-home" href="/">Home</a>');
this.$el.find(".leftnav").append('<div class="chg-global-nav-list"></div>');this.$el.find(".chg-global-nav-home").css({opacity:0,visibility:"hidden"});$.each(a,$.proxy(function(a,b){this.renderGroup(b)},this))},renderGroup:function(a){var b=$('<div class="'+a.group.replace(" ","-")+'-item"></div>'),d=this.model.getSubgroup(a.group);b.append(this.linkTemplate({link:a.link?a.link:!1,classes:(a.classes?a.classes:"")+" chg-global-nav-list-section",text:a.group,newIndicator:a.newIndicator}));d.length>
0&&(b.append('<div class="'+a.group.replace(" ","-")+'-subgroup-items"></div>'),$.each(d,$.proxy(function(e,d){var j=d.link?d.link:"#",k=d.classes?d.classes+" chg-global-nav-list-item":" chg-global-nav-list-item";b.find("."+a.group.replace(" ","-")+"-subgroup-items").append(this.linkTemplate({link:j,classes:k,text:d.subGroup,newIndicator:d.newIndicator}))},this)));this.$el.find(".chg-global-nav-list").append(b)}})}());
Eggshell.define("C.global.nav",{inputs:["expand navigation bar","collapse navigation bar","enable fixed header","disable fixed header"],outputs:["returned fixed header content node"],singleton:!0,newNode:!1},function(){var b=C.View.extend({navigationBarCollapsedWidth:50,navigationBarExpandedWidth:210,initialize:function(){this.setNavigationBarTopOffset(0);this.fixPosition(!0);this.collapseNavigationBar();$(".chg-global-nav a").on("click",function(){$(".chg-global-nav").off("mouseover");$(".chg-global-nav").off("mouseleave")});
$(".chg-global-nav a").on("touchstart",function(){$(".chg-global-nav").off("mouseover");$(".chg-global-nav").off("mouseleave")});$(".chg-global-nav a.track-nav-solutions").click(function(a){a.preventDefault();a.stopPropagation();a=$(".glass-container .tbs-tab");a.length!==0?a.trigger("click"):Eggshell.create("C.common.tbspopup").trigger("show tbs popup")}).attr("data-noajax","data-noajax").attr("data-noredirect","data-noredirect");$(".chg-global-nav a.track-nav-qna").click(function(a){a.preventDefault();
a.stopPropagation();var b=$(".glass-container .qna-tab");b.length!==0?b.trigger("click"):C.utility.navigate($(a.target).attr("href"))}).attr("data-noajax","data-noajax").attr("data-noredirect","data-noredirect");$(".chg-global-nav a.track-nav-live-tutors").click(function(a){a.preventDefault();a.stopPropagation();a=$(".glass-container .tutors-tab");a.length!==0?a.trigger("click"):C.global.instaEdu&&C.utility.navigate("/tutors/online-now/Chegg-GPA")}).attr("data-noajax","data-noajax").attr("data-noredirect",
"data-noredirect")},isNavigationBar:function(){return $(".chg-body").hasClass("no-nav")||$(".chg-global-nav-list").length===0?!1:!0},slideOutNavigationBar:function(){var a=C.utility.getMaxIndex()+1;$(".chg-global-nav").css({width:this.navigationBarExpandedWidth+"px","z-index":a+1,"box-shadow":"1px 0px 2px #999",overflow:"hidden"});$(".chg-global-nav-home").css({opacity:0,visibility:"hidden"});$(".chg-global-nav-list").css({visibility:"visible",opacity:1});$(".chg-global-screen-blocker").css({"z-index":a,
opacity:0.6})},slideBackNavigationBar:function(){$(".chg-global-nav").css({width:this.navigationBarCollapsedWidth+"px","box-shadow":"none"});$(".chg-global-nav-home").css({opacity:1,visibility:"visible"});$(".chg-global-nav-list").css({visibility:"hidden",opacity:0});$(".chg-global-screen-blocker").css({"z-index":-1,opacity:0})},expandNavigationBar:function(){this.isNavigationBar()&&(this.slideBackNavigationBar(),$(".chg-body").removeClass("chegg-content-nav-collapsed").addClass("chegg-content-nav-expanded"),
$(".chg-global-nav").css({width:this.navigationBarExpandedWidth+"px"}),$(".chg-global-nav-home").css({opacity:0,visibility:"hidden"}),$(".chg-global-nav-list").css({visibility:"visible",opacity:1}),$(".chg-global-content").css("margin-left","210px"),$(".chg-global-nav").off("mouseover").off("mouseleave"))},collapseNavigationBar:function(){this.isNavigationBar()&&($(".center-content").length==0&&$(".chg-global-content").css("margin-left","50px"),$(".chg-body").hasClass("chegg-content-nav-collapsed")?
this.slideBackNavigationBar():($(".chg-body").removeClass("chegg-content-nav-expanded").addClass("chegg-content-nav-collapsed"),$(".chg-global-nav").css({width:this.navigationBarCollapsedWidth+"px"}),$(".chg-global-nav-home").css({opacity:1,visibility:"visible"}),$(".chg-global-nav-list").css({visibility:"hidden",opacity:0})),$(".chg-global-nav").hasClass("chg-global-nav-autosliding")&&($(".chg-global-nav").on("mouseover",$.proxy(function(){$(".chg-body").hasClass("chegg-content-nav-collapsed")&&
this.slideOutNavigationBar()},this)),$(".chg-global-nav").on("mouseleave",$.proxy(function(){$(".chg-body").hasClass("chegg-content-nav-collapsed")&&this.slideBackNavigationBar()},this))))},setNavigationBarTopOffset:function(a){$(".chg-global-nav-home").css({top:87+a+"px"});$(".chg-global-nav-list").css({top:90+a+"px"})},fixPosition:function(a){a?$(".chg-global-nav, .chg-global-nav-home, .chg-global-nav-list").css({position:"fixed"}):$(".chg-global-nav, .chg-global-nav-home, .chg-global-nav-list").css({position:"absolute"})}}),
a=C.View.extend({height:100,initialize:function(){this.$globalHeader=$(".chg-header");this.$fixedHeader=$("<div></div>");this.scrollDetector=Eggshell.create("C.Eggshell.window.scroll.tracker");this.fixedHeaderVisibleCallback=this.options.fixedHeaderVisibleCallback;this.render();Eggshell.immuneToDestroyAll(this.scrollDetector)},render:function(){this.$fixedHeader.addClass("chg-fixed-header").css({height:"0px","z-index":C.utility.getMaxIndex()}).insertAfter($(".chg-header"))},fadeInFixedHeader:function(){this.$fixedHeader.css({height:this.height+
"px",position:"fixed",top:"0px"});this.fixedHeaderVisibleCallback&&typeof this.fixedHeaderVisibleCallback=="function"&&this.fixedHeaderVisibleCallback(this.height)},fadeOutFixedHeader:function(){this.$fixedHeader.css({height:"0px",position:"absolute",top:"50px"});this.fixedHeaderVisibleCallback&&typeof this.fixedHeaderVisibleCallback=="function"&&this.fixedHeaderVisibleCallback(0)},handleFixedHeaderScrolledEvent:function(){$("body").scrollTop()>=50?this.fadeInFixedHeader():this.fadeOutFixedHeader()},
enableFixedHeader:function(a){a?(this.$globalHeader.css({position:"absolute"}),this.scrollDetector.on("scrolled",this.handleFixedHeaderScrolledEvent,this),$("body").scrollTop()>=50&&this.fadeInFixedHeader()):(this.$globalHeader.css({position:"fixed"}),this.fadeOutFixedHeader(),this.scrollDetector.off("scrolled",this.handleFixedHeaderScrolledEvent,this))}});$(".chg-nav-v2").length>0?(this.navigationBar=Eggshell.create("C.common.navigation"),Eggshell.immuneToDestroyAll(this.navigationBar),b=Eggshell.find(this),
Eggshell.connect(b,"expand navigation bar",this.navigationBar,"expand navigation bar").connect(b,"collapse navigation bar",this.navigationBar,"collapse navigation bar")):(this.navigationBar=new b,this.header=new a({fixedHeaderVisibleCallback:$.proxy(function(a){a==0?(this.navigationBar.setNavigationBarTopOffset(0),this.navigationBar.fixPosition(!1)):(this.navigationBar.setNavigationBarTopOffset(a-50),this.navigationBar.fixPosition(!0))},this)}),Eggshell.find(this).on("expand navigation bar",this.navigationBar.expandNavigationBar,
this.navigationBar).on("collapse navigation bar",this.navigationBar.collapseNavigationBar,this.navigationBar).on("enable fixed header",function(){this.header.enableFixedHeader(!0);this.navigationBar.fixPosition(!1)}).on("disable fixed header",function(){this.header.enableFixedHeader(!1);this.navigationBar.fixPosition(!0)}))});Eggshell.immuneToDestroyAll(Eggshell.create("C.global.nav"));C("logs.events");
C.logs.events.my=function(){return{onLoad:function(b){return{event_name:"on_load_person_overview",school_id:b.schoolId,question_for_me_ids:b.questions_for_me_ids.join("+"),qa_ids:b.qa_ids.join("+"),notes_ids:b.notes_ids.join("+")}}}}();
try{var CRITEO=function(){function b(){var a=o[3].charAt(0);return typeof a!="undefined"&&a==1}function a(){var a=o[3].charAt(1);return typeof a!="undefined"&&a==1}function c(){var a=o[3].charAt(2);return!A&&typeof a!="undefined"&&a==1}function d(){var a=(document.location.protocol=="https:"&&"https:"||"http:")+"//dis.",b="";typeof o[2]!="undefined"&&o[2]!=""&&(b=o[2],b.charAt(b.length-1)!="."&&(b+="."));return a+b+"criteo.com/dis/dis.aspx"}function e(){for(var a="",b=u&&u.length||0,c=o[4],e=1,d=
0;d<b;d++)for(var f=0;f<c.length;f++){e>1&&(a+="&");var g;var j=u[d],k=e;g=c[f];var l=z[j.pageType];if(l){var q=o[5],r="",p="";for(name in q)if(j.hasOwnProperty(name)){var h=q[name][0],A=q[name][1],t=q[name][2],y="";if(y=typeof j[name]=="function"?j[name]():j[name])switch(A){case 0:p+="&"+h+"="+y;break;case 1:var B;typeof y==="string"?B=y.split(j.delimiter):Object.prototype.toString.apply(y)==="[object Array]"&&(B=y);A=B.length;typeof t!="undefined"&&A>t&&(A=t);for(t=1;t<=A;t++)p+="&"+h+t+"="+B[t-
1];break;case 2:r+="&"+h+"="+encodeURIComponent(y)}}var j="t"+k+"="+l.eventType+"&p"+k+"=",k=encodeURIComponent,q=l.params+"&wi=",m;b:switch(l.eventType){case "sendEvent":m=g[0];break b;case "transaction":m=g[1]}g=j+k(q+m+p)+r}else g=void 0;a+=g;e++}return a}function f(){var a=d()+"?p="+o[0]+"&cb="+Math.floor(Math.random()*99999999999);try{a+="&ref="+encodeURIComponent(document.referrer)}catch(b){}try{a+="&sc_r="+encodeURIComponent(screen.width+"x"+screen.height)}catch(c){}try{a+="&sc_d="+encodeURIComponent(screen.colorDepth)}catch(e){}return a.substring(0,
2E3)}function j(){var a=d()+"?p="+o[0];a+="&"+e();a+="&cb="+Math.floor(Math.random()*99999999999);try{a+="&ref="+encodeURIComponent(document.referrer)}catch(b){}try{a+="&sc_r="+encodeURIComponent(screen.width+"x"+screen.height)}catch(c){}try{a+="&sc_d="+encodeURIComponent(screen.colorDepth)}catch(f){}return a.substring(0,2E3)}function k(a){if(window.addEventListener)window.addEventListener("load",a,!1);else if(window.attachEvent)window.attachEvent("onload",a);else{var b=window.onload;window.onload=
function(){if(b&&typeof b.fired=="undefined")b.fired=!0,b();a()}}}function l(){var a=[];if(b()){if(document.createElement){var c=document.createElement("iframe");if(c)c.width="1px",c.height="1px",c.style.display="none",c.src=j();a.push(c)}}else{if(c=document.createElement("img"))c.width="1px",c.height="1px",c.style.display="none",c.src=(document.location.protocol=="https:"?"https://sslwidget.":"http://widget.")+"criteo.com/"+o[1]+"/display.js?resptype=gif&"+e();var d=document.createElement("iframe");
if(d)d.width="1px",d.height="1px",d.style.display="none",d.src=f(),c.onload=function(){r(d)};a.push(c)}return a}function q(){for(var a=l(),b=0;b<a.length;b++)r(a[b])}function r(a){var b;if(c())b=document.getElementById("cto_mg_div");else{b=document.getElementsByTagName("body");if(!b||b.length==0)return;b=b[0]}b!=null&&b.appendChild&&b.appendChild(a)}function g(){a()?k(function(){q()}):q()}var o,u,p=!1,A=!1,z={home:{eventType:"sendEvent",params:"v=2&pt1=0&pt2=1"},product:{eventType:"sendEvent",params:"v=2&pt1=2"},
list:{eventType:"sendEvent",params:"v=2&pt1=3"},basket:{eventType:"transaction",params:"v=2&s=0"},confirmation:{eventType:"transaction",params:"v=2&s=1"},search:{eventType:"sendEvent",params:"v=2&pt1=4"}};return{Load:function(a){typeof CRITEO_CONF=="undefined"||p||(p=!0,A=a,o=CRITEO_CONF[1],u=CRITEO_CONF[0],c()&&document.write("<div id='cto_mg_div' style='display:none;'></div>"),g())}}}()}catch(err$$3){}CRITEO.Load(!0);C("logs.events");
C.logs.events.qa=function(){return{onLoadMyQuestions:function(b){var a=[],b=b.questions_for_me,c;for(c in b)a.push(b[c].id);return{event_name:"on_load_my_questions",questions_for_me_ids:a.join("+")}},onLoadTextbooksQA:function(b){var a=[],c;for(c in b.questions)a.push(b.questions[c].id);return{event_name:"on_load_textbooks_questions",question_ids:a.join("+"),book_id:b.book_id}},onQuestionClick:function(b,a,c){return{event_name:"on_click_question",pcscrumb:c,qid:b}},onClickAnswer:function(b){return{event_name:"on_submit_answer",
qid:b}},onSubmitQuestion:function(b){b=b.response;return{event_name:"on_submit_ask_question",question_id:b.id,is_anonymous:b.anonymous,course_id:null!==b.questionCourse?b.questionCourse.id:null}},onClickSeeAllQA:function(){return C.logs.events.common.getOnlyEventName("on_click_see_all_qa")},onClickQuestionsTab:function(b,a){var c=[],d="";a=="asked"?d="on_click_asked_questions":a=="answered"&&(d="on_click_answered_questions");for(var e in b)null!==b[e]&&c.push(b[e].id);return{event_name:d,ids:c.join("+")}},
onClickHWHSubscribe:function(b,a){return{event_name:"on_click_hwh_subscribe",id:typeof a==="undefined"?null:a}},onClickInstantQuestion:function(b){return{event_name:"on_click_instant_question",question_id:b}}}}();C("logs.events");
C.logs.events.books=function(){return{onClickSeeAllBooks:function(){return C.logs.events.common.getOnlyEventName("on_click_see_all_books")},onClickAddBooks:function(){return C.logs.events.common.getOnlyEventName("on_click_add_books")},onLoadCoursesBooks:function(b){return{event_name:"on_load_courses_books",required_isbns:b.required.join("+"),recommended_isbns:b.recommended.join("+")}},onToggleCheckBoxForCart:function(b){var a=$(b).is(":checked"),b=$(b).attr("id").split("include")[1];return a?{event_name:"on_check_book_for_add_to_cart",
isbn:b}:{event_name:"on_uncheck_book_for_add_to_cart",isbn:b}},onClickAddToCart:function(b){return{event_name:"on_add_to_cart",isbns:b.isbns.join("+"),list_price:b.list_price,total_price:b.total_price}},onLoadPersonBooks:function(b){var a=b.userBooks,b=b.orderedBooks,c=[],d=[];if(null!=a)for(var e in a)if(a[e].no)for(var f in a[e].no)c.push(a[e].no[f]);if(null!=b)for(e in b)b[e]&&d.push(b[e].ean);return{event_name:"on_load_person_books",books_for_me_ids:c.join("+"),books_i_have_ids:d.join("+")}}}}();
C("logs.events");C.logs.events.notes=function(){return{onClickSeeAllNotes:function(){return C.logs.events.common.getOnlyEventName("on_click_see_all_notes")}}}();C("logs.events");
C.logs.events.course=function(){var b=function(a){return{event_name:a,schPrefix:this.schPrefix,schoolId:this.schoolId,subjCode:this.subjCode,subject:this.subject,term:this.term,year:this.year}};return{onLoadCoursesCourse:function(a){return{event_name:"on_load_courses_course",question_ids:a.questionIds.join("+"),review_ids:a.reviewIds.join("+"),is_planned:a.statusInfo.is_planned?1:0,is_rated:a.statusInfo.is_rated?1:0,current_term:a.studentInfo.term,student_count:a.studentInfo.count}},onClickIAmInThisCourse:function(a){return b.call(a,
"on_click_i_am_in_this_course")},onClickRateThisCourse:function(a){return b.call(a,"on_click_rate_this_course")},onClickSeeAllInfoReviews:function(){return C.logs.events.common.getOnlyEventName("on_click_see_all_info_reviews")},onClickSeeAllStudents:function(){return C.logs.events.common.getOnlyEventName("on_click_see_all_students")},onClickWriteReview:function(){return C.logs.events.common.getOnlyEventName("on_click_write_a_review")},onSubmitRateCourse:function(a){return{event_name:"on_submit_rate_course",
school:a.school,subject:a.subject,code:a.code,rating:a.currentRating,grade:a.currentGrade,year:a.currentYear,term:a.currentTerm}},onLoadCoursesQuestions:function(a){return{event_name:"on_load_courses_questions",school_id:a.course.schoolId,course_number:a.course.catalogNumber,subject_code:a.course.subjectCode,year:a.course.academicYear}}}}();C("logs.events");
C.logs.events.schedule=function(){return{onLoadSuccess:function(b){var a=[],c;for(c in b.courses)a.push({term:b.courses[c].academicTerm,year:b.courses[c].academicYear,catalogNumber:b.courses[c].catalogNumber,subjectCode:b.courses[c].subjectCode,schoolId:b.courses[c].schoolId});return{event_name:"on_load_person_schedule",course_info:JSON.stringify(a)}},onClickAddCourse:function(b){return{event_name:"on_click_add_course",catalog_number:b.code,school_id:b.school,subject:b.subject,term:b.term,year:b.year}}}}();
C("logs.events");
C.logs.events.home=function(){var b=function(a){var b=[];if(null!==a)for(var d in a){var e=d,f=[],j;for(j in a[d].books)f.push(a[d].books[j].isbn);b.push({info:e,isbns:f.join("+")})}return b};return{onLoad:function(a){return{event_name:"on_load_home",courses_info:JSON.stringify(b(a.courses)),school_name:a.user_info.school,school_id:a.user_info.schoolId,term:a.user_info.term,year:a.user_info.year}},onSubmitAddRemoveCourse:function(a,b){return{event_name:b=="add"?"on_submit_add_course":"on_submit_remove_course",
subject:a.subject,code:a.code,term:a.term,year:a.year,school:a.school}},OnHoverCourseItem:function(a,b){var d={event_name:b=="info"?"on_hover_course_info":"on_hover_course_book",year:a.year,term:a.term,code:a.code,subject:a.subject};return b=="book"?$.extend(d,{isbn:a.isbn}):d},onClickInfoLink:function(a,b){return{event_name:b,id:a}},onClickSeeMoreCourses:function(a){return{event_name:"on_click_see_course_info",school:a.school,subject:a.subject,code:a.code}}}}();C("logs.events");
C.logs.events.solution=function(){return{onLoadBookSolutions:function(b){return{event_name:"on_load_books_solution",isbn:b.isbn,problem_id:b.vmJson.problemId,solution_id:b.vmJson.solutionId}},onClickHWHSubscribe:function(b,a){return{event_name:"on_click_HWH_subscribe",isbn:b,solution_id:a}}}}();C("tou");
C.tou.model=C.Model.extend({objName:"C.tou.model",initialize:function(){},fetch:function(){$.ajax({context:this,type:"post",dataType:"json",url:"_ajax/tou",success:function(b){this.set({version:b.version});this.trigger("fetch:success")}})},submit:function(){$.ajax({context:this,type:"post",dataType:"json",url:"_ajax/tou/accept",data:{token:C.global.csrfToken},success:function(){this.trigger("submit:success")}})}});
C.tou.view=C.View.extend({objName:"C.tou.view",className:"tou clearfix",tmplMessage:_.template('<div class="dialog-4"><div class="dialog-hdr"><h2 class="dialog-title">Terms of Use and Privacy Policy</h2><div class="dialog-close-wrapper"><button class="btn-secondary-sm ok-button"><span class="icn-cross">Close</span> </button></div></div><div class="dialog-content"><p>Please accept the Terms of Use and Privacy Policy to continue.</p><p>Click Logout to sign out of Chegg.</p></div><div class="dialog-ftr"><button class="tou-logout-button btn-secondary-sm">Logout</button><button class="ok-button btn-secondary-sm">Ok</button></div></div>'),events:{"click .cancel-button":"onClickCancel",
"click .tou-close":"onClickCancel","click .continue-button":"onClickContinue","change #tou-agree":"onAgreeChange"},initialize:function(){this.model.on("destroy",this.destroy,this);this.model.on("submit:success",this.destroy,this);this.on("successClick",this.destroy,this);this.on("destroyClick",this.destroy,this);this.model.on("fetch:success",this.render,this)},render:function(){if($("div.dialog-widget").length>0&&$("div.tou").length>0)return C.log("tou found"),!0;var b=this.model.toJSON().version;
this.termsDialog=Eggshell.create("C.common.dialog");this.termsDialog.trigger("set headline","Terms of Use and Privacy Policy").trigger("hide sub headline").trigger("hide icon").trigger("hide close button",!0).trigger("enable default control").trigger("set primary button","I accept").trigger("set secondary button","I do not accept").trigger("set content html",'<div class="placeholder-content">'+b+"</div>").on("primary button clicked",$.proxy(function(){this.model.submit()},this)).on("secondary button clicked",
$.proxy(function(){this.termsDialog.trigger("hide");this.destroy();this.onClickLogout()},this));this.$el.append(this.termsDialog);this.showDialog();return this},destroy:function(){this.remove();this.dialog&&this.dialog.destroy();this.message&&this.message.destroy();this.termsDialog.trigger("hide")},showDialog:function(){this.dialog=new C.widget.dialog({content:this.$el,overlayClose:!1,fixed:!1});this.termsDialog.trigger("show")},showMessage:function(){this.message=new C.widget.dialog({content:$(this.tmplMessage()),
overlayClose:!1,fixed:!1,opacity:0});$(".ok-button").click(_.bind(this.onClickOk,this));$(".tou-logout-button").click(_.bind(this.onClickLogout,this))},onClickContinue:function(b){b.preventDefault();this.$("#tou-agree").is(":checked")?(this.model.submit(),this.trigger("successClick")):this.showMessage()},onClickCancel:function(b){b.preventDefault();this.showMessage()},onClickOk:function(b){b.preventDefault();this.message&&this.message.destroy()},onClickLogout:function(b){b&&b.preventDefault();this.message&&
this.message.destroy();window.location.href="/signout?token="+C.global.csrfToken},onAgreeChange:function(b){$(b.target).is(":checked")?$(".continue-button").removeAttr("disabled"):$(".continue-button").attr("disabled","disabled")}});
Eggshell.define("C.common.beacon",{inputs:["enable","disable","send beacon request"],outputs:[],singleton:!0},C.Model.extend({enabled:!0,queue:[],locked:!1,initialize:function(){Eggshell.find(this).on("send beacon request",this.add,this).on("enabled",this.enable).on("disable",this.disable)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},fire:function(){if(!(this.locked===!0||this.queue.length===0)){this.locked=!0;var b=this.queue.shift();C.global.beacon!=!0?(this.locked=!1,
this.fire()):$.cjax({context:this,url:"_ajax/odin",dataType:"json",type:"POST",cache:!1,data:{url:"/v1/stream-event",method:"POST",token:C.global.csrfToken,payload:JSON.stringify({impressionId:b.impressionId,eventTargetId:b.eventTargetId,eventType:b.eventType,tracker:C.utility.dataLogger()})},always:function(){this.locked=!1;this.fire()}})}},add:function(b,a){if(typeof a=="undefined"||a===null)throw"Empty payload";if(!a.impressionId)throw"Empty impression id";if(!a.eventTargetId)throw"Empty event target id";
if(!a.eventType)throw"Empty event type";this.queue.push($.extend({},a));this.fire()}}));
Eggshell.define("C.Eggshell.tabs",{inputs:["build tabs"],outputs:["tab switch"],newNode:!1},Backbone.View.extend({counter:0,firstel:0,loadFlag:!1,initialize:function(b){this.loadFlag=!0;this.options=$.extend({activeTabIsLink:!1,useAlwaysHash:!1,needHashTag:!0},b);Eggshell.find(this).on("build tabs",this.buildTabs).on("view tab",this.activateTab)},events:{"click .tab-nav":"switchTab"},generateUniqueId:function(){return this.$el.attr("id")+"-"+this.counter++},activateTab:function(b,a){this.$(".tab-nav[data-anchor="+
a+"]").click()},switchTab:function(b){var a=$(b.target);$(b.target).attr("data-anchor")===void 0&&$(b.target).parents(".tab-nav").attr("data-anchor")!==void 0&&(a=$(b.target).parents(".tab-nav"));if(a.hasClass("selected")&&!this.options.activeTabIsLink)return!1;else{this.loadFlag=!1;this.$(".tab-nav").removeClass("selected");this.$(".tab-content").removeClass("selected");b=a.attr("id");a.addClass("selected");this.$("#"+b+"-content").addClass("selected");if(this.options.needHashTag)window.location.hash=
b!=this.firstel||this.options.useAlwaysHash?a.attr("data-anchor"):"";this.Eggshell.trigger("tab switch",{type:a.attr("data-anchor"),id:b});return!0}},buildTabs:function(){for(var b="",a=this.$(".tab-nav"),c=this.$(".tab-content"),d=0;d<a.length;d++){var e=$(a.get(d)),f=$(c.get(d)),j=this.generateUniqueId();e.attr("id",j);f.attr("id",j+"-content");f=e.attr("data-anchor");(typeof f==="undefined"||f===!1)&&e.attr("data-anchor",j+"-anchor");window.location.hash=="#"+e.attr("data-anchor")&&(b=e)}this.firstel=
$(a.get(0)).attr("id");b==""?this.loadFlag||$(a.get(0)).click():$(b).click()}}));
Eggshell.define("C.Eggshell.window.resize.tracker",{inputs:{"trigger resize":{payload:null}},outputs:["resize"],singleton:!0},function(){this.resize=function(){var b=$(window).width(),a=$(window).height();if(!this.viewportWidth||!this.viewportHeight||!(this.viewportWidth==b&&this.viewportHeight==a))this.viewportWidth=b,this.viewportHeight=a,this.Eggshell.trigger("resize",{width:b,height:a})};$(window).on("resize",$.proxy(function(){this.resize()},this));Eggshell.find(this).on("trigger resize",function(){this.resize()},
this)});C.resource.add("C.Eggshell.dialog.close.title","Close");
Eggshell.define("C.Eggshell.dialog",{inputs:["set id","set headline","set sub headline","set icon","set icon size","set content html","set content component","get content area","destroy content","set control","get control area","show","hide","show headline","hide headline","show sub headline","hide sub headline","show icon","hide icon","enable default control","show control","set primary button","set secondary button","set link","show primary button","hide primary button","disable primary button",
"enable primary button","show secondary button","hide secondary button","disable secondary button","enable secondary button","show link","hide link","hide control","enable screen blocker click","disable screen blocker click","disable default padding"],outputs:["content component created","content area","control component created","control area","shown","hidden","headline clicked","sub headline clicked","icon clicked","close button clicked","screen blocker clicked","primary button clicked","secondary button clicked",
"link clicked","content clicked"]},C.View.extend({componentNS:null,controlNS:null,template:_.template('<div class="dialog"><div class="header"><div class="close" title="<%- closeTitle %>"></div><div class="icon"></div><h3 class="headline"></h3><p class="subHeadline"></p></div><div class="content"></div><div class="control disabled"></div></div><div class="screenBlocker"></div>'),initialize:function(){console.log("This component will be deprecated.  Instead use C.commom.dialog");this.render();this.setuplistens();
this.Eggshell.on("destroy",this.destroy)},destroy:function(){this.hide();this.destroyContent();this.destroyControl()},render:function(){this.$el.empty();this.$el.html(this.template({closeTitle:C.resource.fetch("C.Eggshell.dialog.close.title")}));this.$el.hide();this.$(".screenBlocker").css("z-index",C.utility.getMaxIndex());this.$(".dialog").css("z-index",C.utility.getMaxIndex()+1)},events:{"click .close":"closeOnClick","click .screenBlocker":"screenBlockerOnClick","click .headline":"headlineOnClick",
"click .subHeadline":"subHeadlineOnClick","click .icon":"iconOnClick","click .content":"contentOnClick"},setuplistens:function(){this.Eggshell.on("set id",function(a,b){if(!b&&typeof b!=="id")throw"Invalid id";this.$(".dialog").attr("id",b)}).on("set headline",function(a,b){if(!b&&typeof b!=="string")throw"Invalid headline";this.$(".headline").html(b)}).on("set sub headline",function(a,b){if(!b&&typeof b!=="string")throw"Invalid sub headline";this.$(".subHeadline").html(b)}).on("set icon",function(a,
b){if(!b&&typeof b!=="string")throw"Invalid icon class name";this.$(".icon").addClass(b)}).on("set icon size",function(a,b){if(!b||typeof b!=="string"||b!=="small"&&b!=="large")throw"Invalid icon size";this.$(".icon").removeClass("small").removeClass("large");this.$(".icon").addClass(b)}).on("set content html",function(a,b){if(!b&&typeof b!=="string")throw"Invalid content html";this.destroyContent();this.$(".content").html(b)}).on("set content component",function(a,b){if(!b&&typeof b!=="string")throw"Invalid content component constructor";
this.destroyContent();this.componentNS=Eggshell.create(b,$.extend({},this.$(".content")));this.Eggshell.trigger("content component created",this.componentNS)}).on("get content area",function(){this.Eggshell.trigger("content area",$.extend({},this.$(".content")))}).on("destroy content",function(){this.destroyContent()}).on("set control",function(a,b){if(!b&&typeof b!=="string")throw"Invalid control constructor";this.destroyControl();this.controlNS=Eggshell.create(b,{el:$.extend({},this.$(".control"))});
this.$(".control").show().removeClass("disabled");this.Eggshell.trigger("control component created",this.controlNS)}).on("get control area",function(){this.Eggshell.trigger("control area",$.extend({},this.$(".control")))}).on("show",function(){this.show()}).on("hide",function(){this.hide()}).on("show headline",function(){this.$(".headline").show()}).on("hide headline",function(){this.$(".headline").hide()}).on("show sub headline",function(){this.$(".subHeadline").show()}).on("hide sub headline",function(){this.$(".subHeadline").hide()}).on("show icon",
function(){this.$(".icon").show()}).on("hide icon",function(){this.$(".icon").hide()}).on("show control",function(){this.$(".control").show().removeClass("disabled")}).on("hide control",function(){this.$(".control").hide().addClass("disabled")}).on("disable screen blocker click",function(){this.screenBlockerClickEnabled=!1}).on("enable screen blocker click",function(){this.screenBlockerClickEnabled=!0}).on("disable default padding",function(){this.$(".dialog").addClass("no-padding")}).on("enable default control",
function(a,b){if(!b&&typeof b!=="boolean")throw"Invalid control enable flag";this.$(".control").show().removeClass("disabled");this.destroyControl();this.controlNS=Eggshell.create("C.Eggshell.dialog.control.standard",{el:$.extend({},this.$(".control"))});Eggshell.connect(this.Eggshell.getNamespace(),"set primary button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"set secondary button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"set link",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),
"show primary button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"hide primary button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"disable primary button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"enable primary button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"show secondary button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"hide secondary button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),
"disable secondary button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"enable secondary button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"set text below button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"show text below button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"hide text below button",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"show link",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),
"hide link",this.controlNS);Eggshell.connect(this.Eggshell.getNamespace(),"enable screen blocker",this.controlNS);Eggshell.connect(this.controlNS,"primary button clicked",this.Eggshell.getNamespace());Eggshell.connect(this.controlNS,"secondary button clicked",this.Eggshell.getNamespace());Eggshell.connect(this.controlNS,"link clicked",this.Eggshell.getNamespace());this.controlNS.trigger("show")});var b=Eggshell.create("C.Eggshell.window.resize.tracker");Eggshell.on(b,"resize",$.proxy(this.resize,
this))},resize:function(){this.$(".dialog").height();var b=$(window).height(),b=parseInt(b-2*this.$(".dialog").css("top").replace("px","")),a=this.$(".header").height(),c=this.$(".control").height();a&&(b-=a);c&&(b-=c,a=parseInt(this.$(".control").css("margin-top").replace("px")),b-=a);this.$(".control").css("margin-top")&&(b-=parseInt(this.$(".control").css("margin-top").replace("px")));(a=this.$(".dialog").css("padding"))||(a=this.$(".dialog").css("padding-top"));a&&(b-=2*parseInt(a.replace("px")));
b<=0&&(b=0);this.$(".content").css("max-height",b)},show:function(){this.resizable=!0;this.lockViewport();this.$el.show();this.$(".dialog").show();this.resize();this.$(".dialog").hide();this.$(".dialog").fadeIn(300,$.proxy(function(){this.Eggshell.trigger("shown");this.resize()},this))},hide:function(){this.resizable=!1;this.$(".dialog").fadeOut(300,$.proxy(function(){this.unlockViewport();this.$el.hide();this.Eggshell.trigger("hidden")},this))},lockViewport:function(){$("html, body").css({overflow:"hidden"})},
unlockViewport:function(){$("html, body").css({overflow:"visible"})},destroyContent:function(){this.componentNS&&Eggshell.destroy(this.componentNS);this.$(".content").html("")},destroyControl:function(){this.controlNS&&Eggshell.destroy(this.controlNS);this.$(".control").html("")},closeOnClick:function(b){b.preventDefault();b.stopPropagation();this.Eggshell.trigger("close button clicked");this.hide()},screenBlockerOnClick:function(){this.screenBlockerClickEnabled!==!1&&(this.Eggshell.trigger("screen blocker clicked"),
this.hide())},headlineOnClick:function(){this.Eggshell.trigger("headline clicked")},subHeadlineOnClick:function(){this.Eggshell.trigger("sub headline clicked")},iconOnClick:function(){this.Eggshell.trigger("icon clicked")},contentOnClick:function(b){this.Eggshell.trigger("content clicked",b)}}));
Eggshell.define("C.Eggshell.dialog.control.standard",{inputs:["set primary button","set secondary button","set link","set link url","set hint","set text below button","show primary button","hide primary button","enable primary button","disable primary button","focus on primary button","show secondary button","hide secondary button","enable secondary button","disable secondary button","show link","hide link","show hint","hide hint","show text below button","hide text below button"],outputs:["primary button clicked",
"secondary button clicked","link clicked"]},Backbone.View.extend({template:_.template('<span class="control-standard-hint"></span><div class="main-button">   <button class="primary btn-primary-sm"></button>   <div class="text-below-button"></div></div><button class="secondary btn-secondary-sm"></button><a></a>'),initialize:function(){this.bindEvents();this.render()},render:function(){this.$el.empty();this.$el.html(this.template());Eggshell.find(this).trigger("hide secondary button");Eggshell.find(this).trigger("hide hint");
Eggshell.find(this).trigger("hide text below button")},events:{"click .primary":"clickPrimary","click .secondary":"clickSecondary","click a":"linkOnClick"},bindEvents:function(){var b=Eggshell.find(this).on("set primary button",function(a,c){if(typeof c!="string"||!$.trim(c))throw"Invalid primary button text";this.$(".primary").html(c).attr("title",c);b.trigger("show primary button")}).on("set secondary button",function(a,c){if(typeof c!="string"||!$.trim(c))throw"Invalid secondary button text";this.$(".secondary").html(c).attr("title",
c);b.trigger("show secondary button")}).on("set link",function(a,b){if(typeof b!="string"||!$.trim(b))throw"Invalid link text";this.$("a").html(b).attr("title",b)}).on("set link url",function(a,c){if(typeof c!="string"||!$.trim(c))throw"Invalid link url";this.$("a").attr("href",c);b.trigger("show link")}).on("set text below button",function(a,c){if(!c&&typeof c!=="string")throw"Invalid text type";this.$(".text-below-button").html(c);b.trigger("show text below button")}).on("set hint",function(a,c){if(!c&&
typeof c!=="string")throw"Invalid text type";this.$(".control-standard-hint").html(c);b.trigger("show hint")}).on("show primary button",function(){this.$(".primary").show()}).on("hide primary button",function(){this.$(".primary").hide()}).on("enable primary button",function(){this.$(".primary").removeAttr("disabled")}).on("disable primary button",function(){this.$(".primary").attr("disabled","disabled")}).on("focus on primary button",function(){this.$(".primary").focus()}).on("show secondary button",
function(){this.$(".secondary").show()}).on("hide secondary button",function(){this.$(".secondary").hide()}).on("enable secondary button",function(){this.$(".secondary").removeAttr("disabled")}).on("disable secondary button",function(){this.$(".secondary").attr("disabled","disabled")}).on("show link",function(){this.$("a").show()}).on("hide link",function(){this.$("a").hide()}).on("show text below button",function(){this.$(".text-below-button").show()}).on("hide text below button",function(){this.$(".text-below-button").hide()}).on("show hint",
function(){this.$(".control-standard-hint").show()}).on("hide hint",function(){this.$(".control-standard-hint").hide()})},clickPrimary:function(){this.Eggshell.trigger("primary button clicked")},clickSecondary:function(){this.Eggshell.trigger("secondary button clicked")},linkOnClick:function(){this.Eggshell.trigger("link clicked")}}));C.resource.add("C.Eggshell.viewfullsite.button.text","View mobile site &raquo;");
Eggshell.define("C.eggshell.viewfullsite.button",{inputs:["show","hide","view mobile site button clicked"],outputs:[]},C.View.extend({events:{"click .view-full-site-button":"viewMobileSiteButtonClicked"},initialize:function(){this.Eggshell.listen("show",function(){this.$el.show()},this);this.Eggshell.listen("hide",function(){this.$el.hide()},this);this.Eggshell.listen("view mobile site button clicked",function(){var b=""+window.location;C.utility.setCookie("NO_MDT",0,-1E3);b.indexOf("no_mobile=1")>
-1?window.location=b.replace(/(\?|&)no_mobile=1&?/,function(a,b){return b=="?"?"?":""}):C.utility.refresh()},this);this.render()},viewMobileSiteButtonTemplate:_.template('<div class="view-full-site-button"><span><%= text %></span></div>'),render:function(){this.$el.html(this.viewMobileSiteButtonTemplate({text:C.resource.fetch("C.Eggshell.viewfullsite.button.text")}))},viewMobileSiteButtonClicked:function(){this.Eggshell.trigger("view mobile site button clicked")}}));
Eggshell.define("C.common.marker",{inputs:["show marker"],outputs:[],newNode:!1},function(b){var a=b.id,c=b.component,b=b.component;b!=null&&typeof b=="string"?c=$("#"+C.factory.createSafeCssName(b)):b!=null&&typeof b=="object"&&typeof b.getNamespace=="function"&&(c=$("#"+C.factory.createSafeCssName(b.getNamespace())));if(!a)throw"Invalid automation marker ID";if(!c||!c.jquery)throw'Automation marker "'+a+'" error: invalid node';if(c.length==0)throw'Automation marker "'+a+'" error: node is no longer available';
if(c.length>1)throw'Automation marker "'+a+'" error: cannot mark more than one node';this.showMarker=function(){c.addClass("C-test-"+C.factory.createSafeCssName(a))};Eggshell.find(this).on("show marker",this.showMarker);this.showMarker()});C("global").profile&&console.profileEnd();
(function(b){Eggshell.define("C.common.avatar",{inputs:["set avatar id","update avatar image url","update avatar image url with matching id","set size","set shape","set border","set avatar link url"],outputs:["rendered"]},function(a){this.id=null;this.$el=a.el;this.$el.addClass("medium");this.$el.append(b("<img>"));this.$el.hide();this.setSize=function(a,b){this.$el.removeClass("xsmall small medium large xlarge").addClass(b);this.resizeImage()};this.setShape=function(a,b){this.$el.removeClass("circle square").addClass(b)};
this.enableBorder=function(a,b){b?this.$el.addClass("border"):this.$el.removeClass("border")};this.setUserId=function(a,b){this.id=b};this.resizeImage=function(){var a=b("img",this.$el);if(a.naturalWidth()>0&&a.naturalHeight()>0)this.onLoadImage();else a.on("load",b.proxy(this.onLoadImage,this))};this.onLoadImage=function(){var a=b("img",this.$el),d=a.naturalWidth(),e=a.naturalHeight(),f=this.$el.width(),j=this.$el.height();d>e?(f=j*d/e,d=(f-j)/2,a.css({position:"relative","max-width":"none",width:(f/
j*100).toFixed(0)+"%",left:"-"+d.toFixed(1)+"px"})):d<e&&(j=f*e/d,d=(j-f)/2,a.css({position:"relative","max-height":"none",height:(j/f*100).toFixed(0)+"%",top:"-"+d.toFixed(1)+"px"}))};this.updateImageUrl=function(a,d){this.resizeImage();b("img",this.$el).attr("src",d);this.$el.show()};this.updateImageUrlWithMatchingId=function(a,b){var e=b.id,f=b.image;e?e==this.id&&this.updateImageUrl(null,f):this.updateImageUrl(null,f)};this.setLinkUrl=function(a,d){var e=b("img",this.$el);e.remove();b("<a></a>").attr("href",
d).append(e).appendTo(this.$el)};Eggshell.find(this).on("set avatar id",this.setUserId).on("set size",this.setSize).on("set shape",this.setShape).on("set border",this.enableBorder).on("set avatar link url",this.setLinkUrl).on("update avatar image url",this.updateImageUrl).on("update avatar image url with matching id",this.updateImageUrlWithMatchingId)})})(window.Zepto||window.jQuery);
(function(b){function a(a){var b=new Image;b.src=a;return b}function c(){console.warn("naturalWidth: no image have been passed");return 0}"naturalWidth"in new Image?(b.fn.naturalWidth=function(){return!this.length?c():this[0].naturalWidth},b.fn.naturalHeight=function(){return!this.length?c():this[0].naturalHeight}):(b.fn.naturalWidth=function(){return!this.length?c():a(this[0].src).width},b.fn.naturalHeight=function(){return!this.length?c():a(this[0].src).height})})(window.Zepto||window.jQuery);
C.resource.add("C.common.autosuggest.placeholder","Begin your search");C.resource.add("C.common.autosuggest.close","Close");C.resource.add("C.common.autosuggest.submit","Submit");C.resource.add("C.common.autosuggest.sellyourbooks","Sell your books");C.resource.add("C.common.autosuggest.at","at ");C.resource.add("C.common.autosuggest.toptextbooks","Top Textbooks ");C.resource.add("C.common.autosuggest.topetextbooks","Top eTextbooks ");C.resource.add("C.common.autosuggest.topsolutions","Top Textbook Solutions ");
C.resource.add("C.common.autosuggest.searchtextbooks","Search For Books");C.resource.add("C.common.autosuggest.searchebooks","Search For eBooks");C.resource.add("C.common.autosuggest.searchcourses","Search For Courses");C.resource.add("C.common.autosuggest.noresultsfound","No results found for");C.resource.add("C.common.autosuggest.didyoumean","Did you mean");C.resource.add("C.common.autosuggest.globalsearchheader","Search for a book or course");
Eggshell.define("C.common.autosuggestPreResults",{inputs:["set pre results","get pre results","prefetch pre-results data","force prefetch pre-results data","set last visited pdp","change selection","update school"],outputs:["return pre results"]},function(){var b=C.Model.extend({initialize:function(){this.set("schoolInfo",{});this.set("gid",C.utility.getCookie("gid"));this.evaluateSchoolData(this.gid);this.loadLastVisitedPdp()},evaluateSchoolData:function(){this.set("savedId",C.utility.getLocal("schoolId"));
this.set("savedName",C.utility.getLocal("schoolName"));if(!this.get("gid"))return!1;if(this.get("gid")&&this.get("savedId")&&this.get("savedName")&&this.get("gid")==this.get("savedId"))return this.set("schoolInfo",{schoolName:this.get("savedName"),schoolId:this.get("savedId")}),this.trigger("render"),!0;else this.getSchool(this.get("gid"))},getSchool:function(a){var b=this;$.ajax({type:"GET",url:"_ajax/school/info",data:{school:a},success:$.proxy(function(a){a=a.schoolInfo;C.utility.setLocal("schoolId",
a.schoolId);C.utility.setLocal("schoolName",a.nickname?a.nickname:a.longName);b.set("schoolInfo",{schoolName:a.nickname?a.nickname:a.longName,schoolId:a.schoolId});this.trigger("render");return!0},this),error:function(){return!1}})},forceFetchPreResultsData:function(){C.global.userUuid&&(Eggshell.find("C.eggshell.component.ajax.client").trigger("flush all"),this.fetchPreResultsData())},fetchPreResultsData:function(){C.global.userUuid&&$.cjax({type:"post",url:"_ajax/autocomplete/preresults",context:this,
data:{token:C.global.csrfToken},success:$.proxy(function(a){this.set("courses",a.courses);this.trigger("preResultsDataFetched")},this)})},setLastVisitedPdp:function(a){C.utility.setLocal("C.common.autosuggestPreResults.pdp",a,2592E6)},loadLastVisitedPdp:function(){this.set("pdp",C.utility.getLocal("C.common.autosuggestPreResults.pdp"))}});return C.View.extend({model:new b,template:_.template('<li class="result pre-result" data-url="/psearch/top-textbooks?schoolId=<%= schoolInfo.schoolId %>"><% if(typeof(schoolInfo)!= "undefined" && typeof(schoolInfo.schoolName)!= "undefined"){ %><a href="/psearch/top-textbooks?schoolId=<%= schoolInfo.schoolId %>"><% } else { %><a href="/psearch/top-textbooks"><% } %><span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last"><span class="autosuggest-icon autosuggest-icon-textbook"></span><%- text.toptextbooks %><% if(typeof(schoolInfo)!= "undefined" && typeof(schoolInfo.schoolName)!= "undefined" && schoolInfo.schoolName != null){ %> <%- text.at %> <%= schoolInfo.schoolName %> <% } %></span></span></span></a></li><li class="result pre-result" data-url="/psearch/top-etextbooks?schoolId=<%= schoolInfo.schoolId %>"><% if(typeof(schoolInfo)!= "undefined" && typeof(schoolInfo.schoolName)!= "undefined"){ %><a href="/psearch/top-etextbooks?schoolId=<%= schoolInfo.schoolId %>"><% } else { %><a href="/psearch/top-etextbooks"><% } %><span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last"><span class="autosuggest-icon autosuggest-icon-etextbook"></span><%- text.topetextbooks %><% if(typeof(schoolInfo)!= "undefined" && typeof(schoolInfo.schoolName)!= "undefined" && schoolInfo.schoolName != null){ %> <%- text.at %> <%= schoolInfo.schoolName %> <% } %></span></span></span></a></li><li class="result pre-result" data-url="/psearch/top-textbooksolutions?schoolId=<%= schoolInfo.schoolId %>"><% if(typeof(schoolInfo)!= "undefined" && typeof(schoolInfo.schoolName)!= "undefined"){ %><a href="/psearch/top-textbooksolutions?schoolId=<%= schoolInfo.schoolId %>"><% } else { %><a href="/psearch/top-textbooksolutions"><% } %><span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last"><span class="autosuggest-icon autosuggest-icon-solution"></span><%- text.topsolutions %><% if(typeof(schoolInfo)!= "undefined"  && typeof(schoolInfo.schoolName)!= "undefined" && schoolInfo.schoolName != null){ %> <%- text.at %> <%= schoolInfo.schoolName %> <% } %></span></span></span></a></li><li class="result pre-result" data-url="/sell-textbooks"><a href="/sell-textbooks" class="psychic-sell-textbooks"><span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last"><span class="autosuggest-icon autosuggest-icon-selltextbooks"></span><%- text.sellbooks %></span></span></span></a></li>'),
courseTemplate:_.template('<li class="result pre-result pre-result-course" data-url="/courses/<%- school %>/<%- subject %>/<%- code %>"><a href="/courses/<%- school %>/<%- subject %>/<%- code %>"<span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last"><span class="autosuggest-pre-result-course"><span class="autosuggest-icon autosuggest-icon-pre-result-course"></span><span class="autosuggest-pre-result-course-info"><span class="header"><%- subject %> <%- code %></span><span class="subheader"><%- title %></span></span><span class="autosuggest-pre-result-course-meta"><span class="autosuggest-pre-result-course-meta-stars"></span><span class="autosuggest-pre-result-course-meta-ratings"><% if(ratings == 1) { print(ratings + " rating ");} else { print(ratings + " ratings "); } %></span><span class="autosuggest-pre-result-course-meta-dot">.</span><span class="autosuggest-pre-result-course-meta-reviews"><% if(reviews == 1) { print(reviews + " review ");} else { print(reviews + " reviews "); } %></span></span></span></span></span></span></a></li>'),
pdpTemplate:_.template('<li class="result pre-result pre-result-pdp" data-url="<%- url %>"><a href="<%- url %>"><span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last"><span class="autosuggest-icon autosuggest-icon-pdp"></span><span class="autosuggest-pre-results-pdp"><span class="autosuggest-pre-results-pdp-header">Recently viewed book: </span><span class="autosuggest-pre-results-pdp-subheader"><%= bookTitle %></span></span></span></span></span></a></li>'),
initialize:function(){this.model.fetchPreResultsData();this.model.loadLastVisitedPdp();this.GAclient=Eggshell.create("C.report.GA");this.registerListeners();this.on("render",this.render());Eggshell.find(this).on("prefetch pre-results data",function(){this.model.fetchPreResultsData();this.model.on("preResultsDataFetched",function(){Eggshell.find(this).destroy()},this)}).on("force prefetch pre-results data",function(){this.model.forceFetchPreResultsData();this.model.on("preResultsDataFetched",function(){Eggshell.find(this).destroy()},
this)}).on("set last visited pdp",function(a,b){this.model.setLastVisitedPdp(b)}).on("change selection",this.changeSelection)},events:{"click a":"getLink",keypress:"onKeyDown"},render:function(){var a=this.model.get("schoolInfo"),b={sellbooks:C.resource.fetch("C.common.autosuggest.sellyourbooks"),toptextbooks:C.resource.fetch("C.common.autosuggest.toptextbooks"),topetextbooks:C.resource.fetch("C.common.autosuggest.topetextbooks"),topsolutions:C.resource.fetch("C.common.autosuggest.topsolutions"),
at:C.resource.fetch("C.common.autosuggest.at")};this.$el.empty().html(this.template({schoolInfo:a,text:b}));if(this.model.get("courses")){this.courseRatingComponents=[];a=this.model.get("courses").slice(0);a.reverse();for(b=0;b<a.length;b++){var d=a[b],e=$(this.courseTemplate({school:d.prefix,subject:d.subjectCode,code:d.catalogNumber,title:d.title,ratings:d.numberOfRatings,reviews:d.reviews})).attr("data-pos",b).insertBefore($(this.$("li").get(0)));!d.reviews&&!d.numberOfRatings?($(".autosuggest-pre-result-course-meta",
e).hide(),this.courseRatingComponents[b]=null):(d=Eggshell.create("C.common.rating",{el:$(".autosuggest-pre-result-course-meta-stars",e)}).trigger("set rating",Math.round(d.avgRating)).trigger("set large version").trigger("enable interaction",!1).trigger("set non-interactable star color","gray"),this.courseRatingComponents[b]=d)}}this.model.get("pdp")&&(a=this.model.get("pdp"),b=$(this.pdpTemplate({bookTitle:a.bookTitle,url:a.bookUrl})).insertBefore($(this.$("li").get(0))),Eggshell.create("C.common.bookcover",
{el:$(".autosuggest-icon",b)}).trigger("set book image",a.bookImg).trigger("turn off shadow"))},registerListeners:function(){this.Eggshell.listen("get pre results",function(){this.Eggshell.trigger("return pre results",$.extend({},this.$(".pre-results")))});this.Eggshell.listen("set pre results",function(a,b){this.template.html(b)});this.Eggshell.listen("update school",function(){this.model.set("gid",C.utility.getCookie("gid"));this.model.evaluateSchoolData(C.utility.getCookie("gid"))})},getLink:function(a){a.preventDefault();
a.stopPropagation();var b=$(a.currentTarget).find("span.col-12").html().replace(/(<([^>]+)>)/ig,"");$(a.currentTarget).parent().hasClass("pre-result-pdp")?this.GAclient.trigger("report custom event",{page:"Header",section:"Psychic search",link:"Recently viewed book"}):$(a.currentTarget).parent().hasClass("pre-result-course")?this.GAclient.trigger("report custom event",{page:"Header",section:"Psychic search",link:"My course"}):this.GAclient.trigger("report custom event",{page:"Header",section:"Psychic search",
link:b});C.utility.navigate(a.currentTarget.href)},onKeyDown:function(){},changeSelection:function(){if(this.courseRatingComponents){for(var a=this.$("li.selected"),b=0;b<this.courseRatingComponents.length;b++)this.courseRatingComponents[b]&&this.courseRatingComponents[b].trigger("set non-interactable star color","gray");a.attr("data-pos")&&(a=a.attr("data-pos"),this.courseRatingComponents[a]&&this.courseRatingComponents[a].trigger("set non-interactable star color","yellow"))}}})}());
Eggshell.define("C.common.autosuggestContextualContent",{inputs:["set contextual content","get contextual content"],outputs:["return contextual content"]},function(){var b=C.Model.extend({initialize:function(){this.set("schoolInfo",{});this.set("searchTerm",null);this.set("gid",C.utility.getCookie("gid"));this.evaluateSchoolData(this.gid)},evaluateSchoolData:function(){if(!this.get("gid"))return!1;this.set("savedId",C.utility.getLocal("schoolId"));this.set("savedName",C.utility.getLocal("schoolName"));
if(this.get("gid")&&this.get("savedId")&&this.get("savedName")&&this.get("gid")==this.get("savedId"))return this.set("schoolInfo",{schoolName:this.get("savedName"),schoolId:this.get("savedId")}),this.trigger("render"),!0;else this.getSchool(this.get("gid"))},getSchool:function(a){var b=this;$.ajax({type:"GET",dataType:"json",url:"_ajax/school/info",data:{school:a},success:$.proxy(function(a){a=a.schoolInfo;C.utility.setLocal("schoolId",a.schoolId);C.utility.setLocal("schoolName",a.nickname?a.nickname:
a.longName);b.set("schoolInfo",{schoolName:a.nickname?a.nickname:a.longName,schoolId:a.schoolId});this.trigger("render");return!0},this),error:function(){return!1}})}});return C.View.extend({model:new b,template:_.template('<ul class="contextualContent"><li><a href="/search/<%- search %>/books" class="autocomplete-show-more"><%- text.searchtextbooks %><span></span></a></li><li><a href="/search/<%- search %>/books#p=1&amp;eBook=1" class="autocomplete-show-more"><%- text.searchebooks %><span></span></a></li><li><a href="/search/<%- search %>/courses/<%- schoolInfo.schoolName %>#p=1" class="autocomplete-show-more"><%- text.searchcourses %><span></span></a></li></ul>'),
initialize:function(){this.registerListeners();this.on("render",this.render())},events:{"click a":"getLink",keypress:"onKeyDown"},render:function(){var a=this.model.get("schoolInfo"),b={searchtextbooks:C.resource.fetch("C.common.autosuggest.searchtextbooks"),searchebooks:C.resource.fetch("C.common.autosuggest.searchebooks"),searchcourses:C.resource.fetch("C.common.autosuggest.searchcourses")};this.$el.html(this.template({schoolInfo:a,text:b,search:this.model.get("searchTerm")}))},registerListeners:function(){this.Eggshell.listen("get contextual content",
function(){this.render()});this.Eggshell.listen("set contextual content",function(a,b){this.model.set("searchTerm",b)})},getLink:function(a){a.preventDefault();a.stopPropagation();C.utility.navigate(a.currentTarget.href)},onKeyDown:function(){}})}());
Eggshell.defineInterface("C.common.autosuggest.interface",{inputs:["render","set sohp autosuggest","set full width","set result type","set pre results","set pre results last visited pdp","force prefetch pre-results data","set min chars","set first result","set last result","set no results override","set contextual content","set callback","set placeholder text","set value","set render as form","set input field class","set submit button class","set submit button text","set tracking","enable global session tracking",
"suppress result meta","suppress icons","set max majors","set max schools","delegate mouse over selection event","set disabled items","add disabled items","remove disabled items","disable ajax loader","focus on search input","hide results","inline submit button","disable input field","enable input field"],outputs:["rendered","rendered pre results","rendered results","rendered contextual content","rendered no results","search input focused","search input blurred","clicked result","autosuggest clicked",
"callback fired","autosuggest form submitted"]});
Eggshell.define("C.common.autosuggest",{"interface":"C.common.autosuggest.interface"},function(){var b=C.Model.extend({initialize:function(){this.set("minChars",3);this.set("placeholderText",C.resource.fetch("C.common.autosuggest.placeholder"));this.set("submitButtonText",C.resource.fetch("C.common.autosuggest.submit"));this.set("firstResult",null);this.set("lastResult",null);this.set("contextualContent",null);this.set("fullWidth",!1);this.set("preResultSet",null);this.set("lastQuery",null);this.set("renderAsForm",
!1);this.set("submitButtonClass","btn-flat-sm");this.set("inputFieldClass","form-input-sm");this.set("delay",200);this.set("results",null);this.set("globalSessionTracking",!1);this.set("track",null);this.set("selectedResult",null);this.set("callback",null);this.set("resultContainerHeight",0);this.set("loadingIndicatorVisible",!1);this.set("suppressMeta",!1);this.set("maxMajors",null);this.set("maxSchools",null);this.set("suppressIcons",!1);this.set("disableAjaxLoader",!1);this.set("preResultVisible",
!1);this.set("sohpAutosuggest",!1);this.set("hideResultsOnReload",!1);this.set("disabledItems",[])},preGetResults:function(a){clearTimeout(this.ajaxTimeout);var b=this;this.ajaxTimeout=setTimeout(function(){b.getResults(a)},this.delay)},getResults:function(a){this.trigger("showLoadingIndicator");$.ajax({url:"_ajax/autocomplete"+a,dataType:"json",context:this,success:function(a){a&&a[0]?(this.set("results",$.extend({},a[0].items)),this.trigger("processSuccessResponse")):(this.set("results",null),
this.trigger("processErrorResponse"));this.trigger("hideLoadingIndicator")},error:function(){this.set("results",null);this.trigger("processErrorResponse");this.trigger("hideLoadingIndicator")}})}}),a=C.View.extend({initialize:function(){this.render()},render:function(){this.hightLightText(this.model.attributes);var a=this.model.attributes.itemType;switch(a){case "book":var b=this.model.attributes.subtitle?c_common_result_3_lines(this.model.attributes):c_common_result_2_lines(this.model.attributes);
break;case "dac":b=this.model.attributes.subtitle?c_common_result_3_lines(this.model.attributes):c_common_result_2_lines(this.model.attributes);break;case "ebook":b=this.model.attributes.subtitle?c_common_result_3_lines(this.model.attributes):c_common_result_2_lines(this.model.attributes);break;case "course":b=c_common_result_course(this.model.attributes);break;case "major":b=c_common_result_major(this.model.attributes);break;case "careerInterest":b=c_common_result_careerInterest(this.model.attributes);
break;case "academicInterest":b=c_common_result_academicInterest(this.model.attributes);break;case "school":case "allschools":b=c_common_result_school(this.model.attributes);break;case "highschools":b=c_common_result_school(this.model.attributes);break;case "lastItemLink":b=c_common_result_last_link(this.model.attributes);break;default:b=this.model.attributes.subtitle?c_common_result_3_lines(this.model.attributes):c_common_result_2_lines(this.model.attributes)}b=this.options.fullWidth?c_common_result_container_full({attributes:this.model.attributes,
result:b}):c_common_result_container({attributes:this.model.attributes,result:b});this.$el.attr("data-url",this.model.attributes["data-url"]);this.$el.attr("data-ii",this.model.attributes["data-ii"]);this.options.suppressIcon==!0&&this.$el.addClass("suppress-icon");this.model.attributes.itemType=="lastItemLink"&&this.$el.addClass("last-item-link");this.$el.html(b);(a=="book"||a=="dac"||a=="ebook")&&Eggshell.create("C.common.bookcover",{el:this.$el.find(".book-cover-container")}).trigger("set book image",
this.model.attributes.img.url).trigger("turn off shadow").trigger("set book alt",this.model.attributes.img.alt)},events:{mousedown:"doClick"},doClick:function(a){if($(a.target).closest("li").hasClass("autosuggest-disabled-item"))return a.preventDefault(),a.stopPropagation(),!1;this.options.eggshell.trigger("autosuggest form submitted");this.options.callback&&(a.preventDefault(),a.stopPropagation(),this.options.eggshell.trigger("callback fired",this.model),this.options.eggshell.trigger("autosuggest clicked",
this.model.toJSON()))},hightLightText:function(){var a=RegExp("("+this.regExpQuote(this.options.val)+")","i"),b=$("<div/>").html(this.model.get("header")).text();this.model.get("header")&&this.model.set("header",b.replace(a,'<span class="chg-suggest-term">$1</span>'));this.model.get("subHeader")&&this.model.set("subHeader",this.model.get("subHeader").replace(a,'<span class="chg-suggest-term">$1</span>'));this.model.get("detail")&&this.model.set("detail",this.model.get("detail").replace(a,'<span class="chg-suggest-term">$1</span>'))},
regExpQuote:function(a){return(a+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}}),c=C.Model.extend({initialize:function(){this.bulletSeperatorHTML="&nbsp;&bull;&nbsp;";this.on("change",this.transformData())},defaults:{header:null,subHeader:!1,detail:null,img:{alt:null,url:null},itemType:null,school:null,"data-url":null,"data-ii":null},transformData:function(){switch(this.get("itemType")){case "book":var a=this.get("title")+(this.get("editionNo")?' <span class="this-header-small">('+this.toOrdinal(this.get("editionNo"))+
" Edition)</span>":""),b=$.extend({},this.get("itemPromo"));this.set("header",a);this.set("subHeader",this.get("subtitle")?this.get("subtitle"):!1);this.set("detail",this.get("author")+this.bulletSeperatorHTML+this.buildISBNText(this));this.set("img",this.get("img"));this.set("itemType",this.get("itemType"));this.set("school",null);this.set("meta",this.buildBookPromoContent(b));this.set("data-url",this.get("attributes")["data-url"]);break;case "ebook":a=this.get("title")+(this.get("editionNo")?' <span class="this-header-small">('+
this.toOrdinal(this.get("editionNo"))+" Edition)</span>":"");b=$.extend({},this.get("itemPromo"));b.isEbook=!0;this.set("header",a);this.set("subHeader",this.get("subtitle")?this.get("subtitle"):!1);this.set("detail",this.get("author")+this.bulletSeperatorHTML+this.buildISBNText(this));this.set("img",this.get("img"));this.set("itemType",this.get("itemType"));this.set("school",null);this.set("meta",this.buildBookPromoContent(b));this.set("data-url",this.get("attributes")["data-url"]);break;case "dac":a=
this.get("title")+(this.get("editionNo")?' <span class="this-header-small">('+this.toOrdinal(this.get("editionNo"))+" Edition)</span>":"");b=$.extend({},this.get("itemPromo"));this.set("header",a);this.set("subHeader",this.get("subtitle")?this.get("subtitle"):!1);this.set("detail",this.get("author")+this.bulletSeperatorHTML+this.buildISBNText(this));this.set("img",this.get("img"));this.set("itemType",this.get("itemType"));this.set("school",null);this.set("meta",this.buildBookPromoContent(b));this.set("data-url",
this.get("attributes")["data-url"]);break;case "course":this.set("header",this.get("title"));this.set("subHeader",this.get("subtitle"));this.set("itemType",this.get("itemType"));this.set("school",this.get("attributes")["data-schoolName"]);this.set("data-url",this.get("attributes")["data-url"]);break;case "major":this.set("header",this.get("title"));this.set("data-url",this.get("attributes")["data-id"]);this.set("itemType",this.get("itemType"));break;case "careerInterest":this.set("header",this.get("title"));
this.set("data-url",this.attributes["data-id"]);this.set("itemType",this.get("itemType"));break;case "academicInterest":this.set("header",this.get("title"));this.set("data-url",this.get("attributes")["data-id"]);this.set("itemType",this.get("itemType"));break;case "school":this.set("header",this.get("title"));this.set("data-url",this.get("attributes")["data-schoolId"]);this.set("itemType",this.get("itemType"));break;case "lastItemLink":this.set("header",this.get("title")),this.set("data-schoolId",
this.get("attributes")["data-schoolId"])}},toOrdinal:function(a){var b=a%10;return b==1&&a!=11?a+"st":b==2&&a!=12?a+"nd":b==3&&a!=13?a+"rd":a+"th"},buildISBNText:function(a){var b=a.get("isbnText"),b=b.replace("&amp;nbsp;",this.bulletSeperatorHTML);a.get("itemType")=="ebook"&&(b=b.replace("ISBN","eISBN"),b=b.replace("ISBN13","eISBN13"));return b},buildBookPromoContent:function(a){if(typeof a=="object"&&(a.hasTBS||a.isEbook||a.hasInstantAccess||a.hasEbook)){var b="",c=a.hasTBS?a.hasTBS:!1,d=a.hasInstantAccess?
a.hasInstantAccess:!1,l=a.hasEbook?a.hasEbook:!1,a=a.isEbook?a.isEbook:!1;if(l===!0||c===!0||a===!0||d===!0)d&&(b+='<span class="results-meta-item">',b+='<span class="results-meta-icon results-meta-icon-instant"></span> <span class="results-meta-label">Free 7-day eTextbook Access</span></span>'),l&&(b+='<span class="results-meta-item">',b+='<span class="results-meta-icon results-meta-icon-ebook"></span> <span class="results-meta-label"><strong>eTextbook</strong> available</span></span>'),c&&(b+='<span class="results-meta-item">',
b+='<span class="results-meta-icon results-meta-icon-tbs"></span> <span class="results-meta-label"><strong>Guided Solutions</strong> available</span></span>'),a&&(b+='<span class="results-meta-item">',b+='<span class="results-meta-icon results-meta-icon-ebook"></span> <span class="results-meta-label"><strong>eTextbook</strong></span></span>');return b}}}),d=C.Collection.extend({model:c});return C.View.extend({model:new b,tmpl_field:_.template('<input name="autosuggest-input" class="autosuggest-input-field <%- text.inputFieldClass %>" type="text" placeholder="<%- text.placeholder %>" autocomplete="off"/><span class="loadingIndicator"></span><div class="autosuggest-results-container"><ul class="autosuggest-results-list"></ul><div class="autosuggest-contextual-content"></div></div>'),
tmpl_form:_.template('<form class="chg-search-form" action="/search" onsubmit="return false"><a data-type="button" class="autosuggest-search-btn search-magnify-btn  <%- text.submitButtonClass %>" href="#"><%= text.submit %></a><a class="autosuggest-search-cancel search-magnify-btn-close autosuggest-search-cancel-<%- text.inputFieldClass %>" href="#"><span class="icon-x"><%- text.close %></span></a><input name="autosuggest-input" class="autosuggest-input-field <%- text.inputFieldClass %>" type="text" placeholder="<%- text.placeholder %>" autocomplete="off" /></form><div class="autosuggest-results-container"><ul class="autosuggest-results-list"></ul><div class="autosuggest-contextual-content"></div></div>'),
initialize:function(){this.model=new b;C.log("autocomplete:construct");this.GAclient=Eggshell.create("C.report.GA");this.model.on("processSuccessResponse",this.processSuccessResponse,this);this.model.on("processErrorResponse",this.processErrorResponse,this);this.model.on("showLoadingIndicator",this.showLoadingIndicator,this);this.model.on("hideLoadingIndicator",this.hideLoadingIndicator,this);this.registerListeners();this.trackId=this.generateTrackId();this.mouseInDropdown=!1;Eggshell.create("C.common.autosuggestPreResults").trigger("hide").trigger("prefetch pre-results data")},
events:{"keyup .autosuggest-input-field":"onKeyUp","keydown .autosuggest-input-field":"onKeyDown","keydown .autosuggest-results-container":"onKeyDown","focus .autosuggest-input-field":"onTextboxFocus","blur .autosuggest-input-field":"onTextboxBlur","click .autosuggest-search-cancel":"resetSearch","click .autosuggest-search-btn":"clickSubmit","click li":"onSelectionClick","mouseenter .autosuggest-results-container":"onMouseEnter","mouseleave .autosuggest-results-container":"onMouseLeave"},mouseOverEvent:{"mouseover li":"onMouseOverSelection"},
registerListeners:function(){Eggshell.find(this).on("force prefetch pre-results data",function(){Eggshell.create("C.common.autosuggestPreResults").trigger("hide").trigger("force prefetch pre-results data")}).on("set pre results last visited pdp",function(a,b){Eggshell.create("C.common.autosuggestPreResults").trigger("hide").trigger("set last visited pdp",b).destroy()});this.Eggshell.listen("render",function(){this.render()});this.Eggshell.listen("set result type",function(a,b){this.model.set("resultType",
b)});this.Eggshell.listen("set pre results",function(a,b){b&&this.model.set("preResultSet",b)});this.Eggshell.listen("set min chars",function(a,b){b&&b===parseInt(b)&&this.model.set("minChars",b)});this.Eggshell.listen("set first result",function(a,b){b&&this.model.set("firstResult",b)});this.Eggshell.listen("set last result",function(a,b){b&&this.model.set("lastResult",b)});this.Eggshell.listen("set full width",function(){this.model.set("fullWidth",!0);this.$el.addClass("fullWidth")});this.Eggshell.listen("set render as form",
function(){this.model.set("renderAsForm",!0);this.$el.addClass("form-display")});this.Eggshell.listen("set tracking",function(a,b){b&&this.model.set("track",b)});this.Eggshell.listen("enable global session tracking",function(){this.model.set("globalSessionTracking",!0)});this.Eggshell.listen("set callback",function(){this.model.set("callback",!0)});this.Eggshell.listen("set contextual content",function(a,b){b&&this.model.set("contextualContent",!0)});this.Eggshell.listen("suppress result meta",function(){this.model.set("suppressMeta",
!0)});this.Eggshell.listen("suppress icons",function(a,b){b&&typeof b=="boolean"&&this.model.set("suppressIcons",b)});this.Eggshell.listen("set placeholder text",function(a,b){this.model.set("placeholderText",b);this.text=$.extend(this.text,{placeholder:this.model.get("placeholderText")})});this.Eggshell.listen("set submit button text",function(a,b){this.model.set("submitButtonText",b)});this.Eggshell.listen("set value",function(a,b){typeof b=="string"&&this.$inputField.val(b)});this.Eggshell.listen("set input field class",
function(a,b){b&&typeof b=="string"&&this.model.set("inputFieldClass",b)});this.Eggshell.listen("set submit button class",function(a,b){b&&typeof b=="string"&&this.model.set("submitButtonClass",b)});this.Eggshell.listen("set max majors",function(a,b){b&&typeof b=="number"&&this.model.set("maxMajors",b)});this.Eggshell.listen("set max schools",function(a,b){b&&typeof b=="number"&&this.model.set("maxSchools",b)});this.Eggshell.listen("disable ajax spinner",function(a,b){b&&typeof b=="boolean"&&this.model.set("disableAjaxLoader",
b)});this.Eggshell.listen("set sohp autosuggest",function(a,b){b&&typeof b=="boolean"&&this.model.set("sohpAutosuggest",b)});this.Eggshell.listen("delegate mouse over selection event",function(a,b){this.delegateEvents(b?_.extend(this.events,this.mouseOverEvent):this.events)});this.Eggshell.listen("set disabled items",function(a,b){this.setDisabledItems(b)});this.Eggshell.listen("add disabled items",function(a,b){this.addDisabledItems(b)});this.Eggshell.listen("remove disabled items",function(a,b){this.removeDisabledItems(b)});
this.Eggshell.listen("hide results",function(){this.hideResults()});this.Eggshell.listen("inline submit button",function(){this.inlineSubmitButton()});Eggshell.find(this).on("focus on search input",function(){this.$inputField&&this.$inputField.focus()})},render:function(){var a=this.model.get("fullWidth"),b=this.model.get("renderAsForm"),c=this.model.get("sohpAutosuggest");this.submitButton='<span class="icn-magnify">'+this.model.get("submitButtonText")+"</span>";this.text={placeholder:this.model.get("placeholderText"),
close:C.resource.fetch("C.common.autosuggest.close"),submit:this.submitButton,submitButtonClass:this.model.get("submitButtonClass"),inputFieldClass:this.model.get("inputFieldClass")};b==!0?this.$el.html(this.tmpl_form({text:this.text})):this.$el.html(this.tmpl_field({text:this.text}));this.$inputField=this.$el.find(".autosuggest-input-field");this.$resultsContainer=this.$el.find(".autosuggest-results-container");this.$resultsList=this.$el.find("ul.autosuggest-results-list");this.$searchButton=this.$el.find(".autosuggest-search-btn");
this.$cancelButton=this.$el.find(".autosuggest-search-cancel");this.$form=this.$el.find(".chg-search-form");this.$loadingIndicatorContainer=this.$el.find(".loadingIndicator");this.$contextualContentContainer=this.$el.find(".autosuggest-contextual-content");this.$curLi=null;this.submitButtonWidth=this.$searchButton.outerWidth();this.model.get("suppressMeta")&&this.$resultsList.addClass("suppress-result-meta");b==!0&&a==!1&&(a="",c==!0?(a="5px",this.$form.css("margin-right","0px"),this.$searchButton.css({background:"#F07D00",
right:a,top:"5px",width:this.submitButtonWidth}),this.$cancelButton.css({right:this.submitButtonWidth+5+"px"})):(a="-"+(this.submitButtonWidth+5)+"px",this.$form.css("margin-right",this.submitButtonWidth),this.$searchButton.css({right:a,width:this.submitButtonWidth})));this.Eggshell.trigger("rendered")},processSuccessResponse:function(){if(!this.blockAllResponses){var a=this.model.get("lastResult"),b=this.model.get("results");if(b){var b=typeof b=="object"?b:jQuery.parseJSON(b),j=new d;$.each(b,$.proxy(function(a,
b){var e=new c(b);e.set("data-ii",parseInt(a)+1);j.add(e)},this));b="";j.length>0?(b=this.buildResultSet(j),this.renderResultSet(b),b=this.$resultsContainer.height()+this.$contextualContentContainer.height(),this.model.set("resultContainerHeight",b),this.model.get("hideResultsOnReload")!=!0&&(this.showResults(),this.model.set("hideResultsOnReload",!1))):(b=this.buildResultSet(""),this.renderResultSet(b),b=this.$resultsContainer.height()+this.$contextualContentContainer.height(),this.model.set("resultContainerHeight",
b),a&&this.showResults())}}},processErrorResponse:function(){var a=this.model.get("lastResult"),b=c_common_result_none({query:this.$inputField.val(),noresults:C.resource.fetch("C.common.autosuggest.noresultsfound"),didyoumean:C.resource.fetch("C.common.autosuggest.didyoumean")});this.renderResultSet(this.options.fullWidth?c_common_result_container_full({attributes:{"data-url":"#"},result:b}):c_common_result_container({attributes:{"data-url":"#"},result:b}));a&&this.$resultsList.append(this.buildLastResult(a));
this.model.set("resultContainerHeight",this.$resultsContainer.height()+this.$contextualContentContainer.height());this.showResults()},buildResultSet:function(b){var c=this.model.get("firstResult"),d=this.model.get("lastResult"),k=this.model.get("contextualContent"),l=this.model.get("fullWidth");this.$resultsList.html("");c&&this.$resultsList.prepend(c);b.length>0&&b.each($.proxy(function(b){var c=$('<li class="result"></li>'),e=$.trim(this.$inputField.val()),d=this.model.get("callback")?this.model.get("callback"):
!1,f=this.model.get("suppressIcons");this.isItemDisabled(b.attributes)&&c.addClass("autosuggest-disabled-item");resultHTML=new a({model:b,el:c,val:e,callback:d,fullWidth:l,eggshell:Eggshell.find(this),suppressIcon:f});this.$resultsList.append(c)},this));d&&this.$resultsList.append(this.buildLastResult(d));k&&this.buildContextualContent()},buildLastResult:function(b){var d=$('<li class="result"></li>');this.isItemDisabled(b.attributes)&&d.addClass("autosuggest-disabled-item");var b=new c(b),j=this.model.get("callback")?
this.model.get("callback"):!1;new a({model:b,el:d,eggshell:Eggshell.find(this),callback:j});this.$resultsList.append(d);return d},buildPreResults:function(){this.$resultsList.html("");this.$contextualContentContainer.html("");this.preResultComponent=Eggshell.create("C.common.autosuggestPreResults",{el:this.$resultsList});this.Eggshell.trigger("rendered pre results")},buildContextualContent:function(){this.$contextualContentContainer.html("");var a=Eggshell.create("C.common.autosuggestContextualContent",
{el:this.$contextualContentContainer});Eggshell.trigger(a,"set contextual content",this.$inputField.val());Eggshell.trigger(a,"get contextual content");this.Eggshell.trigger("rendered contextual content")},renderResultSet:function(a){this.$resultsList.html(a)},showResults:function(){this.model.get("resultContainerHeight");(this.model.get("fullWidth")==!1||this.model.get("renderAsForm")==!1)&&this.$resultsContainer.width(this.$inputField.outerWidth());if(this.$resultsContainer.height()>0||this.model.get("preResultSet")!=
null)this.$resultsContainer.slideDown(300),Eggshell.find("C.common.overlay.tooltip").trigger("hide");var a=this.$inputField.val();parseInt(a.length)>0&&this.$cancelButton.show()},hideResults:function(){this.$resultsContainer.hide();var a=this.$inputField.val()||"";parseInt(a.length)==0&&this.$cancelButton.hide();$(this.$resultsList).find("li").removeClass("selected");if(this.preResultComponent)this.preResultComponent.destroy(),this.preResultComponent=null},inlineSubmitButton:function(){this.$searchButton=
this.$el.find(".autosuggest-search-btn");this.$searchButton.css({right:"0px"})},onKeyDown:function(a){a.keyCode==40?(this.doNextSelection(a),a.preventDefault()):a.keyCode==38?(this.doPrevSelection(a),a.preventDefault()):a.keyCode==27?(this.$inputField.val(""),this.$inputField.blur(),this.hideResults(),this.$curLi=null):a.keyCode==13?(this.doSessionLogging(a),this.onSubmit(a)):($(this.$resultsList).find("li").not($(this.$resultsList).find("li li")).removeClass("selected"),this.$curLi=null)},onKeyUp:function(a){a.keyCode==
13?(this.hideResults(),this.$curLi=null,this.setResponseBlocker()):(a=$.trim(this.$inputField.val()),this.model.get("lastQuery")!=a&&this.evalQuery(a))},setResponseBlocker:function(){this.blockAllResponses=!0;setTimeout($.proxy(function(){this.blockAllResponses=!1},this),1E3)},evalQuery:function(a){var b=this.model.get("minChars"),c=this.model.get("preResultSet"),d=this.model.get("lastQuery"),l=this.model.get("preResultVisible");if(a===""||a.length<b)c?(l==!1?(this.GAclient.trigger("report custom event",
{page:"Header",section:"Psycic search",link:"Show"}),this.buildPreResults(),this.model.set("preResultVisible",!0)):this.buildPreResults(),this.renderResultSet(),this.showResults()):(this.hideResults(),this.$curLi=null);else{if(a.length>=b&&a!=d)this.model.preGetResults(this.buildUrl(a)),this.$curLi=null,this.model.set("preResultVisible",!1);else if(a.length>=b)this.showResults(),this.$curLi=null,this.model.set("preResultVisible",!1);this.model.set("lastQuery",a)}},buildUrl:function(a){var b=this.model.get("resultType"),
c=this.model.get("maxMajors"),d=this.model.get("maxSchools"),l="";if(b&&Object.prototype.toString.call(b)==="[object Array]"){var q,r;l+="type=";q=0;for(r=b.length;q<r;q++)l+=b[q],q<r&&r!=1&&q+1!=r&&(l+="|");l+=b.length>1?"&combine_results=items&":"&";c!=null&&typeof c=="number"&&(l+="majors_max="+c+"&");d!=null&&typeof d=="number"&&(l+="schools_max="+d+"&")}else l="type=all&";return"?search_by="+encodeURIComponent(a)+"&"+l+"trackid="+this.trackId},resetSearch:function(a){a.preventDefault();a.stopPropagation();
this.$inputField.val("");this.$resultsList.html("");this.hideResults();this.$curLi=null},onTextboxFocus:function(){var a=$.trim(this.$inputField.val());this.model.set("lastQuery",a);this.evalQuery(a);Eggshell.find(this).trigger("search input focused")},onTextboxBlur:function(){if(!this.mouseInDropdown&&!this.$inputField.is(":focus"))this.hideResults(),this.$curLi=null;Eggshell.find(this).trigger("search input blurred")},onMouseEnter:function(){if(!this.mouseInDropdown)this.mouseInDropdown=!0},onMouseLeave:function(){$(this.$resultsList).find("li").not($(this.$resultsList).find("li li")).removeClass("selected");
this.$curLi=null},doNextSelection:function(a){var b=$(this.$resultsList).find("li").not($(this.$resultsList).find("li li")),c=b.index($(this.$resultsList).find("li.selected"));b.removeClass("selected");b=c==-1||c>=b.length-1?b.eq(0).addClass("selected"):b.eq(c+1).addClass("selected");b.hasClass("autosuggest-disabled-item")?this.doNextSelection(a):this.changeSelection(b)},doPrevSelection:function(a){var b=$(this.$resultsList).find("li").not($(this.$resultsList).find("li li")),c=b.index($(this.$resultsList).find("li.selected"));
b.removeClass("selected");b=c==-1||c===0?b.eq(b.length-1).addClass("selected"):b.eq(c-1).addClass("selected");b.hasClass("autosuggest-disabled-item")?this.doPrevSelection(a):this.changeSelection(b)},onMouseOverSelection:function(a){a=$(a.target).closest("li");a.not($(this.$resultsList).find("li li")).length!=0&&!a.hasClass("autosuggest-disabled-item")&&(a.length&&(this.$resultsList.find("li").removeClass("selected"),a.addClass("selected")),this.changeSelection(a))},changeSelection:function(a){this.$curLi=
a;a=this.$curLi.find(".result-header");a.length?this.model.set("selectedResult",a.text()):this.model.set("selectedResult",null);this.preResultComponent&&this.preResultComponent.trigger("change selection")},evaluateSchoolData:function(a){savedId=C.utility.getLocal("schoolId");savedName=C.utility.getLocal("schoolName");if(!a)return!1;if(a&&savedId&&savedName&&a==savedId)return this.schoolInfo={schoolName:savedName,schoolId:savedId},!0;else this.getSchool(a)},clickSubmit:function(a){this.onSubmit(a);
this.doSessionLogging(a)},onSubmit:function(a){a.preventDefault();a.stopPropagation();var a=this.model.get("renderAsForm"),b=this.model.get("track");this.model.get("selectedResult");var c=this.model.get("callback"),d=$(this.$resultsList).find("li.selected");this.Eggshell.trigger("autosuggest form submitted");this.hideResults();if(c)a&&!this.$curLi?(this.Eggshell.trigger("callback fired",{inputValue:this.$inputField.val()}),this.Eggshell.trigger("autosuggest clicked",{inputValue:this.$inputField.val()})):
d.mousedown();else{if(a&&!this.$curLi)return b&&typeof b=="string"&&(a=b.split("="),this.$form.append('<input type="hidden" name="'+a[0]+'" value="'+a[1]+'" />')),C.utility.navigate(C.global.cheggSiteUrl+"search/"+encodeURIComponent(this.$inputField.val())+"/books"),!0;this.navigateToNewPage(this.$curLi)}},navigateToNewPage:function(){var a=this.model.get("track"),b=this.model.get("lastQuery");if(this.$curLi!=null){var c=this.$curLi.attr("data-url"),c=_.unescape(c),d=this.$curLi.attr("data-ii");this.updateInputVal();
if(d!=void 0)c=c.indexOf("?")==-1?c+"?ii="+d:c+"&ii="+d,a&&(c+="&"+a);else if(c!=void 0)return C.utility.navigate(c),!0;else c="/search/"+b+"/books"}else c=this.$curLi.find("a").attr("href");C.utility.navigate(c);return!1},onSelectionClick:function(a){var b=this.model.get("callback");if(a.which===1){var c=$(a.target).closest("li");if(c.hasClass("autosuggest-disabled-item"))a.preventDefault(),a.stopPropagation();else if($(a.target).parents().hasClass("pre-result"))b=$(a.target).parents("a").attr("href")!=
void 0?$(a.target).parents("a").attr("href"):$(a.target).attr("href"),$(a.target).parents().hasClass("psychic-sell-textbooks")&&_gaq.push(["_trackEvent","Header","Psychic Search","Sell your books"]),C.utility.navigate(b);else return this.$curLi=c,this.changeSelection(this.$curLi),this.hideResults(),b||this.navigateToNewPage(this.$curLi),this.doSessionLogging(a),this.Eggshell.trigger("clicked result"),!1}},updateInputVal:function(){var a=this.model.get("selectedResult");a&&(this.$inputField.val(a),
this.$inputField.blur(),this.$resultsList.html(""),a=this.buildUrl(a),this.model.set("hideResultsOnReload",!0),this.model.preGetResults(a),this.model.set("selectedResult",null))},showLoadingIndicator:function(){if(!this.model.get("disableAjaxLoader")&&!this.model.get("loadingIndicatorVisible")){if(this.model.get("renderAsForm")){this.$searchButton.html('<canvas class="loading" width="15" height="15"><img src="/s/_global/images/ajax-loader.gif"></canvas>');var a=this.$searchButton.find("canvas.loading")}else this.$loadingIndicatorContainer.html('<canvas class="loading" width="15" height="15"><img src="/s/_global/images/ajax-loader.gif"></canvas>'),
a=this.$loadingIndicatorContainer.find("canvas.loading");var b=this.model.get("fullWidth")&&this.model.get("renderAsForm")?"#ffffff":"#666666";new C.widget.spinner({canvas:a,color:b});this.model.set("loadingIndicatorVisible",!0)}},hideLoadingIndicator:function(){!this.model.get("disableAjaxLoader")&&this.model.get("loadingIndicatorVisible")&&(this.$searchButton.html(this.submitButton),this.$loadingIndicatorContainer.html(""),this.model.set("loadingIndicatorVisible",!1))},generateTrackId:function(){return("000000000"+
Math.abs(Math.random()*4294967295<<0).toString(16)).slice(-8)},doSessionLogging:function(a){a.preventDefault();var b=this.model.get("selectedResult");this.model.get("globalSessionTracking")&&($(a.currentTarget).hasClass("autosuggest-input-field")&&(b!=null?C.logger.doSessionLog({src:"header"}):C.logger.doSessionLog({src:"header",action:"enter"})),$(a.currentTarget).hasClass("autosuggest-search-btn")&&C.logger.doSessionLog({src:"header",action:"button"}),$(a.currentTarget).hasClass("result")&&C.logger.doSessionLog({src:"header"}))},
getDisabledItems:function(){var a=this.model.get("disabledItems");return!a||typeof a!=="object"?[]:a},setDisabledItems:function(a){this.model.set("disabledItems",this.convertItemsToArray(a));return this},addDisabledItems:function(a){return this.setDisabledItems(_.union(this.getDisabledItems(),this.convertItemsToArray(a)))},removeDisabledItems:function(a){return this.setDisabledItems(_.difference(this.getDisabledItems(),this.convertItemsToArray(a)))},convertItemsToArray:function(a){return!a?[]:typeof a!==
"object"?[a]:a},isItemDisabled:function(a){a=a&&a["data-url"]?a["data-url"]:null;return!a||typeof a!=="string"?!1:_.indexOf(this.getDisabledItems(),a)>-1}})}());
var c_common_result_container=_.template('<a href="<%= attributes["data-url"] %>"><%= result %></a>'),c_common_result_container_full=_.template('<a href="<%= attributes["data-url"] %>"><span class="autosuggest-width"><span class="autosuggest-row row"><span class="col-12 col-first col-last"><%= result %></span></span></span></a>'),c_common_result_3_lines=_.template('<div class="result-data result-3-lines result-<%- itemType %> <% if(typeof(meta)!= "undefined"){ %> result-data-margin-right<% } %>"><span class="book-cover-container"></span><div class="result-info"><span class="result-header"><%= header %></span><span class="result-sub-header"><%= subHeader %></span><span class="result-detail"><%= detail %></span><% if(typeof(meta)!= "undefined" && _.size(meta) != 0){ %><div class="results-meta"><%= meta %></div><% } %></div></div>'),
c_common_result_2_lines=_.template('<div class="result-data result-2-lines result-<%- itemType %> <% if(typeof(meta)!= "undefined"){ %> result-data-margin-right<% } %>"><span class="book-cover-container"></span><div class="result-info"><span class="result-header"><%= header %></span><span class="result-detail"><%= detail %></span><% if(typeof(meta)!= "undefined" && _.size(meta) != 0){ %><div class="results-meta"><%= meta %></div><% } %></div></div>'),c_common_result_course=_.template('<div class="result-data result-2-lines result-<%- itemType %> <% if(typeof(meta)!= "undefined"){ %> result-data-margin-right<% } %>"><span class="img-wrapper autosuggest-icon autosuggest-icon-course"> <% if(typeof(img) != "undefined" && typeof(img.url) != "undefined" && typeof(img.alt) != "undefined"){ %> <img src="<%- img.url %>" alt="<%- img.alt %>"> <% } %></span><div class="result-info"><div class="result-bookinfo"><span class="result-header"><%= header %><span class="light"> at <%= school %> </span></span><span class="result-sub-header"><%= subHeader %></span><% if(typeof(meta)!= "undefined" && _.size(meta) != 0){ %><div class="result-meta"><%= meta %></div><% } %></div></div></div>'),
c_common_result_major=_.template('<div class="result-data result-1-lines result-<%- itemType %>"><span class="img-wrapper autosuggest-icon autosuggest-icon-major"><% if(typeof(img) != "undefined" && typeof(img.url) != "undefined" && typeof(img.alt) != "undefined"){ %> <img src="<%- img.url %>" alt="<%- img.alt %>"> <% } %></span><div class="result-info"><span class="result-header"><%= header %></span></div></div>'),c_common_result_careerInterest=_.template('<div class="result-data result-1-lines result-<%- itemType %>"><div class="result-info"><span class="result-header"><%= header %></span></div></div>'),
c_common_result_academicInterest=_.template('<div class="result-data result-1-lines result-<%- itemType %>"><div class="result-info"><span class="result-header"><%= header %></span></div></div>'),c_common_result_school=_.template('<div class="result-data result-2-lines result-<%- itemType %>"><span class="img-wrapper autosuggest-icon autosuggest-icon-school"><% if(typeof(img) != "undefined" && typeof(img.url) != "undefined" && typeof(img.alt) != "undefined"){ %> <img src="<%- img.url %>" alt="<%- img.alt %>"> <% } %></span><div class="result-info"><div class="result-bookinfo"><span class="result-header"><%= header %></span></div></div></div>'),
c_common_result_1_1_1=_.template('<div class="result-data result-<%- itemType %>"><span class="img-wrapper">  <% if(typeof(img) != "undefined" && typeof(img.url) != "undefined" && typeof(img.alt) != "undefined"){ %> <img src="<%- img.url %>" alt="<%- img.alt %>"> <% } %></span><div class="result-info"><div class="result-bookinfo"><span class="result-header"><%= header %> <% if(typeof(school) != "undefined" && typeof(school.schoolName) != "undefined"){ %><span class="light"> at <%= school.schoolName %></span> <% } %></span></div></div></div>'),
c_common_result_last_link=_.template("<%= header %>"),c_common_result_none=_.template('<div class="result-data result-2-lines result-noresults"><div class="result-info"><div class="result-bookinfo"><span class="result-header"><%= noresults %> <span class="chg-suggest-term"><%= query %></span></span></div></div></div>');C("widget");
C.widget.findTBS=C.widget._base.extend({construct:function(){$(".find-tbs").observe("click",this.onClickFindTBS,this)},onClickFindTBS:function(){this.addbookModel&&this.addbookModel.destroy();this.addbookView&&this.addbookView.destroy();this.addbookModel=new C.addbook.model;this.addbookView=new C.addbook.view({type:"solutions",btnTxt:"Go",title:"Find your textbook to view solutions",autoCompleteCallback:$.proxy(this.autoCompleteCallback,this),model:this.addbookModel});this.addbookView.render();$("#addbook-container .add-button").observe("click",
this.gotoSolutions,this);$("body").observe("autocomplete:noResults",this.noResultsFound,this)},noResultsFound:function(){var b="";$("#addbook-container .no-results").length||this.addbookView.$(".dialog-content").append('<div class="msg-info-sm no-results"><div class="msg-icon"><div class="msg-subheader">Solutions are not available for this book, but you can ask any question from your book. <a class="link-body-bold" href="/homework-help/ask">Ask now &raquo;</a></div></div></div>')},autoCompleteCallback:function(b){if((b=
$(b.target).closest("li.suggest-selected"))&&b.length>0)this.addbookView.$(".dialog-content").html($('<ul class="chg-autocomplete-container"/>').append(b)),this.gotoSolutions()},gotoSolutions:function(){var b=$(".find-books .chg-autocomplete-container li.suggest-selected").attr("data-url");if(b)top.window.location.href=b},destruct:function(){this.addbookModel&&this.addbookModel.destroy();this.addbookView&&this.addbookView.destroy()}});C("addbook");
C.addbook.bookView=C.View.extend({objName:"C.addbook.bookView",className:"book clearfix",tmpl:_.template('<div class="book-img-1"><img class="book-cover" src="<%=img.url%>"/></div><div class="mini-biblio"><p class="txt-body-bold book-title"><%=title%></p><p class="book-author"><%=author%></p><p>ISBN: <span class="txt-body"><%-isbn%></span>&nbsp;ISBN13: <span class="txt-body"><%-ean%></span></p></div>'),initialize:function(){this.model.on("destroy",this.destroy,this)},render:function(){this.$el.append($(this.tmpl(this.model.toJSON())));
return this},destroy:function(){this.remove()}});C.addbook.course=C.Model.extend({objName:"C.addbook.course"});C.addbook.courses=Backbone.Collection.extend({objName:"C.addbook.courses",model:C.addbook.course});
C.addbook.courseView=C.View.extend({objName:"C.addbook.courseView",className:"courseRow clearfix",tmpl:_.template('<div class="selector"><input type="radio" id="<%=schoolId%><%=subjectCode%><%=catalogNumber%>" name="header" <%if(checked){%>checked="checked"<%}%>/><label for="<%=schoolId%><%=subjectCode%><%=catalogNumber%>" class="form-radio">&nbsp;</label></div><div class="course"><div class="dept-icon"><img src="/s/_global/images/dept-icons/0.png" alt=""></div><div class="course-title"><span class="txt-body-bold subject"><%=title%></span><br/><span class="subtitle"><%=subtitle%></span></div></div>'),events:{"click input":"onClickRadio"},
initialize:function(){this.model.on("destroy",this.destroy,this)},render:function(){this.$el.append($(this.tmpl({schoolId:this.model.get("schoolId"),subjectCode:this.model.get("subjectCode"),catalogNumber:this.model.get("catalogNumber"),title:this.model.get("title"),subtitle:this.model.get("subtitle")||"",checked:!1})));return this},onClickRadio:function(){this.model.trigger("select",this.model)},destroy:function(){this.remove()}});
C.addbook.coursesView=C.View.extend({objName:"C.addbook.coursesView",className:"courses",tmpl:_.template('<h2 class="txt-hdr-sec">Which course is this book for?</h2><h3>(Get access to Q&A, Notes and more for your course)</h3><div class="courseRow courseInputRow"><div class="selector"><input type="radio" id="userCourse" name="header" checked="checked"><label for="userCourse" class="form-radio">&nbsp;</label></div><input type="text" name="courseName" class="courseInput chg-form-lg" placeholder="Enter course name."/></div>'),
initialize:function(){this.collection.on("add",this.onAdd,this)},render:function(){this.$el.append($(this.tmpl()));return this},setupAutoComplete:function(){new C.widget.autoComplete({el:this.$("input.courseInput"),type:"courses",callback:_.bind(this.onSelectCourse,this)})},onSelectCourse:function(b,a){var c=a.data("itemDetail");this.$(".courseInputRow").hide();this.collection.add({schoolId:c.attributes["data-schoolId"],subjectCode:c.attributes["data-subjectCode"],catalogNumber:c.attributes["data-catalogNumber"],
title:c.title,subtitle:c.subtitle,checked:!0})},onAdd:function(b){(new C.addbook.courseView({model:b})).render().$el.insertBefore(this.$(".courseInputRow"))}});
C.addbook.model=C.Model.extend({objName:"C.addbook.model",initialize:function(){this.courses=new C.addbook.courses;this.courses.on("select",this.onSelectCourse,this);this.courses.on("add",this.onAddCourse,this)},destroy:function(){this.trigger("destroy")},onSelectCourse:function(b){this.selectedCourse=b},onAddCourse:function(b){if(b.get("checked"))this.selectedCourse=b},fetchCourse:function(){var b={year:this.get("year"),term:this.get("term"),ean:this.get("ean")};$.ajax({context:this,type:"post",
dataType:"json",url:"_ajax/book/course",data:b,success:function(a){this.trigger("fetchCourse:success");this.courses.add(a.courses)}})},submit:function(){if(!this.selectedCourse)return!1;var b={year:this.get("year"),term:this.get("term"),ean:this.get("ean"),subject:this.selectedCourse.get("subjectCode"),code:this.selectedCourse.get("catalogNumber"),owned:!0,token:C.global.csrfToken};$.ajax({context:this,type:"post",dataType:"json",url:"_ajax/course/combined/ratingbookownership/add",data:b,success:function(){this.trigger("submit:success")}})}});
C.addbook.view=C.View.extend({objName:"C.addbook.view",tmpl:_.template('<div id="addbook-container" class="dialog-4"><div class="dialog-hdr"><h2 class="dialog-title"><%- title%></h2><div class="dialog-close-wrapper"><button class="btn-secondary-sm chg-dialog-close"><span class="icn-cross">Close</span> </button></div></div><form class="find-books"><div class="dialog-content"><fieldset class="chg-util-autosuggest-form"><input type="text" class="chg-form-sm has-default" placeholder="Enter ISBN, Title or Author\'s Name" name="search_by" autocomplete="off" /></fieldset></div><div class="dialog-ftr"></div></form></div>'),
events:{"click .chg-dialog-close":"onClickCancel"},initialize:function(b){this.options=b;this.model.on("destroy",this.destroy,this);this.model.on("fetchCourse:success",this.onFetchCourseSuccess,this);this.model.on("submit:success",this.options.onSubmitSuccess||this.onSubmitSuccess,this);this.model.on("error",this.onError,this)},destroy:function(){this.remove();this.dialog&&this.dialog.destroy()},render:function(){this.$el.html(this.tmpl({btnTxt:this.options.btnTxt||"Add",title:this.options.title||
"Add book"}));this.showDialog();return this},showDialog:function(){this.log("showDialog");this.dialog&&this.dialog.destroy();this.dialog=new C.widget.dialog({content:this.$el});this.autoComplete&&this.autoComplete.destroy();this.autoComplete=new C.widget.autoComplete({el:".chg-util-autosuggest-form input",type:this.options.type||"books",onTextboxBlur:_.bind(this.onTextboxBlur,this),callback:_.bind(this.options.autoCompleteCallback||this.onSelectBook,this),overrideSolutionsImage:!0})},onTextboxBlur:function(){},
onSelectBook:function(b,a){this.$(".chg-util-autosuggest-form").hide();this.model.set(a.data("itemDetail"));var c=new C.addbook.bookView({model:this.model});this.$(".dialog-content").append(c.render().$el);this.model.selectedCourse||this.model.fetchCourse()},onClickCancel:function(b){b.preventDefault();this.autoComplete&&this.autoComplete.destroy();this.destroy()},onClickSubmit:function(b){b.preventDefault();this.model.submit()},onFetchCourseSuccess:function(){var b=new C.addbook.coursesView({collection:this.model.courses});
b.render().$el.appendTo(this.$(".dialog-content"));b.setupAutoComplete()},onSubmitSuccess:function(){this.destroy();this.reloadPage()},reloadPage:function(){window.location.reload()},onError:function(){}});
Eggshell.define("C.common.rating",{inputs:["set rating","set large version","enable interaction","set non-interactable star color"],outputs:["rated"]},Backbone.View.extend({initialize:function(){this.model=new Backbone.Model({stars:0});this.render();this.$el.addClass("interaction");Eggshell.find(this).on("enable interaction",this.enableInteraction).on("set large version",this.setLargeSize).on("set non-interactable star color",this.setColor).on("set rating",this.setRating)},enableInteraction:function(b,
a){a?this.$el.addClass("interaction"):this.$el.removeClass("interaction")},setLargeSize:function(){this.$(".star-rating-input").addClass("large")},setRating:function(b,a){if(typeof a!="number"||a===null)throw"Invalid payload. Payload needs to be a number";this.model.set("stars",Math.min(parseInt(a),5));this.updateStarsDisplay(this.model.get("stars"))},setColor:function(b,a){if(this.$el.hasClass("interaction"))throw"Cannot set interactable star color. Please disable interaction first.";if(a!=="gray"&&
a!=="yellow")throw"Invalid color. Only gray and yellow are allowed.";a==="gray"?this.$el.addClass("gray"):this.$el.removeClass("gray")},render:function(){this.$el.html(this.template());this.updateStarsDisplay(this.model.get("stars"))},template:_.template('<div class="rate-my-course-input-container"><ul class="star-rating-input"><li data-id="1"></li><li data-id="2"></li><li data-id="3"></li><li data-id="4"></li><li data-id="5"></li></ul></div>'),events:{"hover .interaction .star-rating-input li":"mouseOver",
"mouseout .interaction .star-rating-input":"mouseOut","click .interaction .star-rating-input li":"click"},mouseOver:function(b){this.updateStarsDisplay($(b.currentTarget).attr("data-id"))},mouseOut:function(){this.updateStarsDisplay(this.model.get("stars"))},click:function(b){b=$(b.currentTarget).attr("data-id");this.model.set("stars",parseInt(b));this.updateStarsDisplay(b);Eggshell.find(this).trigger("rated",b)},updateStarsDisplay:function(b){var a=$(this.el).find(".star-rating-input"),a=$(a).find("li");
$.each(a,function(a,d){$(d).removeClass("active");a<=b-1&&$(d).addClass("active")})}}));
Eggshell.define("C.common.advertisements",{inputs:["render","setup ads","clear adDivIds","setup custom targeting","display ads"],outputs:["slot rendered"],singleton:!0},function(){window.googletag=null;var b=!1,a={},c=0,d={},e=[];Eggshell.shell(this).on("render",function(){});this.render=function(){a=$(".chg-display");a.length>0&&(b!==!0&&(this.initialize(),this._setListeners()),Eggshell.shell(this).trigger("clear adDivIds").trigger("setup ads",{obj:a}).trigger("setup custom targeting").trigger("setup adBlock detector").trigger("display ads"))};
this._setListeners=function(){var a=this;Eggshell.shell(this).on("clear adDivIds",this.clearAdDivIds).on("setup ads",function(b,c){a.setupAdSlots(c.obj)}).on("setup custom targeting",this.setupCustomTargeting).on("setup adBlock detector",this.setupAdBlockDetector).on("display ads",this.displayAds)};this.clearAdDivIds=function(){e=[]};this.initialize=function(){return;var a=this;C.utility.loadScript("//www.googletagservices.com/tag/js/gpt.js",$.proxy(function(){this.onScriptLoad()},this));googletag=googletag||
{};googletag.cmd=googletag.cmd||[];googletag.cmd.push(function(){googletag.pubads().enableSingleRequest();googletag.pubads().collapseEmptyDivs();googletag.enableServices();googletag.pubads().addEventListener("slotRenderEnded",$.proxy(a.slotRendered,a))});b=!0};this.getUserData=function(){0&&$.ajax({url:"_ajax/adTargeting",type:"POST",context:this,dataType:"json",async:!1,success:function(a){jsonData=$.parseJSON(a)}});return jsonData};this.setupAdSlots=function(a){$.each(a,$.proxy(function(a,b){this.setupElement(b)},
this))};this.setupElement=function(a){c++;a=$(a);if(a.attr("id")!==void 0)e.indexOf(a.attr("id"))==-1&&e.push(a.attr("id"));else{var b="/7223/"+a.data("unit"),k=a.data("size").toLowerCase().split("x"),l=parseInt(k[0],10),q=parseInt(k[1],10),r="chg-bp-"+c;a.attr("id",r);a.data("nojs")!==void 0?this.addNonJSAd(a):(e.push(r),a.is("[data-autoresize]")?a.addClass("autoresize").css({paddingBottom:Math.round(1E3*q/l)/10+"%"}):a.is("[data-fullwidth]")&&a.addClass("fullwidth"),a=a.data("onload"),a!==void 0&&
(d[r]=a),googletag.cmd.push(function(){googletag.defineSlot(b,[l,q],r).addService(googletag.pubads()).set("container-id",r)}))}};this.getLinkCustomTargeting=function(){var a=this.getCustomTargeting(),b=[];return a!=null&&a!==void 0?($.each(a,function(a,c){b.push(a+"="+c)}),"&t="+encodeURIComponent(b.join("&"))):""};this.getCustomTargeting=function(){var a=this.getUserData();return $.extend({},C.global.adTargeting,a)};this.setupCustomTargeting=function(){var a=this.getCustomTargeting();a!=null&&this.setupDFPTargeting(a)};
this.setupDFPTargeting=function(a){a!=null&&$.each(a,function(a,b){googletag.cmd.push(function(){googletag.pubads().setTargeting(a,b+"")})})};this.slotRendered=function(a){var b=a.slot.getName(),c=a.slot.get("container-id");this._logAd(b,"js",a.isEmpty===!0?"no":"yes");a.isEmpty===!1&&d[c]!==void 0&&this.executeOnLoadAction(d[c]);Eggshell.find(this).trigger("slot rendered",{id:c,name:b,nonempty:!a.isEmpty,event:a})};this.displayAds=function(){$.each(e,function(a,b){googletag.cmd.push(function(){googletag.display(b)})})};
this.setupAdBlockDetector=function(){var a=this;googletag.cmd.push(function(){var b=googletag.debug_log.log,c=!0;googletag.debug_log.log=function(d,e,r,g,o){e&&e.getMessageId&&(e.getMessageId()==4?c=!1:e.getMessageId()==1&&c===!0&&(C.logger.doSessionLog({ad_blocker_detected:!0}),a._hasAdBlocker()));return b.apply(this,arguments)}})};this.executeOnLoadAction=function(a){switch(a){case "tower-slider":C.utility.showTower()}};this._logAd=function(a,b,c){C.logger.doSessionLog({ad_slot:a,ad_type:b,ad_displayed:c})};
this.onScriptLoad=function(){};this.addNonJSAd=function(a){var b=$(a);$(a).append(this._defaultAdTemplate({adImageSrc:this.getLinkAds()+this.getProvider()+b.data("unit"),size:b.data("size"),time:this.getUnixTimeStamp(),targeting:this.getLinkCustomTargeting()}));this._logAd(a.data("unit"),"html","unknown")};this.getProvider=function(){return"/7223/"};this.getLinkAds=function(){return"http://pubads.g.doubleclick.net/gampad/ad?iu="};this.getUnixTimeStamp=function(){return Math.round(+new Date/1E3)};
this._defaultAdTemplate=function(a){return'<img src="'+a.adImageSrc+"&sz="+a.size+"&c="+a.time+""+a.targeting+'" />'};this._hasAdBlocker=function(){}});
Eggshell.define("C.common.bookcover.centered",{inputs:["set book image","set book link","set book alt","turn on shadow","turn off shadow","add class"],outputs:["ready","error","clicked"]},Backbone.View.extend({initialize:function(){console.log("C.common.bookcover.centered is deprecated, use C.common.bookcover instead");this.model=new Backbone.Model;this.enableShadow();Eggshell.find(this).on("set book image",this.setBookImage).on("set book link",this.setBookLink).on("turn on shadow",this.enableShadow).on("turn off shadow",
this.disableShadow).on("set book alt",this.setBookAlt).trigger("ready")},enableShadow:function(){this.$el.addClass("shadow-enabled")},disableShadow:function(){this.$el.removeClass("shadow-enabled")},setBookAlt:function(b,a){var c=this.$("img");$(c).attr("alt",a)},setBookImage:function(b,a){if(!a&&typeof a!=="string")throw"Invalid book image url. Image url needs to be a non-empty string";this.model.set("image",a);this.render()},setBookLink:function(b,a){if(!a&&typeof a!=="string")throw"Invalid book link url. Link needs to be a non-empty string";
this.model.set("link",a);this.render()},render:function(){this.$el.empty();var b=this.$el;this.model.get("image")&&(this.model.get("link")&&(b=$("<a></a>").attr("href",this.model.get("link")).appendTo(this.$el)),b.addClass("img-wrapper"),b=$("<img/>").appendTo(b),b.error($.proxy(function(){this.$el.addClass("error");this.$("img").remove();this.Eggshell.trigger("error")},this)),b.attr("src",this.model.get("image")))},events:{"click a":"bookOnClick"},bookOnClick:function(){Eggshell.find(this).trigger("clicked")}}));
Eggshell.define("C.common.bookcover.enhance",{inputs:[],outputs:["ready","error","clicked"],newNode:!1},Backbone.View.extend({events:{"click a":"bookOnClick"},initialize:function(){},bookOnClick:function(){this.Eggshell.trigger("clicked")}}));
Eggshell.define("C.common.bookcover",{inputs:["show","hide","set book image","set book alt","set book link","set book cover size","set book cover type","set book data","get book data","turn on shadow","turn off shadow","add class"],outputs:["ready","error","clicked","returned book data"]},Backbone.View.extend({events:{"click a":"bookOnClick"},initialize:function(){this.model=new Backbone.Model;this.$el.addClass("centered shadow-enabled");typeof $.browser!=="undefined"&&$.browser&&$.browser.msie&&
$.browser.version<=8&&this.$el.addClass("ie-old");Eggshell.find(this).on("set book cover type",this.setBookCoverType).on("set book cover size",this.setBookCoverSize).on("set book image",this.setBookImage).on("set book alt",this.setBookAlt).on("set book link",this.setBookLink).on("add class",this.setBookClassName).on("turn on shadow",this.enableShadow).on("turn off shadow",this.disableShadow).on("set book data",this.setData).on("get book data",this.getData).trigger("ready")},setData:function(b,a){this.model.set("data",
a)},getData:function(){Eggshell.find(this).trigger("returned book data",this.model.get("data"))},render:function(){this.$el.removeClass("img-wrapper");this.$el.empty();var b=this.$el;this.model.get("image")&&(this.model.get("link")&&(b=$("<a></a>").attr("href",this.model.get("link")).appendTo(this.$el)),this.$el.hasClass("centered")&&b.addClass("img-wrapper"),b=$("<img/>").appendTo(b),b.error($.proxy(function(){this.$el.addClass("error");this.$("img").remove();this.Eggshell.trigger("error")},this)),
b.attr("src",this.model.get("image")))},setBookCoverType:function(b,a){if(!a||typeof a!=="string")throw"Invalid book cover type. Type needs to be a string value.";this.$el.removeClass("flexible centered shadow-enabled img-wrapper");a==="flexible"?this.$el.addClass("flexible"):a==="centered"&&this.$el.addClass("centered shadow-enabled")},setBookCoverSize:function(b,a){if(!a||typeof a!=="string")throw"Invalid book cover size. Size needs to be a string value.";this.$el.removeClass("large medium small");
a==="small"?this.$el.addClass("small"):a==="medium"?this.$el.addClass("medium"):a==="large"&&this.$el.addClass("large")},setBookImage:function(b,a){if(!a&&typeof a!=="string")throw"Invalid book image url. Url needs to be a string value.";this.model.set("image",a);this.render()},setBookAlt:function(b,a){if(!a&&typeof a!=="string")throw"Invalid book alt. Alt needs to be a string value.";this.$("img").attr("alt",a)},setBookLink:function(b,a){if(!a&&typeof a!=="string")throw"Invalid link. Link needs to be a string value.";
this.model.set("link",a);this.render()},setBookClassName:function(b,a){if(!a&&typeof a!=="string")throw"Invalid class name";this.$("img").addClass(a)},enableShadow:function(){this.$el.addClass("shadow-enabled")},disableShadow:function(){this.$el.removeClass("shadow-enabled")},bookOnClick:function(){this.Eggshell.trigger("clicked")}}));
Eggshell.defineInterface("C.common.dialog.interface",{inputs:["set id","set headline","set sub headline","set icon","set icon size","set content html","set content component","get content area","destroy content","set control","get control area","show","hide","show headline","hide headline","show sub headline","hide sub headline","show icon","hide icon","enable default control","show control","set primary button","set secondary button","set link","show primary button","hide primary button","disable primary button",
"enable primary button","show secondary button","hide secondary button","disable secondary button","enable secondary button","show link","hide link","hide control","enable screen blocker click","disable screen blocker click","disable default padding","hide close button","configure dialog","configure controls","set content","show loading","hide loading"],outputs:["content component created","content area","control component created","control area","shown","hidden","headline clicked","sub headline clicked",
"icon clicked","close button clicked","screen blocker clicked","primary button clicked","secondary button clicked","link clicked","content clicked"]});
Eggshell.define("C.common.dialog",{"interface":"C.common.dialog.interface"},Backbone.View.extend({componentNS:null,controlNS:null,options:{icon:!1,iconSize:!1,headline:"",subHeadline:"",controls:{primaryText:"Ok",secondaryText:"Cancel",primaryCallback:$.noop,secondaryCallback:$.noop},screenBlockerClickEnabled:!0,noPadding:!1,hideClose:!1,closeTitle:C.resource.fetch("C.Eggshell.dialog.close.title"),html:""},initialize:function(b){this.bindEvents();this.bindV2Interface();this.configureDialog(b);b&&
b.control&&this.configureControls(b.control);b&&b.html&&this.setContent(b.html);this.render();Eggshell.find(this).on("destroy",this.destroy)},render:function(){this.renderDialog();this.$(".screenBlocker").css("z-index",C.utility.getMaxIndex());this.$(".dialog").css("z-index",C.utility.getMaxIndex()+1)},renderDialog:function(){this.$el.html(this.templates.dialog(this.options));this.renderHeader();this.renderContent();this.renderControls()},renderHeader:function(){var b=this.templates.header(this.options);
this.$(".header").first().html(b)},renderContent:function(){this.$(".content").first().show().removeClass("disabled").html(this.options.html);this.options.html||this.$(".content").hide().addClass("disabled")},renderControls:function(){this.controlNS&&this.controlNS.destroy();this.controlNS=Eggshell.create("C.Eggshell.dialog.control.standard",{el:$.extend({},this.$(".control"))}).trigger("set primary button",this.options.controls.primaryText).trigger("set secondary button",this.options.controls.secondaryText).on("primary button clicked",
this.options.controls.primaryCallback,this).on("secondary button clicked",this.options.controls.secondaryCallback,this);

if(!this.loading)
	this.loading=Eggshell.create("C.Eggshell.loading.inline",{el:$.extend({},this.$(".control"))});
this.loading.trigger("hide")},bindV2Interface:function(){Eggshell.find(this).on("configure dialog",function(b,a){this.configureDialog(a);this.render()},this).on("configure controls",function(b,a){this.configureControls(a);this.renderControls()},this).on("set content",function(b,
a){this.setContent(a);this.renderContent()},this)},configureDialog:function(b){for(var a in b)b.hasOwnProperty(a)&&a!=="controls"&&(this.options[a]=b[a])},configureControls:function(b){for(var a in b)b.hasOwnProperty(a)&&(this.options.controls[a]=b[a])},setContent:function(b){if(b)this.options.html=b},destroy:function(){this.hide();this.destroyContent();this.destroyControl()},bindEvents:function(){Eggshell.find(this).on("set id",function(b,a){this.$(".dialog").attr("id",a)}).on("set headline",function(b,
a){if(typeof a!=="string")throw"Invalid headline";this.configureDialog({headline:a});this.renderHeader()}).on("set sub headline",function(b,a){if(typeof a!=="string")throw"Invalid sub headline";this.configureDialog({subHeadline:a});this.renderHeader()}).on("set icon",function(b,a){if(typeof a!=="boolean"&&typeof a!=="string")throw"Invalid icon class name";this.configureDialog({icon:a});this.renderHeader()}).on("set icon size",function(b,a){if(typeof a!=="boolean"&&typeof a!=="string")throw"Invalid icon class name";
this.configureDialog({iconSize:a});this.renderHeader()}).on("set content html",function(b,a){if(typeof a!=="string")throw"Invalid content html";this.destroyContent();this.setContent(a);this.renderContent()}).on("disable screen blocker click",function(){this.configureDialog({screenBlockerClickEnabled:!1})}).on("enable screen blocker click",function(){this.configureDialog({screenBlockerClickEnabled:!0})}).on("disable default padding",function(){this.configureDialog({noPadding:!0});this.render()}).on("hide close button",
function(){this.configureDialog({hideClose:!0});this.renderHeader()}).on("enable default control",function(b,a){if(!a&&typeof a!=="boolean")throw"Invalid control enable flag";this.$(".control").show().removeClass("disabled");this.destroyControl();this.controlNS=Eggshell.create("C.Eggshell.dialog.control.standard",{el:$.extend({},this.$(".control"))});Eggshell.connect(Eggshell.find(this).getNamespace(),"set primary button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"set secondary button",
this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"set link",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"show primary button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"hide primary button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"disable primary button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"enable primary button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),
"show secondary button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"hide secondary button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"disable secondary button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"enable secondary button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"set text below button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"show text below button",this.controlNS);
Eggshell.connect(Eggshell.find(this).getNamespace(),"hide text below button",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"show link",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"hide link",this.controlNS);Eggshell.connect(Eggshell.find(this).getNamespace(),"enable screen blocker",this.controlNS);Eggshell.connect(this.controlNS,"primary button clicked",Eggshell.find(this).getNamespace());Eggshell.connect(this.controlNS,"secondary button clicked",Eggshell.find(this).getNamespace());
Eggshell.connect(this.controlNS,"link clicked",Eggshell.find(this).getNamespace());this.controlNS.trigger("show")}).on("set content component",function(b,a){if(!a&&typeof a!=="string")throw"Invalid content component constructor";this.destroyContent();this.componentNS=Eggshell.create(a,$.extend({},this.$(".content")));Eggshell.find(this).trigger("content component created",this.componentNS)}).on("get content area",function(){Eggshell.find(this).trigger("content area",$.extend({},this.$(".content")))}).on("destroy content",
function(){this.destroyContent()}).on("set control",function(b,a){if(!a||typeof a!=="string")throw"Invalid control constructor";this.controlNS&&this.controlNS.destroy();this.controlNS=Eggshell.create(a,{el:$.extend({},this.$(".control"))});this.$(".control").show().removeClass("disabled");Eggshell.find(this).trigger("control component created",this.controlNS)}).on("get control area",function(){Eggshell.find(this).trigger("control area",$.extend({},this.$(".control")))}).on("show",function(){this.show()}).on("hide",
function(){this.hide()}).on("show headline",function(){this.$(".headline").show()}).on("hide headline",function(){this.$(".headline").hide()}).on("show sub headline",function(){this.$(".subHeadline").show()}).on("hide sub headline",function(){this.$(".subHeadline").hide()}).on("show icon",function(){this.$(".icon").show()}).on("hide icon",function(){this.$(".icon").hide()}).on("show control",function(){this.$(".control").show().removeClass("disabled")}).on("hide control",function(){this.$(".control").hide().addClass("disabled")}).on("show loading",
function(){this.controlNS.trigger("hide");this.loading.trigger("show")}).on("hide loading",function(){this.loading.trigger("hide");this.controlNS.trigger("show")});Eggshell.create("C.Eggshell.window.resize.tracker").on("resize",$.proxy(this.resize,this))},destroyContent:function(){this.componentNS&&this.componentNS.destroy();this.$(".content").html("")},destroyControl:function(){this.controlNS&&this.controlNS.destroy();this.$(".control").html("")},show:function(){Eggshell.find("C.common.overlay.tooltip").trigger("acitvate tooltip");
this.resizable=!0;this.lockViewport();this.$el.show();this.$(".dialog").show();this.resize();this.$(".dialog").hide();this.$(".dialog").fadeIn(300,$.proxy(function(){Eggshell.find(this).trigger("shown");this.resize()},this))},hide:function(){this.resizable=!1;this.$(".dialog").fadeOut(300,$.proxy(function(){this.unlockViewport();this.$el.hide();Eggshell.find(this).trigger("hidden")},this));Eggshell.find("C.common.overlay.tooltip").trigger("deacitvate tooltip")},lockViewport:function(){$("html, body").css({overflow:"hidden"})},
unlockViewport:function(){$("html, body").css({overflow:"visible"})},resize:function(){this.$(".dialog").height();var b=$(window).height(),b=parseInt(b-2*this.$(".dialog").css("top").replace("px","")),a=this.$(".header").height(),c=this.$(".control").height();a&&(b-=a);c&&(b-=c,a=parseInt(this.$(".control").css("margin-top").replace("px")),b-=a);this.$(".control").css("margin-top")&&(b-=parseInt(this.$(".control").css("margin-top").replace("px")));(a=this.$(".dialog").css("padding"))||(a=this.$(".dialog").css("padding-top"));
a&&(b-=2*parseInt(a.replace("px")));b<=0&&(b=0);this.$(".content").css("max-height",b)},events:{"click .close":"closeOnClick","click .screenBlocker":"screenBlockerOnClick","click .headline":"headlineOnClick","click .subHeadline":"subHeadlineOnClick","click .icon":"iconOnClick","click .content":"contentOnClick"},closeOnClick:function(b){b.preventDefault();b.stopPropagation();Eggshell.find(this).trigger("close button clicked");this.hide()},screenBlockerOnClick:function(){this.options.screenBlockerClickEnabled!==
!1&&(Eggshell.find(this).trigger("screen blocker clicked"),this.hide())},headlineOnClick:function(){Eggshell.find(this).trigger("headline clicked")},subHeadlineOnClick:function(){Eggshell.find(this).trigger("sub headline clicked")},iconOnClick:function(){Eggshell.find(this).trigger("icon clicked")},contentOnClick:function(b){Eggshell.find(this).trigger("content clicked",b)},templates:{dialog:_.template('<div class="dialog<% if (noPadding) { %> no-padding<% } %>"><div class="header"></div><div class="content"></div><div class="control"></div></div><div class="screenBlocker"></div>'),
header:_.template('<div class="close<% if (hideClose) { %> hidden<% } %>" title="<%- closeTitle %>"></div><div class="icon<% if (icon) { %> <%= icon %><% } else { %> hidden<% } %><% if (iconSize) { %><%= iconSize %><% } %>"></div><h3 class="headline<% if (!headline) { %> hidden<% } %>"><%= headline %></h3><p class="subHeadline<% if (!subHeadline) { %> hidden<% } %>"><%= subHeadline %></p>')}}));C.resource.add("C.common.dialog.close.title","Close");
$(function(){GASendClick=function(a,b,d,e){_gaq.push(["_trackEvent",a,b,d]);if(e){if(a=$(e.currentTarget).attr("href"))e.stopImmediatePropagation(),Eggshell.find("C.global.header.rightsection.usermenu").trigger("hide menu"),Eggshell.find("C.global.header.searchbox").trigger("collapse search box");a&&(a.indexOf("mailto:")===0||a.indexOf("//")===0||a.indexOf("#")===0||a.indexOf("/#")!==-1)?a.indexOf("#")===0&&$(a).length>0&&(b=$(a).offset().top-60,window.location.replace(a),window.scrollTo(0,b),e.preventDefault()):
a&&!e.ctrlKey&&!e.metaKey&&(e.preventDefault(),setTimeout(function(a,b){return function(){$(e.target).hasClass("chg-global-nav-home")||$(e.target).hasClass("chg-global-nav-list-section-home")?C.utility.openGlobalNav(animate=!0):$(e.target).hasClass("chg-logo")?$(e.target).next()&&$(e.target).next().hasClass("chg-menu")&&C.utility.openGlobalNav(animate=!0):C.utility.closeGlobalNav(animate=!0);if(a.attr("data-noajax")!=null){if(a.attr("data-noredirect")==null)self.location=b}else C.utility.navigate(b)}}($(e.currentTarget),
a),200))}};$(".chg-global-nav .track-nav-profile").on("click",function(a){GASendClick("SIHP","Menu","Profile",a)});$(".chg-global-nav .track-nav-courses").on("click",function(a){GASendClick("SIHP","Menu","Courses",a)});$(".chg-global-nav .track-nav-qna").on("click",function(a){GASendClick("SIHP","Menu","Q&A",a)});$(".chg-global-nav .track-nav-solutions").on("click",function(a){GASendClick("SIHP","Menu","Solutions",a)});$(".chg-global-nav .track-nav-books").on("click",function(a){GASendClick("SIHP",
"Menu","Books",a)});$(".chg-global-nav .track-nav-scholarships").on("click",function(a){GASendClick("SIHP","Menu","Scholarships",a)});$(".chg-global-nav .track-nav-internship").on("click",function(a){GASendClick("SIHP","Menu","Internships",a)});$(".chg-global-nav .track-career-center").on("click",function(a){GASendClick("SIHP","Menu","Career Center",a)});$(".chg-global-nav .track-nav-freshmen").on("click",function(a){GASendClick("SIHP","Menu","Freshmen",a)});$(".chg-global-nav .track-nav-live-tutors").on("click",
function(a){GASendClick("SIHP","Menu","Live Tutors",a)});$(".chg-global-nav .track-nav-admission").on("click",function(a){GASendClick("SIHP","Menu","Admissions",a)});$(".chg-global-nav .track-nav-deal-center").on("click",function(a){GASendClick("SIHP","Menu","Deal Center",a)});$(".chg-global-nav .track-nav-online-courses").on("click",function(a){GASendClick("SIHP","Menu","Online Courses",a)});$(".chg-global-nav .track-nav-home").on("click",function(a){GASendClick("SIHP","Menu","Home",a)});$(".chg-global-nav .track-nav-home-icon").on("click",
function(a){GASendClick("SIHP","Menu","Home Icon",a)});C.dom.$content.observe("click",".apple-store-btn",function(a){GASendClick("SIHP","App Promo","iOS",a)},this);C.dom.$content.observe("click",".google-play-btn",function(a){GASendClick("SIHP","App Promo","Android",a)},this);C.dom.$content.observe("click",".recent-books .sellbook",function(a){GASendClick("SIHP","Books & Solutions","Buyback",a)},this);C.dom.$content.observe("click",".recent-books li.track-instant",function(a){GASendClick("SIHP","Books & Solutions",
"Instant Access",a)},this);C.dom.$content.observe("click",".recent-books li.track-ebook",function(a){GASendClick("SIHP","Books & Solutions","eTextbook",a)},this);C.dom.$content.observe("click","li.solution",function(a){GASendClick("SIHP","Books & Solutions","TBS",a)},this);C.dom.$content.observe("click","li.potentialSolution",function(a){GASendClick("SIHP","Books & Solutions","Potential TBS",a)},this);C.dom.$content.observe("click","li.track-book",function(a){GASendClick("SIHP","Books & Solutions",
"Physical Book",a)},this);C.dom.$content.observe("click","a.track-see-all-books",function(a){GASendClick("SIHP","Books & Solutions","See All Books",a)},this);C.dom.$content.observe("click","div#courses .course.view",function(a){GASendClick("SIHP","Courses","Course",a)},this);C.dom.$content.observe("click","div#courses .course.add",function(a){GASendClick("SIHP","Courses","Add Course",a)},this);C.dom.$content.observe("click","a.see-all-courses",function(a){GASendClick("SIHP","Courses","See All Courses",
a)},this);C.dom.$content.observe("click","#whats-next .track-view-order",function(a){GASendClick("SIHP","What's Next","View Order",a)},this);C.dom.$content.observe("click","#whats-next .track-early-return",function(a){GASendClick("SIHP","What's Next","Early Return",a)},this);C.dom.$content.observe("click","#whats-next .track-enter-school",function(a){GASendClick("SIHP","What's Next","Enter School",a)},this);C.dom.$content.observe("click","#whats-next .track-add-courses",function(a){GASendClick("SIHP",
"What's Next","Enter Courses",a)},this);C.dom.$content.observe("click","#whats-next .track-review-course",function(a){GASendClick("SIHP","What's Next","Review Course",a)},this);C.dom.$content.observe("click","#whats-next .track-scholarships",function(a){GASendClick("SIHP","What's Next","Scholarships",a)},this);C.dom.$content.observe("click","#whats-next .track-return-books",function(a){GASendClick("SIHP","What's Next","Return Books",a)},this);C.dom.$content.observe("click","a.track-find-tbs",function(a){GASendClick("SIHP",
"TBS and Q&A","Find Solutions",a)},this);C.dom.$content.observe("click",".tbs-row",function(a){GASendClick("SIHP","TBS and Q&A","TBS",a)},this);C.dom.$content.observe("click",".tbs-show-more",function(a){GASendClick("SIHP","TBS and Q&A","TBS Show More",a)},this);C.dom.$content.observe("click","a.track-ask",function(a){GASendClick("SIHP","TBS and Q&A","Ask a Question",a)},this);C.dom.$content.observe("click","a.track-answer",function(a){GASendClick("SIHP","TBS and Q&A","Answer Questions",a)},this);
C.dom.$content.observe("click","a.track-my-questions",function(a){GASendClick("SIHP","TBS and Q&A","My Questions",a)},this);C.dom.$content.observe("click","a.track-my-answers",function(a){GASendClick("SIHP","TBS and Q&A","My Answers",a)},this);C.dom.$content.observe("click",".my-scholarships .scholarship",function(a){GASendClick("SIHP","Scholarships","Scholarship",a)},this);C.dom.$content.observe("click",".my-scholarships .more",function(a){GASendClick("SIHP","Scholarships","More Matches",a)},this);
C.dom.$content.observe("click",".my-scholarships .see-all-scholarships",function(a){GASendClick("SIHP","Scholarships","See All Scholarships",a)},this);var b=C.global.userId;b&&b!=""?($("a.chg-global-nav-home").on("click",function(a){GASendClick("Header","House","Signed In",a)}),$("a.chg-logo").on("click",function(a){GASendClick("Header","Chegg Logo","Signed In",a)}),$("a.track-homework-help-signedin").on("click",function(a){GASendClick("Header","Homework Help","Signed In",a)}),$("a.chg-cart-area.chg-menu-item.track-cart").on("click",
function(a){GASendClick("Header","Cart","Signed In",a)}),$("div.track-coupon").on("click",function(a){GASendClick("Header","Coupon","Signed In",a)}),C.dom.$header.observe("click",".chg-header-username",function(a){$(a.currentTarget).hasClass("pop-active")||GASendClick("Header","Dropdown","Open Dropdown",a)},this),C.dom.$header.observe("click",".hdr-nav .track-my-account",function(a){GASendClick("Header","Dropdown","My Account",a)},this),C.dom.$header.observe("click",".hdr-nav .track-my-profile",function(a){GASendClick("Header",
"Dropdown","My Profile",a)},this),C.dom.$header.observe("click",".hdr-nav .track-user-avatar",function(a){console.log("coming here");GASendClick("Header","Dropdown","User Avatar",a)},this),C.dom.$header.observe("click",".hdr-nav .track-track-books",function(a){GASendClick("Header","Dropdown","Track Books",a)},this),C.dom.$header.observe("click",".hdr-nav a.track-return-books",function(a){GASendClick("Header","Dropdown","Return Books",a)},this),C.dom.$header.observe("click",".hdr-nav a.track-extend",
function(a){GASendClick("Header","Dropdown","Extend/Purchase",a)},this),C.dom.$header.observe("click",".hdr-nav a.track-sell-books",function(a){GASendClick("Header","Dropdown","Sell Books",a)},this),C.dom.$header.observe("click",".hdr-nav a.track-view-orders",function(a){GASendClick("Header","Dropdown","View Orders",a)},this),C.dom.$header.observe("click",".hdr-nav a.track-help",function(a){GASendClick("Header","Dropdown","Help",a)},this),C.dom.$header.observe("click",".hdr-nav a.track-signout",function(a){GASendClick("Header",
"Dropdown","Sign Out",a)},this)):($("a.chg-global-nav-home").on("click",function(a){GASendClick("Header","House","Signed Out",a)}),$("a.chg-logo").on("click",function(a){GASendClick("Header","Chegg Logo","Signed Out",a)}),$("a.track-homework-help-signedout").on("click",function(a){GASendClick("Header","Homework Help","Signed Out",a)}),$("a.chg-cart-area.chg-menu-item.track-cart").on("click",function(a){GASendClick("Header","Cart","Signed Out",a)}),$("div.track-coupon").on("click",function(a){GASendClick("Header",
"Coupon","Signed Out",a)}),$("a.track-signin").on("click",function(a){GASendClick("Header","Signed In","",a)}),C.dom.$header.observe("click",".chg-menu-item.chg-header-more",function(a){$(a.currentTarget).hasClass("pop-active")||GASendClick("Header","More","Open Dropdown",a)},this),C.dom.$header.observe("click",".hdr-list .track-signup",function(a){GASendClick("Header","More","Sign Up",a)},this),C.dom.$header.observe("click",".hdr-list .track-selltextbooks",function(a){GASendClick("Header","More",
"Sell your books",a)},this),C.dom.$header.observe("click",".hdr-list .track-help",function(a){GASendClick("Header","More","Help",a)},this),C.dom.$header.observe("click",".hdr-list .track-returnbooks",function(a){GASendClick("Header","More","Return your books",a)},this));$(".chg-footer .sell-textbooks").on("click",function(a){GASendClick("Footer","Help","Sell Textbooks",a)});C.dom.$content.observe("click",".courseCollector .continue-btn-container .btn-continue",function(a){var b=$(a.currentTarget).closest(".courseCollector"),
d=$(b).find("form.courses");$(d).find("input[type=radio]").each(function(){$(this).attr("checked")&&GASendClick("Post-Checkout","Course Collection","Added Courses",a)});b=$(b).find("ul#otherCourseContainer");$(b).find("li").length>=1&&GASendClick("Post-Checkout","Course Collection","Other Courses",a)},this)});C("global");C.global.cachedJS=[];C.global.pageObject={};C.global.instanceCounter=C.global.instanceCounter||0;C.global.pageCounter=C.global.pageCounter||0;
C.global.adTargeting=C.global.adTargeting||{};
$(function(){if($(".chg-hdr-v3").length>0){var b=Eggshell.create("C.global.header").trigger("render");Eggshell.immuneToDestroyAll(b)}Eggshell.enableErrorHandling(!C.global.disableErrorhandling);setInterval($.proxy(function(){C.utility.updateCsrfToken($.proxy(function(){this.userDropdownWidget.opts.content=this.getUserDropdownContent()},this))},this),18E5);b=Eggshell.create("C.common.tracking");Eggshell.immuneToDestroyAll(b);Eggshell.immuneToDestroyAll(Eggshell.create("C.common.beacon"));var a=[],
c=0,d={},e=!1,f=!1,j=[],k=[],l,q=C.utility.showSpinner=function(){r();C.dom.$content.stop().css({visibility:"hidden",opacity:0});l=setTimeout(function(){$(".chg-global-content").append('<div class="chg-page-loading" style="display: none"><div class="chg-load"></div></div>');$(".chg-page-loading").fadeIn()},0)},r=C.utility.hideSpinner=function(){clearTimeout(l);$(".chg-page-loading").remove();C.dom.$content.stop().css("visibility","visible").animate({opacity:1})},b=function(a){var b=a.currentTarget.getAttribute("href");
if(b&&(b.indexOf("mailto:")===0||b.indexOf("//")===0||b.indexOf("#")===0||b.indexOf("/#")!==-1)){if(b.indexOf("#")===0&&$(b).length>0){var c=$(b).offset().top-60;window.location.replace(b);window.scrollTo(0,c);a.preventDefault()}}else!a.ctrlKey&&!a.metaKey&&($(a.target).hasClass("chg-global-nav-home")||$(a.target).hasClass("chg-global-nav-list-section-home")?C.utility.openGlobalNav(animate=!0):$(a.target).hasClass("chg-logo")?$(a.target).next()&&$(a.target).next().hasClass("chg-menu")&&C.utility.openGlobalNav(animate=
!0):C.utility.closeGlobalNav(animate=!0),a.preventDefault(),C.utility.navigate(b))},g=C.utility._handleRequest=function(b){C.dom.$html.find("*").off(".chg-page-widget");C.logger.referrer_url=History.getStateByIndex(-2)?History.getStateByIndex(-2).url:location.href;setTimeout(q,0);window.scrollTo(0,0);C.dom.$html.css("cursor","progress");a.push($.ajax({type:"post",url:b,data:{orig_referrer:C.logger.referrer_url},dataType:"json",success:o,error:function(){C.log("Failed to load page: "+b);location.replace(b)}}));
C.global.adTargeting={};C.utility.hideTower();C.utility.profiler.reset();C.global.navigationStart=(new Date).getTime();typeof C.global.pageObject.destroy==="function"&&C.global.pageObject.destroy();Eggshell.find("C.common.tracking").trigger("reset").trigger("push class matcher","C.common.autosuggest");Eggshell.destroyAll();var c=Eggshell.create("C.eggshell.component.ajax.client");Eggshell.trigger(c,"flush all");C.dom.$window.trigger("pageunload")},o=function(b,g,l){$(window).off("scroll");$(window).scroll(function(){$(".chg-header").css({left:-$(this).scrollLeft()})});
C.global.headerAutosuggest&&Eggshell.find(C.global.headerAutosuggest).trigger("render",{ajaxEndpoint:"_ajax/search/globallist",target:$(".chg-header .autosuggest-input-field"),filters:{type:"group"}});$(".chg-hdr-v3").length>0&&Eggshell.find("C.global.header").trigger("show search box").trigger("show user distractions").trigger("page refreshed");for(g=g=0;g<a.length;g++)if(a[g]===l)break;if(g>=c)if(c=g,C.global.domLoading=(new Date).getTime(),j[c]=0,k[c]=0,d={},f=e=!1,d=b,C.logger.loadTime=d.loadTime,
C.logger.pageTrackId=d.pageTrackId,C("global.cs"),C.global.cs.heapFired=!1,d.redirect)C.utility.replace(d.redirect);else{C.dom.$content.empty();$('link[data-scope="content"]').each(function(){this.disabled=!0});$("title").html(d.title);d.fixedWidth?C.dom.$container.addClass("no-resize"):C.dom.$container.removeClass("no-resize");d.hiddenGlobalNav?$(".chg-body").addClass("no-nav"):$(".chg-body").removeClass("no-nav");!d.nav||jQuery.isEmptyObject(d.nav)?$(".chg-body").addClass("no-subnav"):$(".chg-body").removeClass("no-subnav");
d.showViewMobileSiteButton&&P();u(d.nav);j[c]+=d.css.length;k[c]+=d.js.length;A();for(var n in d.css){n=d.css[n];var o=c;x(n,function(){p("css",o)})}for(var q in d.js)q=d.js[q],function(a,b){C.dom.$window.queue("chg-js-"+b,function(){J(a,function(){p("js",b)})})}(q,c);$(function(){timer=setTimeout(function(){Eggshell.find("C.global.coupon").trigger("show coupon tooltip")},1E3)});C.dom.$window.dequeue("chg-js-"+c)}},u=function(a){if(!a||jQuery.isEmptyObject(a))C.dom.$nav.html("");else{var b="",c="main";
a.main.selected&&(c="main selected");var d=a.main.label;d&&d.length>20&&(d=d.substr(0,17)+"...");var d=C.utility.escapeHtml(d),e=C.utility.escapeHtml(a.main.url);b+='<a href="'+e+'" class="'+c+'"><span class="nav-label">'+d+"</span></a> ";if(a.list)for(var f in a.list){f=a.list[f];c="";f.selected&&(c="selected");var d=C.utility.escapeHtml(f.url),e=C.utility.escapeHtml(f.img),g=C.utility.escapeHtml(f.label);b+='<a href="'+d+'" class="'+e+" "+c+'"><span class="nav-label">'+g+"</span></a> "}C.dom.$nav.html('<div class="row"><div class="col-12 col-first col-last">'+
b+"</div></div>")}},p=function(a,b){a=="css"?j[b]--:a=="js"&&(C.dom.$window.dequeue("chg-js-"+b),k[b]--);A()},A=function(){j[c]==0&&(e||(e=!0,C.dom.$content.html(d.html),setTimeout(r,0)));if(k[c]==0&&j[c]==0&&!f)f=!0,C.utility.closeGlobalNav(animate=!1),C.global.domInteractive=(new Date).getTime(),d.init?($.globalEval("C.global.pageObject = "+d.init),typeof C.global.pageObject.postConstruct=="function"&&C.global.pageObject.postConstruct()):C.global.pageObject={},C.global.pageOnload(),C.dom.$html.css("cursor",
"auto"),$(window).trigger("navigatePage",[location.href,"ajax"])},z={},x=function(a,b){var c,d;z[a]?(z[a][0].disabled=!1,b()):(c=$('<link id="css_'+a+'" rel="stylesheet" type="text/css" href="'+a+'" media="all" data-scope="content" />').appendTo(document.head),z[a]=c,d=setTimeout(function(){d=null;b()},1E3),c=new Image,c.src=a,c.onerror=function(){d&&(clearTimeout(d),setTimeout(function(){b()},250))})},J=function(a,b){C.global.cachedJS[a]?b():C.utility.loadScript(a,function(){C.global.cachedJS[a]=
!0;b()})};try{C.global.navigationStart=performance.timing.navigationStart,C.global.domLoading=performance.timing.domLoading,C.global.domInteractive=performance.timing.domInteractive,C.dom.$window.load(function(){setTimeout(function(){C.global.domComplete=performance.timing.domComplete},0)})}catch(N){C.global.navigationStart=0,C.global.domLoading=0,C.global.domInteractive=0,C.global.domComplete=0}C.global.pageOnload=function(){C.utility.processPlaceholders();C.utility.reflowSubNav();C.support.touch&&
C.dom.$nav.css("position","absolute");this.coupon=Eggshell.create("C.global.coupon",{el:$(".chg-hdr-coupon-area",this.$el)});Eggshell.immuneToDestroyAll(this.coupon);C.global.domComplete=(new Date).getTime();C.utility.profiler.show();C.utility.checkPollution();var a=Eggshell.create("C.common.advertisements");Eggshell.trigger(a,"render")};History.enabled&&(C.dom.$body.observe("click.cheggNavigation","a:not([data-noajax]):not([href^=javascript])",b,C.dom.$window),C.dom.$window.on("statechange",function(){g(History.getState().url)}),
setTimeout(function(){C.dom.$body.unobserve("click.cheggNavigation",C.dom.$window)},18E5));$(window).scroll(function(){$(".chg-header").css({left:-$(this).scrollLeft()})});if($(".chg-hdr-v3").length==0){$(".chg-header-autosuggest").append('<form class="chg-search-form" action="/search" onsubmit="return false"><a data-type="button" class="autosuggest-search-btn search-magnify-btn" href="#"><span class="icn-magnify">Submit</span></a><input id="autosuggest-input" name="autosuggest-input" class="autosuggest-input-field form-input-sm" type="text" placeholder="Find books, solutions, tutors and more..." autocomplete="off"><a class="autosuggest-search-cancel search-magnify-btn-close autosuggest-search-cancelgit  href="#"><span class="icon-x">Close</span></a></form><div class="autosuggest-input-search-container"></div>');
var F=Eggshell.create("C.common.search",{el:$(".autosuggest-input-search-container")}).trigger("render",{ajaxEndpoint:"_ajax/search/globallist",target:$(".chg-header .autosuggest-input-field"),filters:{type:"group"}});Eggshell.immuneToDestroyAll(F);C.global.headerAutosuggest=F;$(".chg-header-autosuggest").click(function(a){a.stopPropagation()});$(window).click(function(){F.trigger("hide results")});b=Eggshell.create("C.global.coupon",{el:$(".chg-hdr-coupon-area")});Eggshell.immuneToDestroyAll(b);
$(".chg-cart-area").after('<div class="chg-cart-component"></div>');$(".chg-cart-area").remove();var n=Eggshell.create("C.global.header.rightsection.cart",{el:$(".chg-cart-component")}).trigger("render");Eggshell.immuneToDestroyAll(n);C.utility.showCouponDialog=$.proxy(function(a,b,c){this.trigger("open coupon dialog",{title:a,disclaimer:b,code:c})},b);b=Eggshell.create("C.global.promo");Eggshell.immuneToDestroyAll(b);C.global.userAvatar!=""&&function(){var a=$(".chg-header .hdr-small-avatar").empty(),
a=Eggshell.create("C.common.avatar",{el:a}).trigger("set avatar id",C.global.userUuid).trigger("set size","xsmall").trigger("update avatar image url",C.global.userAvatar);Eggshell.immuneToDestroyAll(a)}()}this.getUserDropdownContent=function(){return'<div class="hdr-nav"><div class="hdr-profile clearfix"><div class="hdr-profile-img track-user-avatar"></div><div class="hdr-profile-info"><div class="hdr-profile-name"><a href="'+C.global.liveSiteUrl+'my/profile" class="track-my-profile capitalized">'+
C.utility.escapeHtml(C.global.userFirstName+" "+C.global.userLastName)+'</a></div><div class="hdr-profile-email">'+C.global.userEmail+'</div><div class="hdr-profile-links"><a href="'+C.global.liveSiteUrl+'my/profile" class="track-my-profile">My profile</a></div></div></div><div class="hdr-list"><a href="'+C.global.cheggSiteSecureUrl+'my/account" class="track-my-account" rel="nofollow">My Account</a><a href="'+C.global.cheggSiteSecureUrl+'my/account/tracker" class="track-track-books" rel="nofollow">Track Books</a><a href="'+
C.global.cheggSiteSecureUrl+'my/account/returnbooks" class="track-return-books" rel="nofollow">Return Books</a><a href="'+C.global.cheggSiteSecureUrl+'my/account/extendables" class="track-extend" rel="nofollow">Extend / Purchase</a><a href="'+C.global.liveSiteUrl+'sell-textbooks" class="track-sell-books" rel="nofollow">Sell Books</a><a href="'+C.global.cheggSiteSecureUrl+'my/orders" class="track-view-orders" rel="nofollow">View Orders</a><a href="'+C.global.liveSiteUrl+'contactus" class="track-help" rel="nofollow">Help</a><a href="'+
C.global.liveSiteUrl+"signout?token="+C.global.csrfToken+'" class="track-signout" rel="nofollow" data-noajax>Sign Out</a></div></div>'};b=this.getUserDropdownContent();this.userDropdownWidget=new C.widget.popup({el:".chg-header-username",template:"headerGray",width:"300px",content:b,trigger:"click",side:"bottom",margin:4,padding:0,overhang:235,pointerEdgePadding:250,hideTimeout:0,resizeClose:!0,afterInsertCallback:function(){Eggshell.create("C.common.avatar",{el:$(".hdr-profile-img")}).trigger("set avatar id",
C.global.userUuid).trigger("set size","large").trigger("set avatar link url",C.global.liveSiteUrl+"my/profile").trigger("update avatar image url",C.global.userAvatar)}});var D=new C.widget.popup({el:".chg-header-more",template:"header",width:"220px",content:'<div class="hdr-nav"><div class="hdr-list"><a href="'+C.global.cheggSiteUrl+'signup" class="track-signup">Create an account</a><a href="'+C.global.cheggSiteUrl+'login/?redirect=/my/account/returnbooks" class="track-returnbooks" data-noajax>Return your books</a><a href="'+
C.global.liveSiteUrl+'sell-textbooks"  class="track-selltextbooks" data-noajax>Sell your books</a><a href="'+C.global.liveSiteUrl+'contactus"  class="track-help" data-noajax>Help</a></div></div>',trigger:"click",side:"bottom",margin:4,padding:0,overhang:150,pointerEdgePadding:175,hideTimeout:0,resizeClose:!0});C.dom.$header.observe("click",".chg-hdr-root .hdr-nav, .chg-hdr-root .hdr-nav a",function(){this.userDropdownWidget.hidePopup();D.hidePopup()},this);C.logger.referrer_url=document.referrer;
C.dom.$window.observe("resize",C.utility.reflowSubNav,C.dom.$window);C.dom.$nav.observe("click","a",function(a){C.dom.$nav.find(".selected").removeClass("selected");$(a.currentTarget).addClass("selected");History.enabled||q()},C.dom.$window);$(".chg-banner").observe("click",function(){new C.widget.dialog({type:"ajax",content:"_ajax/dialog/browserupgrade"})},C.dom.$window);$(".chg-header-search-form").observe("submit",function(){var a=/\/courses\/([^/#]+)/g.exec(window.location.href);a?C.utility.navigate(C.global.cheggSiteUrl+
"search/"+encodeURIComponent($(".chg-header-search-input").val())+"/courses/"+a[1]):C.utility.navigate(C.global.cheggSiteUrl+"search/"+encodeURIComponent($(".chg-header-search-input").val())+"/books")},C.dom.$window);C.support.touch&&$(".chg-header").css("position","absolute");C.dom.$body.observe("click",".chg-dialog-link",function(a){a.preventDefault();new C.widget.dialog({type:"ajax",content:a.currentTarget.href,fixed:!1});return!1},this);var P=function(){if($(".C-eggshell-viewfullsite-button").length<
1)this.viewFullSiteButtonNS=Eggshell.create("C.eggshell.viewfullsite.button",{el:$(".chg-container-content")}).getNs(),Eggshell.output(this.viewFullSiteButtonNS,"show")};C.global.showViewMobileSiteButton&&P();$(".chg-global-nav-list-item-college-list").length>0&&$.cjax({cache:this.ajaxCache,url:"_ajax/school/transfer",dataType:"json",type:"GET",data:{token:C.global.csrfToken},success:function(a){try{a&&a.transfer&&$(".chg-global-nav-list-item-college-list").removeClass("hidden")}catch(b){}}})});
Eggshell.define("C.global.coupon",{inputs:{render:{payload:null},"open coupon dialog":{payload:null},"apply coupon and open coupon dialog":{payload:"string"},"show coupon tooltip":{payload:null},"refresh coupon":{payload:null},"apply headline button clicked":{payload:null},"apply coupon headline on checkout":{payload:null}},outputs:{"active coupon":{payload:null},"applied coupon successfully":{payload:null},"failed to apply coupon":{payload:null}},newNode:!1,singleton:!0,strict:!0},function(){var b=
Backbone.Model.extend({initialize:function(){},fetchCoupon:function(){return;$.ajax({url:"_ajax/global/coupon/get",type:"post",dataType:"json",context:this,success:$.proxy(function(a){a.id&&(this.set("couponNode",a),this.trigger("loaded"))},this),error:function(){}})},addCoupon:function(a,b){$.ajax({url:"_ajax/global/coupon/apply",type:"get",data:{cp:a,token:C.global.csrfToken},context:this,success:function(a){a.id&&a.id!=null&&(b?(this.set("couponNode",a),this.trigger("couponApplied"),this.trigger("coupon",
a)):(this.set("couponNode",a),this.trigger("couponApplied")))},error:function(){}})}});return Backbone.View.extend({initialize:function(){this.GAevent=Eggshell.create("C.report.GA");this.sessionLogger=Eggshell.create("C.common.log");this.model=new b;this.model.on("loaded",this.render,this);this.model.on("couponApplied",this.handleCouponApplied,this);this.model.fetchCoupon();Eggshell.find(this).on("refresh coupon",function(){this.model.fetchCoupon()}).on("show coupon tooltip",this.createCpnHeadline).on("open coupon dialog",
this.openCouponDialogBox).on("apply coupon and open coupon dialog",function(a,b){this.options.openAppliedCouponInDialog=!0;this.model.addCoupon(b)})},handleCouponApplied:function(){this.options.openAppliedCouponInDialog&&this.couponDialogBox(this.model.get("couponNode"));$(".headline-wrapper").css("display","none");Eggshell.find(this).trigger("applied coupon successfully")},render:function(){var a=this.model.get("couponNode");a.applied===!1&&(this.sessionLogger.trigger("session log",{couponCode:a.code,
action:"Coupon Displayed"}),this.createCpnHeadline())},createCpnHeadline:function(){this.checkURLcoupon();var a=this.model.get("couponNode");this.headlineCpn=Eggshell.create("C.global.coupon.headline",{el:$(".chg-content")}).trigger("render",a).on("apply headline button clicked",this.applyCoupon,this)},reportApplyEvent:function(){this.sessionLogger.trigger("session log",{couponCode:this.model.get("couponNode").code,action:"Coupon Applied"});this.GAevent.trigger("report custom event",{page:"Header",
section:"coupon",link:"apply"})},openCouponDialogBox:function(a,b){var d=b.title,e=b.disclaimer;typeof C.utility.getParams().noApply=="undefined"&&this.model.addCoupon(b.code,!0);this.model.on("coupon",$.proxy(function(a){this.couponDialogBox(this.model.get("couponNode"),d,e);a.stopPropagation()},this))},applyCoupon:function(){$(".headline-wrapper").css("display","none");this.model.addCoupon(this.model.get("couponNode").code);this.model.on("couponApplied",$.proxy(function(){this.couponDialogBox(this.model.get("couponNode"))},
this));this.reportApplyEvent()},checkURLcoupon:function(){var a=this.getQueryVariable("cp");a!="noCp"&&(a==""?C.utility.setCookie("HeadlineNoShow","true",1):(this.model.addCoupon(a,!0),this.model.on("coupon",this.couponDialogBox,this)))},getQueryVariable:function(a){for(var b=window.location.search.substring(1).split("&"),d=0;d<b.length;d++){var e=b[d].split("=");if(e[0]==a)return e[1]}return"noCp"},couponDialogBox:function(a,b,d){if(!b||!d)b=a.title,d=a.disclaimer;a='<div class="auto-apply-coupon-dialog">'+
(a.partnerInfo!=""?'<div class="coupon-partner">'+_.unescape(a.partnerInfo)+"</div>":"")+'<div class="coupon-message">'+b+'</div><div class="coupon-expiration">'+d+'</div><button class="btn-primary-sm">Thanks</button></div>';this.dialog?Eggshell.trigger(this.dialog,"show"):this.dialog=Eggshell.create("C.Eggshell.dialog").trigger("set headline",'<div class="couponIcon"><div class="coupon-added-msg">Coupon added, and will be applied at checkout</div></div>').trigger("disable default padding").trigger("hide sub headline").trigger("hide icon").trigger("set content html",
a).trigger("show").on("close button clicked",$.proxy(function(){$.ajax({url:"_ajax/coupon/shown"})},this));$(".auto-apply-coupon-dialog button").on("click",$.proxy(function(){window.location.pathname.split("/")[1]==="checkout"?(Eggshell.trigger(this.dialog,"hide"),C.utility.refresh()):Eggshell.trigger(this.dialog,"hide")},this))}})}());
Eggshell.define("C.global.promo",{inputs:{render:{payload:null},"open dialog":{payload:null}},outputs:{},newNode:!1,singleton:!0,strict:!0},function(){var b=Backbone.Model.extend({initialize:function(){},fetchPromo:function(){var a=C.utility.getParams();a.mep?$.ajax({url:"_ajax/global/promo/get",type:"POST",dataType:"json",data:{promoCode:a.mep},context:this,success:$.proxy(function(b){b!=null&&(this.set("promoInfo",b),this.set("promoCode",a.mep),this.trigger("loaded"))},this),error:function(){}}):
this.set("promoInfo",null)}});return Backbone.View.extend({initialize:function(){this.model=new b;this.model.on("loaded",this.render,this);this.model.fetchPromo();Eggshell.find(this).on("open dialog",this.openDialog).on("render",this.render)},render:function(){this.openDialog()},openDialog:function(){var a=this.model.get("promoInfo");a.title&&a.body&&a.btnText&&this.promoDialogBox(a)},promoDialogBox:function(a){a='<div class="auto-apply-coupon-dialog"><div class="coupon-message">'+a.title+'</div><div class="coupon-expiration">'+
a.body+'</div><button class="btn-primary-sm">'+a.btnText+'</button><div class="coupon-disclaimer">'+a.disclaimer+"</div></div>";this.dialog?Eggshell.trigger(this.dialog,"show"):(this.dialog=Eggshell.create("C.common.dialog").trigger("disable default padding").trigger("hide sub headline").trigger("hide icon").trigger("hide control").trigger("set content html",a).trigger("show"),this.dialogShown(this.model.get("promoCode")));$(".auto-apply-coupon-dialog button").on("click",$.proxy(function(){Eggshell.trigger(this.dialog,
"hide")},this))},dialogShown:function(a){$.ajax({url:"_ajax/global/promo/shown",type:"POST",dataType:"json",data:{promoCode:a},context:this})}})}());
Eggshell.define("C.global.coupon.headline",{inputs:{render:{payload:{id:"string",code:"string",title:"string",disclaimer:"string",applied:"boolean",path:"string"}},"show headline coupon":{payload:null}},outputs:{"apply headline button clicked":{payload:null}}},Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render).on("show headline coupon",this.showCpnHeadline)},render:function(b,a){this.showCpnHeadline(a);this.delegateEvents()},tmplCouponHeadline:_.template('<div class="C-global-coupon-headline Chgsec_Coupon"><div class="headline-wrapper"><div class="apply-coupon"><div class="coupon-icon"></div><h1><%- coupon.title %><a href="#" class="show-disclaimer">See details...</a></h1></div><div class="coupon-code"><div class="coupon-code-wrapper"><h2>Code: <strong><%- coupon.code %></strong></h2><button class="btn-flat-mini coupon-btn">Apply coupon</button></div></div><div class="disclaimer"><h3><%- coupon.disclaimer %></h3></div></div></div>'),
showCpnHeadline:function(b){if(!(window.location.pathname=="/"&&C.global.userId==""||b.applied===!0)){var a=b.path,c=C.utility.getCookie("HeadlineNoShow");if(a!=null&&c!="true")for(var a=a.split(" "),c=window.location.pathname.split("/"),d=c.length,e=!1,f=0;f<a.length;f++){ConfigPath=a[f].split("/");var j=0;for(place in ConfigPath)if(j+=1,j<=d)if(ConfigPath[place]==c[place]||ConfigPath[place]=="*")e=!0;else{e=!1;break}if(e==!0||a[f]===window.location.pathname){$(".C-global-coupon-headline")&&$(".C-global-coupon-headline").remove();
$(".chg-content").prepend(this.tmplCouponHeadline({coupon:{title:b.title,code:b.code,disclaimer:b.disclaimer,expireDate:b.expireDate,id:b.id,applied:b.applied}}));this.registerHealineListerner(b);break}}}},registerHealineListerner:function(b){$(".C-global-coupon-headline button").click($.proxy(function(a){a.stopPropagation();this.checkHowApply(b)},this));$(".C-global-coupon-headline .show-disclaimer").click($.proxy(function(){this.showDisclaimer()},this))},showDisclaimer:function(){$(".C-global-coupon-headline .disclaimer").css("display",
"block");$(".C-global-coupon-headline .show-disclaimer").css("display","none");$(".C-global-coupon-headline .apply-coupon").css("padding-bottom","0px")},checkHowApply:function(){$(".C-global-coupon-headline").css("display","none");Eggshell.find(this).trigger("apply headline button clicked")}}));
Eggshell.define("C.common.overlay.tooltip",{inputs:{"set target":{payload:"jquery"},"set tooltip size":{payload:"string"},"position caret on top right":{payload:null},"set tooltip border color":{payload:"string"},"get tooltip content node":{payload:null},show:{payload:null},hide:{payload:null},toggle:{payload:null},"enable tooltip on hover":{payload:null},"disable tooltip on hover":{payload:null},"set tooltip below target":{payload:null},"set tooltip above target":{payload:null},"set tooltip on the left of target":{payload:null},
"set tooltip on the right of target":{payload:null},"set text":{payload:"string"},"hide tooltip when user click anywhere else":{payload:null},"acitvate tooltip":{payload:null},"deacitvate tooltip":{payload:null},"enable tooltip slide with screen resize":{payload:null},"position tooltip relative to target":{payload:null}},outputs:{"return tooltip content node":{payload:"jquery"}}},Backbone.View.extend({position:"bottom",initialize:function(){Eggshell.find(this).on("destroy",this.destroy).on("set target",
this.setTarget).on("set tooltip size",this.setSize).on("get tooltip content node",this.getContentNode).on("disable tooltip on hover",this.disableHover).on("show",this.show).on("hide",this.hide).on("toggle",this.toggle).on("set text",this.setText).on("position caret on top right",this.positionCaretRight).on("set tooltip border color",this.setBorderColor).on("enable tooltip slide with screen resize",function(){this.moveWithScreen=!0}).on("position tooltip relative to target",function(){this.positionRelative=
!0}).on("acitvate tooltip",function(){this.dialogOpen=!0}).on("deacitvate tooltip",function(){this.dialogOpen=!1}).on("hide tooltip when user click anywhere else",function(){this.clickWindow=!0}).on("set tooltip below target",function(){this.setPosition(null,"bottom")}).on("set tooltip above target",function(){this.setPosition(null,"top")}).on("set tooltip on the left of target",function(){this.setPosition(null,"left")}).on("set tooltip on the right of target",function(){this.setPosition(null,"right")});
this.render()},destroy:function(){this.hide()},stopParentEvent:function(b){b.stopPropagation()},render:function(){this.$el.html(this.template());this.$el.on("mouseover",$.proxy(this.stopWait,this));this.$el.on("mouseleave",$.proxy(this.waitAndHide,this));this.hide();this.addResizeAbility();this.addScrollDetection();return this},positionCaretRight:function(){this.$(".tooltip-arrow-top").css("margin-left","240px");this.caretRight=!0},setSize:function(b,a){if(a!=="small"&&a!=="large")throw"Invalid tooltip size. Only large and small are supported";
this.$el.removeClass("large small").addClass(a);this.shown&&(this.hide(),this.show())},setBorderColor:function(b,a){if(a!=="orange")throw"Invalid tooltip border color. Only orange is supported";this.$(".tooltip-content").removeClass("orange-border grey-border").addClass("orange-border");this.position==="bottom"?this.$(".tooltip-arrow-top").removeClass("tooltip-arrow-top-grey").addClass("tooltip-arrow-top-orange"):(this.position==="top"||this.position==="right"||this.position==="left")&&this.$(".tooltip-arrow-bottom").removeClass("tooltip-arrow-bottom-grey").addClass("tooltip-arrow-bottom-orange")},
addResizeAbility:function(){$(window).resize($.proxy(function(){this.shown&&(this.hide(),this.show())},this))},addScrollDetection:function(){$(window).scroll($.proxy(function(){this.shown&&(this.hide(),this.show())},this))},template:_.template('<div class="tooltip">   <div class="tooltip-arrow-top tooltip-arrow-top-grey"></div>   <div class="tooltip-content grey-border"></div>   <div class="tooltip-left-shadow"></div><div class="tooltip-arrow-bottom tooltip-arrow-bottom-grey"></div><div class="tooltip-right-shadow"></div></div>'),
setTarget:function(b,a){if(this.$target)throw"Target can only be set once";if(a&&a.jquery)this.$target=a;else if(a&&typeof a!="string")this.$target=$(a);else throw"Invalid target node";this.$target=$.extend({},this.$target);this.enableHover()},setPosition:function(b,a){if(a!="top"&&a!="bottom"&&a!="left"&&a!="right")throw"Invalid position. Position value has to be either top, bottom, left, or right.";this.position=a},enableHover:function(){if(this.$target)this.disableHover(),this.$target.on("mouseover",
$.proxy(this.handleTargetMouseOverEvent,this)),this.$target.on("mouseleave",$.proxy(this.waitAndHide,this));else throw"Please set the target element first";this.$el.on("mouseover",$.proxy(this.stopWait,this));this.$el.on("mouseleave",$.proxy(this.waitAndHide,this))},disableHover:function(){if(this.$target)this.$target.off("mouseover"),this.$target.off("mouseleave");else throw"Please set the target element first";this.$el.off("mouseover");this.$el.off("mouseleave")},getContentNode:function(){Eggshell.find(this).trigger("return tooltip content node",
$.extend({},this.$(".tooltip-content")))},setText:function(b,a){a.length>0&&this.$(".tooltip-content").html(a)},fadeIn:function(){this.$el.show().css("opacity",1)},fadeOut:function(){this.$el.show().css("opacity",0)},hide:function(){this.shown=!1;this.$el.css({visibility:"hidden",opacity:0})},show:function(){if(!(this.dialogOpen==!0||this.$target.css("display")==="none"||this.$target.css("visibility")==="hidden"||this.$target.offset().top===0&&this.$target.offset().left===0)){this.shown=!0;this.$(".tooltip-arrow-bottom").css({"margin-top":"0px"});
this.$el.show().removeClass("tooltip-top tooltip-bottom tooltip-left tooltip-right");var b=this.positionRelative==!0?this.$target.position():this.$target.offset();this.$el.css({"z-index":C.utility.getMaxIndex()+1});if(this.position==="bottom"){this.$el.addClass("tooltip-bottom");var a=b.left-Math.floor(this.$el.outerWidth()/2)+Math.floor(this.$target.outerWidth()/2)+4,b=b.top+this.$target.outerHeight();a+this.$el.width()>$(window).width()&&this.moveWithScreen==!0&&(a=$(window).width()<700?700-this.$el.width():
$(window).width()-this.$el.width());this.caretRight&&(a-=100);this.$el.css({top:b+"px",left:a+"px",visibility:"visible",opacity:1});this.$(".tooltip-arrow-bottom").css({"margin-top":"0px"})}else this.position==="top"?(this.$el.addClass("tooltip-top"),a=b.left-Math.floor(this.$el.outerWidth()/2)+Math.floor(this.$target.outerWidth()/2)+4,b=b.top-this.$el.outerHeight()+1,a+this.$el.width()>$(window).width()&&this.moveWithScreen==!0&&(a=$(window).width()<700?700-this.$el.width():$(window).width()-this.$el.width()),
this.$el.css({top:b+"px",left:a+"px",visibility:"visible",opacity:1}),this.$(".tooltip-arrow-bottom").css({"margin-top":"0px"})):this.position==="left"?(this.$el.addClass("tooltip-left"),a=b.left-200-15+1,b=Math.floor(b.top+this.$target.outerHeight()/2-(this.$el.outerHeight()-20)/2),this.$el.css({top:b+"px",left:a+"px",visibility:"visible",opacity:1}),this.$(".tooltip-arrow-bottom").css({"margin-top":-1*Math.floor(this.$el.outerHeight()/2)+"px"})):this.position==="right"&&(this.$el.addClass("tooltip-right"),
a=b.left+this.$target.outerWidth()+14,b=Math.floor(b.top+this.$target.outerHeight()/2-(this.$el.outerHeight()-20)/2),this.$el.css({top:b+"px",left:a+"px",visibility:"visible",opacity:1}),this.$(".tooltip-arrow-bottom").css({"margin-top":-1*Math.floor(this.$el.outerHeight()/2)+"px"}));this.clickWindow==!0&&this.windowClickHide()}},windowClickHide:function(){this.$el.off("click").on("click",this.stopParentEvent);$("*").on("click."+this.$el.attr("id"),$.proxy(function(){this.$(".tooltip:hover").length==
0&&!this.$target.is(":hover")&&this.hide()},this))},toggle:function(){this.$el.css("visibility")==="hidden"?this.show():this.hide()},waitAndHide:function(){this.timer=setTimeout($.proxy(function(){this.hide()},this),100)},stopWait:function(){clearTimeout(this.timer)},handleTargetMouseOverEvent:function(){this.show();this.stopWait()}}));
Eggshell.define("C.common.search",{inputs:{render:{payload:{ajaxEndpoint:"string",target:"jquery",filters:"object",token:"object"}},renderTabs:{payload:{ajaxEndpoint:"object",target:"jquery",filters:"object",token:"object"}},"position below target automatically":{payload:null},"hide results":{payload:null},"show a single segway":{payload:"string"}},outputs:{"search result item clicked":{payload:"object"}},strict:!1},function(){return Backbone.View.extend({initialize:function(){this.positionAutomaticallyEnabled=
!1;Eggshell.find(this).on("render",this.render).on("position below target automatically",this.positionAutomatically).on("hide results",this.hideResults,this).on("show a single segway",this.showSingleSegway,this)},render:function(b,a){this.layout&&($(a.target).unbind(),typeof $(a.target.prev())!="undefined"&&$(a.target.prev()).unbind(),Eggshell.find(this.layout).destroy());this.layout=typeof a.filters.type!="undefined"&&a.filters.type=="group"?C.global.search?Eggshell.create("C.common.search.tabs",
{el:this.$el}):Eggshell.create("C.common.search.groupV1_6",{el:this.$el}):Eggshell.create("C.common.search.list",{el:this.$el});this.positionAutomaticallyEnabled&&this.layout.trigger("position below target automatically");this.layout.trigger("render",a);Eggshell.immuneToDestroyAll(this.layout)},hideResults:function(){this.layout.trigger("hide")},showSingleSegway:function(b,a){this.layout.trigger("show a single segway",a)},positionAutomatically:function(){this.positionAutomaticallyEnabled=!0}})}());
Eggshell.define("C.common.search.list",{inputs:{render:{payload:{ajaxEndpoint:"string",target:"object",filters:"object",source:"string",token:"string"}},show:{payload:null},hide:{payload:null},update:{payload:{query:"string"}},"go to the next search result":{payload:null},"go to the previous search result":{payload:null},"disable auto resize":{payload:null}},outputs:{},strict:!1},function(){var b=Backbone.Model.extend({load:function(a){this.set("uqry",a.query);$.cjax({url:this.url,type:"get",dataType:"json",
timeout:3E3,data:{query:a.query,filters:this.filters,source:this.source,format:this.filters.format,token:this.token},context:this,success:function(a){this.set("searchResult",a);if(typeof a.trackId!="undefined")C.global.pageObject.opts.searchTrackId=a.trackId;this.trigger("loaded")},error:function(){this.trigger("failToLoad")}})},setup:function(a){this.url=a.ajaxEndpoint;this.target=a.target;this.filters=a.filters;this.source=a.source?a.source:null;this.token=a.token;this.set("target",this.target)}});
return Backbone.View.extend({initialize:function(){this.model=new b;this.model.on("loaded",this.render,this);this.model.on("failToLoad",this.renderError,this);this.model.on("list loaded",this.postRender,this);Eggshell.find(this).on("update",this.load).on("render",this.setup).on("show",this.show).on("hide",this.hide);Eggshell.create("C.Eggshell.window.resize.tracker").on("resize",this.handleResize,this);this.mouseInDropdown=!1},postRender:function(){var a=this.model.get("searchResult").trackId,b=encodeURIComponent(this.model.target.val().replace(/<(?:.|\n)*?>/gm,
""));this.model.source==="tbsglass"?(a=C.global.cheggSiteUrl+"search/"+b+"/textbook-solutions?trackid="+a,this.$searchlist.append('<li><a href="'+a+'"><div class="tbs-view-all chgser_ls chgsub_chgstdy chgsec_tbs_search_view_all">View all search results</div></a></li>')):this.model.source==="qnaglass"&&(a=C.global.cheggSiteUrl+"search/"+b+"/questions-and-answers?trackid="+a,this.$searchlist.append('<li class="qna-view-all"><a href="'+a+'" class="chgser_ls chgsub_chgstdy chgsec_qa_search_view_all">View all search results</a><input type="button" class="btn-secondary-sm post-question-button chgser_ls chgsub_chgstdy chgsec_qa_post" value="Post new question"/></li>'));
this.show()},render:function(){var a="",b="",d=this.model.source;d==="tbsglass"?(a="tbs",b="chgser_ls chgsub_chgstdy chgsec_tbs_autosuggest"):d==="qnaglass"?(a="qna",b="chgser_ls chgsub_chgstdy chgsec_qa_autosuggest"):d==="textbooks"?a="textbooks":(a="tutor",b="chgser_ls chgsub_chgstdy chgsec_tutors_autosuggest");a=a=="textbooks"?this.model.get("searchResult"):this.model.get("searchResult").searchResult[a];$(".search-list").remove();this.$el.append('<ul class="search-list '+b+'"></ul>');this.$searchlist=
$(".search-list");for(var b=this.model.filters.count?this.model.filters.count:5,b=a.length<b?a.length:b,e=0;e<b;e++){e==0&&$(".item-result").addClass("first");d==="qnaglass"&&this.trimText(a[e]);if(d==="tutorsglass")a[e].component="C.common.search.result.subject";a[e].searchBy=this.model.get("uqry");Eggshell.create(a[e].component,{el:$('<li class="item-result" id='+a[e].id+"></li>").appendTo(this.$searchlist)}).trigger("render",a[e])}this.handleResize();this.trigger("list loaded")},trimText:function(a){if(a.transcribedData){if(a.transcribedData.length>
130)a.transcribedData=a.transcribedData.substring(0,130)+"..."}else if(a.text.length>130)a.text=a.text.substring(0,130)+"..."},handleResize:function(){var a=this.model.get("target");this.$searchlist&&(this.model.filters.listPadding!==void 0?this.$searchlist.width(a.width()+this.model.filters.listPadding):this.model.source=="textbooks"?this.$searchlist.width(a.width()+32):this.$searchlist.width(a.width()+20));this.$(".result-header, .result-sub-header, .result-detail").css("maxWidth",a.width()-70+
"px")},show:function(){$(".C-common-search-list").css({visibility:"visible",opacity:"1",display:"block"})},hide:function(){$(".C-common-search-list").css({visibility:"hidden"})},setup:function(a,b){var d={};jQuery.extend(d,b);d.target.prev().click($.proxy(function(){var a=this.getDestination(),b=encodeURIComponent(d.target.val().replace(/<(?:.|\n)*?>/gm,""));C.utility.navigate(C.global.cheggSiteUrl+"search/"+b+"/"+a);return!1},this));d.target.next().click($.proxy(function(a){this.resetSearch(a,d.target)},
this));d.target.keyup($.proxy(function(a){this.onKeyUp(a)},this));d.target.click($.proxy(function(a){this.onKeyUp(a)},this));d.target.blur($.proxy(function(a){this.onTextboxBlur(a,d)},this));this.model.setup(d)},renderError:function(){$(".search-list").remove();this.$el.append($('<ul class="search-list"></ul>'));this.$searchlist=$(".search-list");this.getSearchCategories();var a=this.model.get("target");this.$searchlist.height(115);this.$searchlist.width(a.width()+105+30+15+20)},load:function(a){this.model.load(a)},
resetSearch:function(a,b){a.preventDefault();a.stopPropagation();b.val("");b.next().hide();this.$currentSelectedItem=null},onMouseOverSelection:function(a){a=$(a.target).closest(".item-result");a.length&&($(".search-list").find(".item-result").removeClass("selected"),a.addClass("selected"));this.changeSelection(a)},onMouseOutSelection:function(a){$(a.target).closest(".item-result").removeClass("selected")},generateTrackId:function(){return("000000000"+Math.abs(Math.random()*4294967295<<0).toString(16)).slice(-8)},
onSelectionClick:function(a){this.hide();if(this.$currentSelectedItem==null){if(this.model.source!=="tutorsglass"){var a=encodeURIComponent($(a.target).val().replace(/<(?:.|\n)*?>/gm,"")),b=this.getDestination(),d=this.model.get("searchResult").trackId;typeof d=="undefined"&&(d=this.generateTrackId());C.utility.navigate(C.global.cheggSiteUrl+"search/"+a+"/"+b+"?trackid="+d)}}else(a=this.$currentSelectedItem.find("a").attr("href"))&&C.utility.navigate(C.global.cheggSiteUrl+a);return!1},onKeyUp:function(a){var b=
$(a.target).val().replace(/<(?:.|\n)*?>/gm,"");a.stopPropagation();a.keyCode==40?(this.doNextSelection(a),a.preventDefault(),this.trigger("go to the next search result")):a.keyCode==38?(this.doPrevSelection(a),a.preventDefault(),this.trigger("go to the previous search result")):a.keyCode==27?(this.hide(),this.trigger("hide")):a.keyCode==13?(this.onSelectionClick(a),this.hide(),this.$currentSelectedItem=null):a.keyCode==46||a.keyCode==8?b.length<3?(this.hide(),b.length==0&&$(a.target).next().hide()):
(this.load({query:b}),this.show()):(b.length>0&&$(a.target).next().show(),b.length>=2&&(this.load({query:b}),this.show()))},events:{"mouseover .item-result":"onMouseOverSelection","mouseout .item-result":"onMouseOutSelection","click .item-result a":"onSelectionClick","keydown .search-list":"onKeyUp","mouseenter .search-list":"onMouseEnter","mouseleave .search-list":"onMouseLeave"},hideResults:function(){$(".search-list").hide()},onTextboxBlur:function(a,b){if(!this.mouseInDropdown&&!b.target.is(":focus"))this.hide(),
this.$currentSelectedItem=null},onMouseEnter:function(){if(!this.mouseInDropdown)this.mouseInDropdown=!0},onMouseLeave:function(){if(this.mouseInDropdown)this.mouseInDropdown=!1;this.$currentSelectedItem=null;$(".search-list").find(".item-result").removeClass("selected")},doNextSelection:function(){var a=$(".search-list").find(".item-result"),b=a.index($(".search-list").find(".selected"));a.removeClass("selected");this.changeSelection(b==-1||b>=a.length-1?a.eq(0).addClass("selected"):a.eq(b+1).addClass("selected"))},
doPrevSelection:function(){var a=$(".search-list").find(".item-result"),b=a.index($(".search-list").find(".selected"));a.removeClass("selected");this.changeSelection(b==-1||b===0?a.eq(a.length-1).addClass("selected"):a.eq(b-1).addClass("selected"))},changeSelection:function(a){this.$currentSelectedItem=a},getDestination:function(){switch(this.model.source){case "tbsglass":return"textbook-solutions";case "qnaglass":return"questions-and-answers";case "textbooks":return"books"}return!1}})}());
Eggshell.define("C.common.search.group",{inputs:{render:{payload:{ajaxEndpoint:"string",target:"object",filters:"object"}},show:{payload:null},hide:{payload:null},update:{payload:{query:"string"}},"go to the next search result":{payload:null},"go to the previous search result":{payload:null},"disable auto resize":{payload:null},"position below target automatically":{payload:null}},outputs:{},strict:!1},function(){var b=Backbone.Model.extend({load:function(a){this.set("uqry",a.query);$.ajax({url:this.url,
type:"get",dataType:"json",timeout:3E3,data:{query:a.query,filters:this.filters,bookcount:typeof this.bookcount!="undefined"?this.bookcount:4,tbscount:typeof this.tbscount!="undefined"?this.tbscount:3,count:this.filters.count?this.filters.count:null,source:"group",destination:this.filters.destination,trackid:this.trackid,strackid:this.sessionTrackid},context:this,success:function(a){this.set("searchResult",$.extend(a,{}));this.set("trackId",a.trackId);a==null||a.count==0?this.trigger("failToLoad"):
this.trigger("loaded")},error:function(){this.trigger("failToLoad")}})},setup:function(a){this.url=a.ajaxEndpoint;if(_.has(a,"bookcount"))this.bookcount=a.bookcount;if(_.has(a,"tbscount"))this.tbscount=a.tbscount;this.target=a.target;this.filters=a.filters;this.set("filters",this.filters);this.set("target",this.target)},initialize:function(){this.trackid=this.generateTrackId();this.sessionTrackid=this.generateTrackId();this.set("strackid",this.sessionTrackid);this.set("trackId",this.trackid)},generateTrackId:function(){return("000000000"+
Math.abs(Math.random()*4294967295<<0).toString(16)).slice(-8)}});return Backbone.View.extend({initialize:function(){this.positionAutomaticallyEnabled=!1;this.model=new b;this.model.on("loaded",this.render,this);this.model.on("failToLoad",this.renderError,this);Eggshell.find(this).on("update",this.load).on("render",this.setup).on("show",this.show).on("hide",this.hide).on("show a single segway",$.proxy(function(a,b){this.singleCategory=b},this)).on("position below target automatically",this.positionAutomatically);
Eggshell.create("C.Eggshell.window.resize.tracker").on("resize",this.handleResize,this);this.mouseInDropdown=!1;this.sessionTrackid=this.model.get("strackid")},render:function(){var a=this.model.get("searchResult").searchResult;$(".searchList").remove();this.$el.append($('<ul class="searchList" tabindex="1"></ul>'));this.$searchList=$(".searchList");this.getSearchCategories();var b=0;for(result in a)for(var d=0;d<a[result].length;d++){if(typeof a[result][d].url!="undefined")a[result][d].url+=this.getTrackUrl(a[result][d],
++b),a[result][d].searchBy=this.model.get("uqry");d==0?(this.$searchList.append($('<li class="searchDivider"></li>')),this.$searchList.append($('<li class="category"><div class="category-name"><span>'+a[result][d].type+"</span></div></li>")),Eggshell.create(a[result][d].component,{el:$('<li class="item-result first" id='+a[result][d].id+"></li>").appendTo(this.$searchList)}).trigger("render",a[result][d])):Eggshell.create(a[result][d].component,{el:$('<li class="item-result" id='+a[result][d].id+
"></li>").appendTo(this.$searchList)}).trigger("render",a[result][d])}this.show();this.searchListHeight=this.$searchList.height();this.handleResize()},getTrackUrl:function(a,b){return"?trackid="+a.trackid+"&strackid="+this.sessionTrackid+"&autosuggest=1&ii="+b+"&uqry="+this.model.get("uqry")},getSearchCategories:function(){var a=this.model.generateTrackId(),b=this.model.get("uqry"),a="?trackid="+a+"&strackid="+this.sessionTrackid,d=encodeURIComponent(b.replace(/<(?:.|\n)*?>/gm,"")),e={url:"search/"+
d+"/books/"+a,type:"Books"},f={url:"search/"+d+"/textbook-solutions/"+a,type:"Textbook Solutions"},j={url:"search/"+d+"/questions-and-answers/"+a,type:"Q&A"},k={url:"search/"+d+"/tutors/"+a,type:"Tutors"},a={"textbook-solutions":function(){return[f,j,e]},"questions-and-answers":function(){return[j,f,e]},tutors:function(){return[k,j,f,e]},"single-books":function(){return[e]},"single-tbs":function(){return[f]},"single-qna":function(){return[j]}},d=this.singleCategory?this.singleCategory:this.getLocation();
this.createCategory(a[d]&&a[d]()||[e,f,j],b)},createCategory:function(a,b){for(var d=0;d<a.length;d++)Eggshell.create("C.common.search.result.category",{el:$('<li class="item-result category-result"></li>').appendTo(this.$searchList)}).trigger("render",{url:a[d].url,searchBy:b,type:a[d].type})},getLocation:function(){var a=window.location.pathname,b="";a.indexOf("/")!==-1&&(a=a.split("/"),b=a[3],a[1]=="homework-help"&&a[2]!=void 0&&(b=a[2]=="questions-and-answers"?a[2]:"textbook-solutions"),a[1]==
"tutors"&&(b="tutors"));return b},handleResize:function(){var a=this.model.get("target");this.$searchList=$(".searchList");this.searchListHeight>$(window).height()-100?this.$searchList.height($(window).height()-100):this.$searchList.height("100%");this.$searchList.width(a.outerWidth()+115);this.$(".result-header, .result-sub-header, .result-detail").css("maxWidth",(a.width()*0.8|0)+"px")},show:function(){if(this.positionAutomaticallyEnabled){var a=this.model.get("target"),b=a.offset().top-$(window).scrollTop(),
a=a.offset().left-$(window).scrollLeft();this.$el.css({display:"block",top:b+"px",left:a+"px"})}else this.$el.css({display:"block",top:"50px",position:"absolute"})},hide:function(){$(".C-common-search-group").css({display:"none"})},setup:function(a,b){var d={},e=this.model.generateTrackId();jQuery.extend(d,b);d.target.prev().click($.proxy(function(){var a=encodeURIComponent(d.target.val().replace(/<(?:.|\n)*?>/gm,""));if(typeof this.model.get("filters").destination!="undefined"){if(typeof this.model.get("searchResult").count==
"undefined")var b=0;C.utility.navigate(C.global.cheggSiteUrl+"search/?search_by="+a+"&destination="+this.model.get("filters").destination+"&count="+b+"&trackid="+e+"&strackid="+this.sessionTrackid)}else C.utility.navigate(C.global.cheggSiteUrl+"search/"+a+"/books/?trackid="+e+"&strackid="+this.sessionTrackid);return!1},this));d.target.next().click($.proxy(function(a){this.resetSearch(a,d.target)},this));d.target.keyup($.proxy(function(a){this.onKeyUp(a)},this));d.target.click($.proxy(function(a){this.onKeyUp(a)},
this));d.target.blur($.proxy(function(a){this.onTextboxBlur(a,d)},this));this.model.setup(d);var f=this.model.get("target");$(f).bind("paste",$.proxy(function(a){var b=$(a.target).val().replace(/<(?:.|\n)*?>/gm,"");b.length>0&&$(a.target).next().show();b.length>=2&&this.load({query:b})},this))},renderError:function(){$(".searchList").remove();this.$el.append($('<ul class="searchList"></ul>'));this.$searchList=$(".searchList");this.getSearchCategories();this.searchListHeight=this.$searchList.height();
var a=this.model.get("target");this.$searchList.height("100%");this.$searchList.width(a.width()+105+30-2);this.show()},load:function(a){this.model.load(a)},resetSearch:function(a,b){a.preventDefault();a.stopPropagation();b.val("");b.next().hide();this.$currentSelectedItem=null},onMouseOverSelection:function(a){a=$(a.target).closest(".item-result");a.length&&($(".searchList").find(".item-result").removeClass("selected"),a.addClass("selected"));this.changeSelection(a)},onSelectionClick:function(a){this.model.get("trackId");
if(this.$currentSelectedItem==null){var a=encodeURIComponent($(a.target).val().replace(/<(?:.|\n)*?>/gm,"")),b=this.model.generateTrackId();if(typeof this.model.get("filters").destination!="undefined"){if(typeof this.model.get("searchResult").count=="undefined")var d=0;C.utility.navigate(C.global.cheggSiteUrl+"search/?search_by="+a+"&destination="+this.model.get("filters").destination+"&count="+d+"&trackid="+b+"&strackid="+this.sessionTrackid)}else C.utility.navigate(C.global.cheggSiteUrl+"search/"+
a+"/books/?trackid="+b+"&strackid="+this.sessionTrackid)}else d=this.$currentSelectedItem.find("a").attr("href"),C.utility.navigate(C.global.cheggSiteUrl+d);this.hide();return!1},onKeyUp:function(a){var b=$(a.target).val().replace(/<(?:.|\n)*?>/gm,"");a.stopPropagation();a.keyCode==40?(this.doNextSelection(a),a.preventDefault()):a.keyCode==38?(this.doPrevSelection(a),a.preventDefault()):a.keyCode==27?this.hide():a.keyCode==13?(this.onSelectionClick(a),this.$currentSelectedItem=null):a.keyCode==46||
a.keyCode==8?b.length<3?this.hide():b.length==0?$(a.target).next().hide():this.load({query:b}):(b.length>0&&$(a.target).next().show(),b.length>=2&&this.load({query:b}))},events:{"MSPointerDown .item-result a":"onSelectionClick","mouseover .item-result":"onMouseOverSelection","click .item-result a":"onSelectionClick","keydown .searchList":"onKeyUp","mouseenter .searchList":"onMouseEnter","mouseleave .searchList":"onMouseLeave"},onTextboxBlur:function(a,b){if(!this.mouseInDropdown&&!b.target.is(":focus"))this.hide(),
this.$currentSelectedItem=null},onMouseEnter:function(){if(!this.mouseInDropdown)this.mouseInDropdown=!0},onMouseLeave:function(){if(this.mouseInDropdown)this.mouseInDropdown=!1;this.$currentSelectedItem=null;$(".searchList").find(".item-result").removeClass("selected")},doNextSelection:function(){var a=$(".searchList").find(".item-result"),b=a.index($(".searchList").find(".selected"));a.removeClass("selected");this.changeSelection(b==-1||b>=a.length-1?a.eq(0).addClass("selected"):a.eq(b+1).addClass("selected"));
a=this.$currentSelectedItem.offset().top-82;a<0&&$(".searchList").scrollTop($(".searchList").scrollTop()+a);a=this.$currentSelectedItem.offset().top+this.$currentSelectedItem.outerHeight()-($(".searchList").outerHeight()+$(".chg-system-message").height()+$(".chg-header").height());a>0&&$(".searchList").scrollTop($(".searchList").scrollTop()+a)},doPrevSelection:function(){var a=$(".searchList").find(".item-result"),b=a.index($(".searchList").find(".selected"));a.removeClass("selected");this.changeSelection(b==
-1||b===0?a.eq(a.length-1).addClass("selected"):a.eq(b-1).addClass("selected"));a=this.$currentSelectedItem.offset().top-82;a<0&&$(".searchList").scrollTop($(".searchList").scrollTop()+a);a=this.$currentSelectedItem.offset().top+this.$currentSelectedItem.outerHeight()-($(".searchList").outerHeight()+$(".chg-system-message").height()+$(".chg-header").height());a>0&&$(".searchList").scrollTop($(".searchList").scrollTop()+a)},changeSelection:function(a){this.$currentSelectedItem=a},positionAutomatically:function(){this.positionAutomaticallyEnabled=
!0}})}());
Eggshell.define("C.common.search.autosuggest.heap",{inputs:{"set error":{payload:"object"},"set total":{payload:"number"},"set query text":{payload:"string"},"set query mode":{payload:"string"},"set categories":{payload:"object"},"set corpus by page":{payload:"string"},"set corpus":{payload:"string/array"},"set event":{payload:"object"},"log event":{payload:null},"get corpus":{payload:null},"set trackid":{payload:"string"},"set strackid":{payload:"string"}},outputs:{"corpus result":{payload:"string"}},strict:!1},
function(){var b=Eggshell.create("C.common.log");Eggshell.immuneToDestroyAll(b);var a=function(){this.initialize()},c={Books:"book","Textbook Solutions":"tbs","Q&A":"question",Tutors:"tutor"};a.prototype={query_text:null,query_mode:null,categories:[],categoryTypes:[],total:0,resultItems:[],supportedCustomCorpus:{"textbook-solutions":["tbs_solution"],"questions-and-answers":["question"],tutors:["tutor"],books:["textbook"]},event:null,error:{error_type:"null"},corpus:["textbook","tbs_solution"],initialize:function(){var a=
Eggshell.find(this);a.on("set error",this.setError).on("set total",this.setTotal).on("set query text",this.setQueryText).on("set query mode",this.setQueryMode).on("set categories",this.setCategories).on("set strackid",this.setStrackid).on("set trackid",this.setTrackid).on("set corpus by page",this.setCorpusByPage).on("set event",this.setEvent).on("log event",this.logCustomEvent).on("get corpus",function(){a.trigger("corpus result",this.getCorpus)}).on("set corpus",this.setCorpus,this)},getTrackid:function(){return this.trackid||
null},getStrackid:function(){return this.strackid||null},getQueryText:function(){return this.query_text||""},getQueryMode:function(){return this.query_mode||"autosuggest"},getCorpus:function(){return this.corpus||["textbook","tbs_solution"]},getTotal:function(){return this.total||0},getResultItems:function(){return this.resultItems||[]},getError:function(){return this.error||{error_type:"null"}},fixEntityText:function(a,b){if(a=="textbook")return b.is_ebook===!0?"ebook":"book";else if(a.toLowerCase()===
"careers")return"career";else if(a.toLowerCase()==="colleges")return"school";else if(a.toLowerCase()==="qna")return"question";else if(a.toLowerCase()==="tutors")return"tutor";return a},parseResults:function(a){var b=_.size(this.categories),c=[],a=a&&a.searchResult||[],j=1,k=this;_.each(this.categories,function(a){c.push({search_results_type:"query_suggestion",suggestedquery:a})});_.each(a,function(a,d){b+=_.size(a);var j=_.map(a,function(a){var b=a.id?a.id.toString():"0";return{search_results_type:"entity",
chgentid:a.search_id||b,chgent:k.fixEntityText(d,a),suggestedquery:""}});c.push(j)});c=_.flatten(c);c=_.map(c,function(a){a.chgrank=j;j++;return a});this.total=b;this.resultItems=c},setError:function(a,b){this.error={error_type:"timeout",message:"request to sever timed out"};if(b.type)this.error={error_type:"http",status_code:b.status_code||404,message:b.message||""}},setTrackid:function(a,b){this.trackid=b;return this},setStrackid:function(a,b){this.strackid=b;return this},setTotal:function(a,b){this.total=
b;return this},setQueryText:function(a,b){this.query_text=b;return this},setQueryMode:function(a,b){this.query_mode=b;return this},setCategories:function(a,b){this.categories=[];this.categoryTypes=[];_.each(b,_.bind(function(a){this.categories.push(this.getQueryText()+" in "+a.type);this.categoryTypes.push(c[a.type])},this));return this},setCorpusByPage:function(a,b){this.corpus=this.supportedCustomCorpus[b]||["textbook","tbs_solution"];return this},setCorpus:function(a,b){if(typeof b=="string")this.corpus=
[b];else if(typeof b=="array")this.corpus=b},setEvent:function(a,b){if(b&&b.event)return this.event=b.event,this;this.parseResults(b);this.event={chgcomp:"search",chgsubcomp:"as",chgsec:"nav",search_page_size:this.getTotal(),search_match_count:b&&b.count||0,"event.name":"search_results","event.version":"2.0",query_text:this.getQueryText(),trackid:this.getTrackid(),strackid:this.getStrackid(),query_filters:[],query_mode:this.getQueryMode(),query_corpus:this.getCorpus(),search_page_number:1,search_result_items:this.getResultItems()};
return this},logCustomEvent:_.debounce(function(){this.event!==null&&b.trigger("heap track",this.event)},500)};return a}());
Eggshell.define("C.common.search.serp.heap",{inputs:{"set error":{payload:"object"},"set total":{payload:"number"},"set query text":{payload:"string"},"set query mode":{payload:"string"},"set categories":{payload:"object"},"set corpus by page":{payload:"string"},"set corpus":{payload:"string/array"},"set event":{payload:"object"},"log event":{payload:null},"get corpus":{payload:null},"set page number":{payload:"number"},"set trackid":{payload:"string"},"set strackid":{payload:"string"}},outputs:{"corpus result":{payload:"string"}},
strict:!1},function(){var b=Eggshell.create("C.common.log");Eggshell.immuneToDestroyAll(b);var a=function(){this.initialize()},c={Books:"book","Textbook Solutions":"tbs","Q&A":"question",Tutors:"tutor"};a.prototype={query_text:null,query_mode:null,categories:[],categoryTypes:[],total:0,resultItems:[],supportedCustomCorpus:{"textbook-solutions":["tbs_solution"],"questions-and-answers":["question"],tutors:["tutor"],books:["textbook"]},event:null,error:{error_type:"null"},corpus:["textbook","tbs_solution"],
initialize:function(){var a=Eggshell.find(this);a.on("set error",this.setError).on("set page number",this.setPageNumber).on("set total",this.setTotal).on("set query text",this.setQueryText).on("set strackid",this.setStrackid).on("set trackid",this.setTrackid).on("set query mode",this.setQueryMode).on("set categories",this.setCategories).on("set corpus by page",this.setCorpusByPage).on("set event",this.setEvent).on("log event",this.logCustomEvent).on("get corpus",function(){a.trigger("corpus result",
this.getCorpus)}).on("set corpus",this.setCorpus,this)},getTrackid:function(){return this.trackid||null},getStrackid:function(){return this.strackid||null},getPageNumber:function(){return this.pageNumber||1},getQueryText:function(){return this.query_text||""},getQueryMode:function(){return this.query_mode||"direct_submit"},getCorpus:function(){return this.corpus||["textbook","tbs_solution"]},getTotal:function(){return this.total||0},getResultItems:function(){return this.resultItems||[]},getError:function(){return this.error||
{error_type:"null"}},fixEntityText:function(a,b){if(a.toLowerCase()=="textbook"||a.toLowerCase()=="books")return b.is_ebook===!0?"ebook":"book";else if(a.toLowerCase()==="careers")return"career";else if(a.toLowerCase()==="colleges")return"school";else if(a.toLowerCase()==="qna")return"question";else if(a.toLowerCase()==="tutors")return"tutor";return a},parseResults:function(a){var b=_.size(this.categories),c=[],j=1,k=this;_.each(a&&a.searchResult||[],function(a,d){b+=_.size(a);var j=_.map(a,function(a){var b=
a.id?a.id.toString():"0";return{search_results_type:"entity",chgentid:a.search_id||b,chgent:k.fixEntityText(d,a),suggestedquery:""}});c.push(j)});c=_.flatten(c);c=_.map(c,function(a){a.chgrank=j;j++;return a});this.total=b;this.resultItems=c},setError:function(a,b){this.error={error_type:"timeout",message:"request to sever timed out"};if(b.type)this.error={error_type:"http",status_code:b.status_code||404,message:b.message||""}},setTotal:function(a,b){this.total=b;return this},setTrackid:function(a,
b){this.trackid=b;return this},setStrackid:function(a,b){this.strackid=b;return this},setQueryText:function(a,b){this.query_text=b;return this},setQueryMode:function(a,b){this.query_mode=b;return this},setCategories:function(a,b){this.categories=[];this.categoryTypes=[];_.each(b,_.bind(function(a){this.categories.push(this.getQueryText()+" in "+a.type);this.categoryTypes.push(c[a.type])},this));return this},setCorpusByPage:function(a,b){this.corpus=this.supportedCustomCorpus[b]||["textbook","tbs_solution"];
return this},setCorpus:function(a,b){if(typeof b=="string")this.corpus=[b];else if(typeof b=="array")this.corpus=b},setPageNumber:function(a,b){this.pageNumber=b;return this},setEvent:function(a,b){if(b&&b.event)return this.event=b.event,this;this.parseResults(b);this.event={chgcomp:"search",chgsubcomp:"serp",chgsec:"searchsection",search_page_size:this.getTotal(),search_match_count:b&&b.count||0,"event.name":"search_results","event.version":"2.0",query_text:this.getQueryText(),trackid:this.getTrackid(),
strackid:this.getStrackid(),query_filters:[],query_mode:this.getQueryMode(),query_corpus:this.getCorpus(),search_page_number:this.getPageNumber(),search_result_items:this.getResultItems()};return this},logCustomEvent:_.debounce(function(){this.event!==null&&b.trigger("heap track",this.event)},500)};return a}());
Eggshell.define("C.common.search.groupV1_6",{inputs:{render:{payload:{ajaxEndpoint:"string",target:"object",filters:"object"}},show:{payload:null},hide:{payload:null},update:{payload:{query:"string"}},"go to the next search result":{payload:null},"go to the previous search result":{payload:null},"disable auto resize":{payload:null},"position below target automatically":{payload:null},"show a single segway":{payload:"string"},"set width to size of input field":{payload:null}},outputs:{rendered:{payload:null}},
strict:!1},function(){var b=Eggshell.create("C.common.search.autosuggest.heap");Eggshell.immuneToDestroyAll(b);var a=function(){var a=window.location.pathname,b="";a.indexOf("/")!==-1&&(a=a.split("/"),b=a[3],a[1]=="homework-help"&&a[2]!=void 0&&(b=a[2]=="questions-and-answers"?a[2]:"textbook-solutions"),a[1]=="tutors"&&(b="tutors"));return b},c=Backbone.Model.extend({load:function(c){this.set("uqry",c.query);b.trigger("set query text",c.query).trigger("set corpus by page",a()).trigger("set trackid",
this.trackid).trigger("set strackid",this.sessionTrackid);$.ajax({url:this.url,type:"get",dataType:"json",timeout:3E3,data:{query:c.query,filters:this.filters,bookcount:typeof this.bookcount!="undefined"?this.bookcount:4,tbscount:typeof this.tbscount!="undefined"?this.tbscount:3,count:this.filters.count?this.filters.count:null,source:"group",destination:this.filters.destination,trackid:this.trackid,strackid:this.sessionTrackid},context:this,success:function(a){this.set("searchResult",$.extend(a,{}));
a==null||a.count==0?(b.trigger("set event",[]).trigger("set total",0).trigger("set query mode","autosuggest").trigger("log event"),this.trigger("failToLoad")):(this.set("trackId",a.trackId),this.trigger("loaded"))},error:function(){b.on("corpus result",function(a,f){b.trigger("set event",{event:{chgcomp:"search",chgsubcomp:"as",chgsec:"nav",error:{error_type:"timeout",message:"request to sever timed out"},search_page_size:0,search_match_count:0,"event.name":"search_results","event.version":"1.0",
query_text:c.query,query_filters:[],query_mode:"autosuggest",query_corpus:f,search_page_number:1,search_result_items:[]}}).trigger("log event")});b.trigger("get corpus");this.trigger("failToLoad")}})},setup:function(a){this.url=a.ajaxEndpoint;if(_.has(a,"bookcount"))this.bookcount=a.bookcount;if(_.has(a,"tbscount"))this.tbscount=a.tbscount;this.target=a.target;this.filters=a.filters;this.set("filters",this.filters);this.set("target",this.target)},initialize:function(){this.trackid=this.generateTrackId();
this.sessionTrackid=this.generateTrackId();this.set("strackid",this.sessionTrackid);this.set("trackId",this.trackid)},generateTrackId:function(){return("000000000"+Math.abs(Math.random()*4294967295<<0).toString(16)).slice(-8)}});return Backbone.View.extend({initialize:function(){this.fullWidth=this.positionAutomaticallyEnabled=!1;this.model=new c;this.model.on("loaded",this.render,this);this.model.on("failToLoad",this.renderError,this);Eggshell.find(this).on("update",this.load).on("render",this.setup).on("show",
this.show).on("hide",this.hide).on("show a single segway",$.proxy(function(a,b){this.singleCategory=b},this)).on("position below target automatically",this.positionAutomatically).on("set width to size of input field",$.proxy(function(){this.fullWidth=!0},this));Eggshell.create("C.Eggshell.window.resize.tracker").on("resize",this.handleResize,this);this.mouseInDropdown=!1;this.sessionTrackid=this.model.get("strackid")},render:function(){var a={Books:"book","Textbook Solutions":"tbs","Q&A":"question",
Tutors:"tutor"},b=this.model.get("searchResult").searchResult;$(".searchList").remove();this.$el.append($('<ul class="searchList Chgsec_NavRes" tabindex="1"></ul>'));this.$searchList=this.$el.find(".searchList");this.getSearchCategories();var c=0,j=null,k=this.singleCategory?1:4;for(j in b)for(var l=0;l<b[j].length;l++){if(typeof b[j][l].url!="undefined")b[j][l].url+=this.getTrackUrl(b[j][l],++c),b[j][l].searchBy=this.model.get("uqry");var q=b[j][l].type.replace(" ","_"),r=q==="Books"?"Chgsrv_rm":
"Chgsrv_ls",g=a[b[j][l].type],o=b[j][l].search_id?b[j][l].search_id:b[j][l].id;k++;l==0?(this.$searchList.append($('<li class="searchDivider"></li>')),this.$searchList.append($('<li class="category"><div class="category-name"><span>'+b[j][l].type+"</span></div></li>")),Eggshell.create(b[j][l].component,{el:$('<li class="item-result first Chgsec_NavRes'+q+" "+r+" chgent_"+g+" chgentid_"+o+" chgrank_"+k+'" id='+b[j][l].id+"></li>").appendTo(this.$searchList)}).trigger("render",b[j][l])):Eggshell.create(b[j][l].component,
{el:$('<li class="item-result Chgsec_NavRes'+q+" "+r+" chgent_"+g+" chgentid_"+o+" chgrank_"+k+'" id='+b[j][l].id+"></li>").appendTo(this.$searchList)}).trigger("render",b[j][l])}this.show();this.searchListHeight=this.$searchList.height();this.handleResize();Eggshell.find(this).trigger("rendered")},getTrackUrl:function(a,b){return"?trackid="+a.trackid+"&strackid="+this.sessionTrackid+"&autosuggest=1&ii="+b+"&uqry="+this.model.get("uqry")},getSearchCategories:function(){var c=this.model.generateTrackId(),
e=this.model.get("uqry"),c="?trackid="+c+"&strackid="+this.sessionTrackid,f=encodeURIComponent(e.replace(/<(?:.|\n)*?>/gm,"")),j={url:"search/"+f+"/books/"+c,type:"Books"},k={url:"search/"+f+"/textbook-solutions/"+c,type:"Textbook Solutions"},l={url:"search/"+f+"/questions-and-answers/"+c,type:"Q&A"},q={url:"search/"+f+"/tutors/"+c,type:"Tutors"},f={"textbook-solutions":function(){return[k,l,q,j]},"questions-and-answers":function(){return[l,k,q,j]},tutors:function(){return[q,l,k,j]},"single-books":function(){return[j]},
"single-tbs":function(){return[k]},"single-qna":function(){return[l]},"single-tutors":function(){return[q]}},c=this.singleCategory?this.singleCategory:a(),f=f[c]&&f[c]()||[j,k,l,q];this.createCategory(f,e);b.trigger("set categories",f).trigger("set corpus by page",c).trigger("set event",this.model.get("searchResult"))},createCategory:function(a,b){for(var c=0;c<a.length;c++)rank=c+1,Eggshell.create("C.common.search.result.category",{el:$('<li class="item-result category-result Chgsec_NavResQs chgrank_'+
rank+'"></li>').appendTo(this.$searchList)}).trigger("render",{url:a[c].url,searchBy:b,type:a[c].type})},handleResize:function(){var a=this.model.get("target");this.$searchList=this.$el.find(".searchList");this.searchListHeight>$(window).height()-100?this.$searchList.height($(window).height()-100):this.$searchList.height("100%");this.fullWidth?this.$searchList.width(a.outerWidth()):this.$searchList.width(a.outerWidth()+115);this.$(".result-header, .result-sub-header, .result-detail").css("maxWidth",
(a.width()*0.8|0)+"px")},show:function(){if(this.positionAutomaticallyEnabled){var a=this.model.get("target"),c=a.offset().top-$(window).scrollTop(),a=a.offset().left-$(window).scrollLeft();this.$el.css({display:"block",top:c+"px",left:a+"px"})}else this.$el.css({display:"block",top:"50px",position:"absolute"});b.trigger("set query mode","autosuggest").trigger("log event")},hide:function(){$(".C-common-search-groupV1_6").css({display:"none"})},setup:function(a,c){var f={},j=this.model.generateTrackId();
jQuery.extend(f,c);f.target.prev().click($.proxy(function(){b.trigger("set query mode","button_submit").trigger("log event");var a=encodeURIComponent(f.target.val().replace(/<(?:.|\n)*?>/gm,""));if(typeof this.model.get("filters").destination!="undefined"){var c=this.model.get("searchResult")&&typeof this.model.get("searchResult").count!=="undefined"?this.model.get("searchResult").count:0;_.delay(_.bind(function(){C.utility.navigate(C.global.cheggSiteUrl+"search/?search_by="+a+"&destination="+this.model.get("filters").destination+
"&count="+c+"&trackid="+j+"&strackid="+this.sessionTrackid+"&event=button_submit")},this),250)}else _.delay(_.bind(function(){C.utility.navigate(C.global.cheggSiteUrl+"search/"+a+"/books/?trackid="+j+"&strackid="+this.sessionTrackid+"&event=button_submit")},this),250);return!1},this));f.target.next().click($.proxy(function(a){this.resetSearch(a,f.target)},this));f.target.keyup($.proxy(function(a){this.onKeyUp(a)},this));f.target.click($.proxy(function(a){this.onKeyUp(a)},this));f.target.blur($.proxy(function(a){this.onTextboxBlur(a,
f)},this));this.model.setup(f);var k=this.model.get("target");$(k).bind("paste",$.proxy(function(a){var b=$(a.target).val().replace(/<(?:.|\n)*?>/gm,"");b.length>0&&$(a.target).next().show();b.length>=2&&this.load({query:b})},this))},renderError:function(){this.$el.find(".searchList").remove();this.$el.append($('<ul class="searchList"></ul>'));this.$searchList=this.$el.find(".searchList");this.getSearchCategories();this.searchListHeight=this.$searchList.height();var a=this.model.get("target");this.$searchList.height("100%");
this.fullWidth?this.$searchList.width(a.outerWidth()):this.$searchList.width(a.width()+105+30-2);this.show()},load:function(a){this.model.load(a)},resetSearch:function(a,b){a.preventDefault();a.stopPropagation();b.val("");b.next().hide();this.$currentSelectedItem=null},onMouseOverSelection:function(a){a=$(a.target).closest(".item-result");a.length&&(this.$el.find(".searchList").find(".item-result").removeClass("selected"),a.addClass("selected"));this.changeSelection(a)},onSelectionClick:function(a){this.model.get("trackId");
if(this.$currentSelectedItem==null){var a=encodeURIComponent($(a.target).val().replace(/<(?:.|\n)*?>/gm,"")),b=this.model.generateTrackId();if(typeof this.model.get("filters").destination!="undefined"){var c=this.model.get("searchResult")&&typeof this.model.get("searchResult").count!=="undefined"?this.model.get("searchResult").count:0;C.utility.navigate(C.global.cheggSiteUrl+"search/?search_by="+a+"&destination="+this.model.get("filters").destination+"&count="+c+"&trackid="+b+"&strackid="+this.sessionTrackid+
"&event=enter_submit")}else C.utility.navigate(C.global.cheggSiteUrl+"search/"+a+"/books/?trackid="+b+"&strackid="+this.sessionTrackid+"&event=enter_submit")}else a=this.$currentSelectedItem.find("a").attr("href"),C.utility.navigate(C.global.cheggSiteUrl+a+"&event=click_submit");this.hide();return!1},onKeyUp:function(a){var c=$(a.target).val().replace(/<(?:.|\n)*?>/gm,"");a.stopPropagation();a.keyCode==40?(this.doNextSelection(a),a.preventDefault()):a.keyCode==38?(this.doPrevSelection(a),a.preventDefault()):
a.keyCode==27?this.hide():a.keyCode==13?(b.trigger("set query mode","enter_submit").trigger("log event"),_.delay(_.bind(function(){this.onSelectionClick(a);this.$currentSelectedItem=null},this),250)):a.keyCode==46||a.keyCode==8?c.length<3?this.hide():c.length==0?$(a.target).next().hide():this.load({query:c}):(c.length>0&&$(a.target).next().show(),c.length>=2&&this.load({query:c}))},events:{"MSPointerDown .item-result a":"onSelectionClick","mouseover .item-result":"onMouseOverSelection","click .item-result a":"onSelectionClick",
"keydown .searchList":"onKeyUp","mouseenter .searchList":"onMouseEnter","mouseleave .searchList":"onMouseLeave"},onTextboxBlur:function(a,b){if(!this.mouseInDropdown&&!b.target.is(":focus"))this.hide(),this.$currentSelectedItem=null},onMouseEnter:function(){if(!this.mouseInDropdown)this.mouseInDropdown=!0},onMouseLeave:function(){if(this.mouseInDropdown)this.mouseInDropdown=!1;this.$currentSelectedItem=null;this.$el.find(".searchList").find(".item-result").removeClass("selected")},doNextSelection:function(){var a=
this.$el.find(".searchList").find(".item-result"),b=a.index(this.$el.find(".searchList").find(".selected"));a.removeClass("selected");this.changeSelection(b==-1||b>=a.length-1?a.eq(0).addClass("selected"):a.eq(b+1).addClass("selected"));a=this.$currentSelectedItem.offset().top-82;a<0&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+a);a=this.$currentSelectedItem.offset().top+this.$currentSelectedItem.outerHeight()-(this.$el.find(".searchList").outerHeight()+$(".chg-system-message").height()+
$(".chg-header").height());a>0&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+a)},doPrevSelection:function(){var a=this.$el.find(".searchList").find(".item-result"),b=a.index(this.$el.find(".searchList").find(".selected"));a.removeClass("selected");this.changeSelection(b==-1||b===0?a.eq(a.length-1).addClass("selected"):a.eq(b-1).addClass("selected"));a=this.$currentSelectedItem.offset().top-82;a<0&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+
a);a=this.$currentSelectedItem.offset().top+this.$currentSelectedItem.outerHeight()-(this.$el.find(".searchList").outerHeight()+$(".chg-system-message").height()+$(".chg-header").height());a>0&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+a)},changeSelection:function(a){this.$currentSelectedItem=a},positionAutomatically:function(){this.positionAutomaticallyEnabled=!0}})}());
Eggshell.define("C.common.search.tabs",{inputs:{render:{payload:{ajaxEndpoint:"string",target:"object",filters:"object"}},"position below target automatically":{payload:null}},outputs:{},strict:!1},function(){var b=Eggshell.create("C.common.search.autosuggest.heap");Eggshell.immuneToDestroyAll(b);var a=Backbone.Model.extend({load:function(a){this.set("uqry",a.query);var d=this.ajaxUrls[a.type];this.filters.count=a.type=="tbs"||a.type=="qna"?5:null;b.trigger("set query text",a.query).trigger("set corpus",
this.corpus).trigger("set trackid",this.trackid).trigger("set strackid",this.sessionTrackid);$.ajax({url:d,type:"get",dataType:"json",timeout:3E3,data:{query:a.query,filters:this.filters,bookcount:typeof this.bookcount!="undefined"?this.bookcount:5,tbscount:typeof this.tbscount!="undefined"?this.tbscount:0,count:this.filters.count?this.filters.count:9,source:"group",destination:this.filters.destination,trackid:this.trackid,strackid:this.sessionTrackid},context:this,success:function(a){this.set("searchResult",
$.extend(a,{}));this.set("trackId",a.trackId);a==null||a.count==0?(b.trigger("set event",[]).trigger("set total",0).trigger("set query mode","autosuggest").trigger("log event"),this.trigger("failToLoad")):this.trigger("loaded")},error:function(){b.trigger("set event",{event:{chgcomp:"search",chgsubcomp:"as",chgsec:"nav",error:{error_type:"timeout",message:"request to sever timed out"},search_page_size:0,search_match_count:0,"event.name":"search_results","event.version":"1.0",query_text:a.query,query_filters:[],
query_mode:"autosuggest",query_corpus:this.corpus,search_page_number:1,search_result_items:[]}}).trigger("log event");b.trigger("get corpus");this.trigger("failToLoad")}})},setHeapCorpus:function(a){var b={books:"textbook",tbs:"tbs_solution",qna:"question",tutors:"tutor",careers:"career",colleges:"school"};if(typeof b[a]!=="undefined")this.corpus=b[a]},getHeapCorpus:function(){return this.corpus},setup:function(a){this.target=a.target;this.filters=a.filters;this.ajaxUrls={books:"_ajax/search/globallist",
tbs:"_ajax/search/tbsserp",qna:"_ajax/search/qnaserp",tutors:"_ajax/search/tutors/subjects",careers:"_ajax/search/careers",colleges:"_ajax/search/colleges"};typeof a.filters.destination!="undefined"?this.set("currentTab",a.filters.destination):this.set("currentTab","books");this.setHeapCorpus(this.currentTab);this.tabSearchTerm={books:null,tbs:null,qna:null,tutors:null,careers:null,colleges:null};this.set("tabSearchTerm",this.tabSearchTerm);this.set("filters",this.filters);this.set("target",
this.target)},initialize:function(){this.trackid=this.generateTrackId();this.sessionTrackid=this.generateTrackId();this.set("strackid",this.sessionTrackid);this.set("trackId",this.trackid)},generateTrackId:function(){return("000000000"+Math.abs(Math.random()*4294967295<<0).toString(16)).slice(-8)}});return Backbone.View.extend({template:_.template('<div id="tabs-example"><div class="tab-navs"><div class="tab-nav" id="books" data-anchor="books" >Books</div><div class="tab-nav" id="tbs" data-anchor="tbs">Textbook Solutions</div><div class="tab-nav" id="qna" data-anchor="qna">Q&A</div><div class="tab-nav" id="tutors" data-anchor="tutors">Tutors</div><div class="tab-nav" id="careers" data-anchor="careers">Careers</div><div class="tab-nav" id="colleges" data-anchor="colleges">Colleges</div></div><div class="books-content tab-content selected"></div><div class="tbs-content tab-content"></div><div class="qna-content tab-content"></div><div class="tutors-content tab-content"></div><div class="careers-content tab-content"></div><div class="colleges-content tab-content"></div></div>'),
initialize:function(){this.model=new a;this.model.on("loaded",this.render,this);this.model.on("failToLoad",this.renderError,this);this.positionAutomaticallyEnabled=!1;Eggshell.find(this).on("render",this.setup).on("show",this.show).on("hide",this.hide).on("position below target automatically",this.positionAutomatically);this.sessionTrackid=this.model.get("strackid")},setup:function(a,b){this.model.setup(b);this.currentTab=this.model.get("currentTab");var e=b.target;this.listenInputKeyEvents(e);this.listenForInputFocus(e);
this.listenMagnifyingGlassClick(e);this.listenClearBtnClick(e);this.listenForInputBlur(e);this.$el.append(this.template());this.buildTabs(e)},buildTabs:function(a){var b=Eggshell.create("C.Eggshell.tabs",{el:$("#tabs-example"),needHashTag:!1});b.listen("tab switch",$.proxy(function(b,d){this.currentTab=d.type;this.model.setHeapCorpus(this.currentTab);this.initialTabSelection||(a.click(),a.focus());this.initialTabSelection=!1},this));b.trigger("build tabs");this.selectTab()},selectTab:function(){this.initialTabSelection=
!0;this.$el.find(".tab-nav[data-anchor="+this.currentTab+"]").click()},render:function(){var a=this.model.get("searchResult").searchResult;this.$el.find(".searchList").remove();if(!this.currentTab)this.currentTab=this.model.get("currentTab");var d="."+this.currentTab+"-content";this.$el.find(d).append($('<ul class="searchList" tabindex="1"></ul>'));this.$searchList=this.$el.find(d).find(".searchList");d=0;for(result in a)for(var e=0;e<a[result].length;e++){if(typeof a[result][e].url!="undefined")a[result][e].url+=
this.getTrackUrl(a[result][e],++d),a[result][e].searchBy=this.model.get("uqry");Eggshell.create(a[result][e].component,{el:$('<li class="item-result" id='+a[result][e].id+"></li>").appendTo(this.$searchList)}).trigger("render",a[result][e])}b.trigger("set event",this.model.get("searchResult"));this.show()},renderError:function(){this.$el.find(".searchList").remove();this.$el.append($('<ul class="searchList"></ul>'));this.$searchList=this.$el.find(".searchList");this.model.get("target");this.$searchList.height("100%");
this.$searchList.append($('<li class="no-results">No matching results</li>'));this.show()},show:function(){this.$el.width(this.model.target.outerWidth());this.$el.find(".result-header, .result-sub-header, .result-detail").css("maxWidth",(this.model.target.outerWidth()*0.8|0)+"px");if(this.positionAutomaticallyEnabled){var a=this.model.get("target"),d=a.offset().top-$(window).scrollTop(),a=a.offset().left-$(window).scrollLeft();this.$el.css({display:"block",top:d+"px",left:a+"px"})}else this.$el.css({display:"block",
top:"50px",position:"absolute"});b.trigger("set query mode","autosuggest").trigger("log event")},load:function(a){this.model.load(a)},hide:function(){this.$el.css({display:"none"})},getTrackUrl:function(a,b){return"?trackid="+a.trackid+"&strackid="+this.sessionTrackid+"&autosuggest=1&ii="+b+"&uqry="+this.model.get("uqry")},listenInputKeyEvents:function(a){a.keyup($.proxy(function(a){this.onKeyUp(a)},this))},listenForInputFocus:function(a){a.click($.proxy(function(a){this.onKeyUp(a)},this))},listenForInputBlur:function(a){a.blur($.proxy(function(b){this.onTextboxBlur(b,
a)},this))},listenMagnifyingGlassClick:function(a){a.prev().click($.proxy(function(){b.trigger("set query mode","button_submit").trigger("log event");var d=encodeURIComponent(a.val().replace(/<(?:.|\n)*?>/gm,"")),e=this.model.generateTrackId(),f=this.model.get("searchResult")&&typeof this.model.get("searchResult").count!="undefined"?this.model.get("searchResult").count:0;C.utility.navigate(C.global.cheggSiteUrl+"search/?search_by="+d+"&destination="+this.currentTab+"&count="+f+"&trackid="+e+"&strackid="+
this.sessionTrackid+"&event=button_submit");return!1},this))},listenClearBtnClick:function(a){a.next().click($.proxy(function(b){this.resetSearch(b,a)},this))},onTextboxBlur:function(a,b){if(!this.mouseInDropdown&&!b.is(":focus"))this.hide(),this.$currentSelectedItem=null},onMouseEnter:function(){if(!this.mouseInDropdown)this.mouseInDropdown=!0},onMouseLeave:function(){if(this.mouseInDropdown)this.mouseInDropdown=!1;this.$currentSelectedItem=null;this.$el.find(".searchList").find(".item-result").removeClass("selected")},
onKeyUp:function(a){var d=$(a.target).val().replace(/<(?:.|\n)*?>/gm,"");if(!this.currentTab)this.currentTab=this.model.get("currentTab");var e=this.model.get("tabSearchTerm");a.stopPropagation();a.keyCode==40?(this.doNextSelection(a),a.preventDefault()):a.keyCode==38?(this.doPrevSelection(a),a.preventDefault()):a.keyCode==27?this.hide():a.keyCode==13?(b.trigger("set query mode","enter_submit").trigger("log event"),this.onSelectionClick(a),$(a.target).blur(),this.$currentSelectedItem=null):a.keyCode==
46||a.keyCode==8?d.length<3?this.hide():d.length==0?$(a.target).next().hide():this.load({type:this.currentTab,query:d}):(d.length>0&&$(a.target).next().show(),d.length>=2&&(e[this.currentTab]==null?this.load({type:this.currentTab,query:d}):e[this.currentTab]!==d&&this.load({type:this.currentTab,query:d})))},onSelectionClick:function(a){this.model.get("trackId");if(this.$currentSelectedItem==null){var a=encodeURIComponent($(a.target).val().replace(/<(?:.|\n)*?>/gm,"")),b=this.model.generateTrackId(),
e=this.model.get("searchResult")&&typeof this.model.get("searchResult").count!="undefined"?this.model.get("searchResult").count:0;C.utility.navigate(C.global.cheggSiteUrl+"search/?search_by="+a+"&destination="+this.currentTab+"&count="+e+"&trackid="+b+"&strackid="+this.sessionTrackid+"&event=enter_submit")}else a=this.$currentSelectedItem.find("a").attr("href"),C.utility.navigate(C.global.cheggSiteUrl+a+"&event=click_submit");this.hide();return!1},doNextSelection:function(){var a=this.$el.find(".searchList").find(".item-result"),
b=a.index(this.$el.find(".searchList").find(".selected"));a.removeClass("selected");this.changeSelection(b==-1||b>=a.length-1?a.eq(0).addClass("selected"):a.eq(b+1).addClass("selected"));a=this.$currentSelectedItem.offset().top-82;a<0&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+a);a=this.$currentSelectedItem.offset().top+this.$currentSelectedItem.outerHeight()-(this.$el.find(".searchList").outerHeight()+$(".chg-system-message").height()+$(".chg-header").height());
a>0&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+a)},doPrevSelection:function(){var a=this.$el.find(".searchList").find(".item-result"),b=a.index(this.$el.find(".searchList").find(".selected"));a.removeClass("selected");this.changeSelection(b==-1||b===0?a.eq(a.length-1).addClass("selected"):a.eq(b-1).addClass("selected"));a=this.$currentSelectedItem.offset().top-82;a<0&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+a);a=this.$currentSelectedItem.offset().top+
this.$currentSelectedItem.outerHeight()-(this.$el.find(".searchList").outerHeight()+$(".chg-system-message").height()+$(".chg-header").height());a>0&&this.$el.find(".searchList").scrollTop(this.$el.find(".searchList").scrollTop()+a)},changeSelection:function(a){this.$currentSelectedItem=a},positionAutomatically:function(){this.positionAutomaticallyEnabled=!0},resetSearch:function(a,b){a.preventDefault();a.stopPropagation();b.val("");b.next().hide();this.$currentSelectedItem=null},onMouseOverSelection:function(a){a=
$(a.target).closest(".item-result");a.length&&(this.$el.find(".searchList").find(".item-result").removeClass("selected"),a.addClass("selected"));this.changeSelection(a)},events:{"MSPointerDown .item-result a":"onSelectionClick","mouseover .item-result":"onMouseOverSelection","click .item-result a":"onSelectionClick","keydown .searchList":"onKeyUp","mouseenter .searchList":"onMouseEnter","mouseenter .tab-navs":"onMouseEnter","mouseleave .searchList":"onMouseLeave"}})}());
Eggshell.define("C.common.search.result.default",{inputs:{render:{payload:{id:"string",component:"C.common.search.list.default",url:"string",type:"string",thumbnail:"string",title:"string",desc:"string"}}},outputs:{},strict:!0},function(){return Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render)},render:function(){},events:{}})}());
Eggshell.define("C.common.search.result.book",{inputs:{render:{payload:{id:"string",component:"C.common.search.result.book",url:"string",thumbnail:"string",title:"string",author:"string",isbn:"string",ean:"string",groupName:"string",isFirst:"boolean",type:"string"}}},outputs:{},strict:!1},function(){return Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render);this.bulletSeperatorHTML="&nbsp;&bull;&nbsp;"},render:function(b,a){this.hightLightText(a);this.$el.html(this.template({book:{id:a.id,
component:"C.common.search.result.book",url:a.url,thumbnail:a.cover,title:this.title+(a.edition_no?' <span class="result-header-small">('+this.toOrdinal(a.edition_no)+" Edition)</span>":""),subtitle:this.subtitle?this.subtitle:!1,detail:this.renderAuthor(a.author)+this.bulletSeperatorHTML+"ISBN: "+a.isbn+this.bulletSeperatorHTML+"ISBN13: "+a.ean}}));Eggshell.create("C.common.bookcover",{el:this.$el.find(".book-cover-container")}).trigger("set book image",a.cover).trigger("turn off shadow")},renderAuthor:function(b){return typeof b!=
"undefined"?b.split(";")[0]:""},hightLightText:function(b){var a=RegExp("("+this.regExpQuote(b.searchBy)+")","i");if(b.title)this.title=b.title.replace(a,'<span class="chg-suggest-term">$1</span>');if(b.subtitle)this.subtitle=b.subtitle.replace(a,'<span class="chg-suggest-term">$1</span>');if(this.details)this.details=this.details.replace(a,'<span class="chg-suggest-term">$1</span>')},regExpQuote:function(b){return(b+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},toOrdinal:function(b){var a=b%10;return a==
1&&b!=11?b+"st":a==2&&b!=12?b+"nd":a==3&&b!=13?b+"rd":b+"th"},template:_.template('<div class="book-result"><div class="result-data"><a href="<%= book.url %>"><span class="book-cover-container small bookcover-seo-mini"></span><div class="result-info"><span class="result-header"><%= book.title %></span><% if(book.subtitle!=false){%><span class="result-sub-header"><%= book.subtitle %></span><% } %><span class="result-detail"><%= book.detail %></span></div></a></div></div>')})}());
Eggshell.define("C.common.search.result.3cs",{inputs:{render:{payload:{id:"string",url:"string",name:"string",searchBy:"string"}}},outputs:{},strict:!1},function(){return Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render)},render:function(b,a){this.$el.html(this.subjectTemplate({subject:{url:a.url,id:a.id,nameOriginal:a.name,name:this.highlightText(a)}}));$(".C-common-search-groupV1_6 .category-name").css("padding-top","10px")},highlightText:function(b){var a=
RegExp("("+this.regExpQuote(b.searchBy)+")","i");return b.name.replace(a,'<span class="highlighted-text">$1</span>')},regExpQuote:function(b){return(b+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},subjectTemplate:_.template('<a href="<%= subject.url %>"><div class="tutor-subject-result" data-name="<%= subject.nameOriginal %>" id="<%= subject.id %>"><%= subject.name %></div></a>')})}());
Eggshell.define("C.common.search.result.category",{inputs:{render:{payload:{component:"string",id:"string",searchBy:"string",type:"string",url:"string"}}},outputs:{},strict:!1},function(){return Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render)},render:function(b,a){var c=a.searchBy.charAt(0).toUpperCase()+a.searchBy.slice(1),c=$("<div/>").text(c).html();this.$el.append($('<a href="'+a.url+'"><div class="search-link"><div class="search-icon"></div><span class="chg-suggest-term search-query">'+
c+'</span><span class="search-type"> in '+a.type+"</span></div></a>"))}})}());
Eggshell.define("C.common.search.serp",{inputs:{render:{payload:{ajaxEndpoint:"string",filters:"object",page:"number",size:"number"}}},outputs:{"search result item clicked":{payload:"object"},rendered:{payload:null}},strict:!1},function(){var b=Eggshell.create("C.common.search.serp.heap");Eggshell.immuneToDestroyAll(b);var a=function(){var a=window.location.pathname,b="";a.indexOf("/")!==-1&&(a=a.split("/"),b=a[3],a[1]=="homework-help"&&a[2]!=void 0&&(b=a[2]=="questions-and-answers"?a[2]:"textbook-solutions"),
a[1]=="tutors"&&(b="tutors"));return b},c=function(){var a=C.utility.getParams();return typeof a.event!="undefined"?a.event:"direct_submit"},d=Backbone.Model.extend({load:function(){var d=this.get("payload"),f=d.ajaxEndpoint,j=d.page?d.page:1;b.trigger("set query text",d.query).trigger("set corpus by page",a()).trigger("set query mode",c()).trigger("set page number",j).trigger("set total",10);$.ajax({url:f,type:"get",dataType:"json",data:{query:d.query,filters:{},page:j,size:10,trackid:d.trackid,
strackid:d.strackid},context:this,success:function(a){a==null||a.count==0?(b.trigger("set event",[]).trigger("set total",0).trigger("set query mode","autosuggest").trigger("log event"),this.trigger("failToLoad"),this.set("searchResult",a)):(this.set("searchResult",a),this.trigger("loaded"))},error:function(){b.on("corpus result",function(a,c){b.trigger("set event",{event:{chgcomp:"search",chgsubcomp:"serp",chgsec:"searchsection",error:{error_type:"timeout",message:"request to sever timed out"},search_page_size:0,
search_match_count:0,"event.name":"search_results","event.version":"1.0",query_text:d.query,query_filters:[],query_mode:"autosuggest",query_corpus:c,search_page_number:1,search_result_items:[]}}).trigger("log event")});b.trigger("get corpus");this.trigger("failToLoad")}})}});return Backbone.View.extend({initialize:function(){this.model=new d;this.model.on("loaded",this.render,this);this.model.on("failToLoad",this.renderError,this);Eggshell.find(this).on("render",this.load)},load:function(a,b,c){location.hash&&
typeof c=="undefined"&&(c=location.hash.substr(3));if(typeof c!="undefined")b.page=Number(c),location.hash="#p="+c,this.scrollToTop(),$(".serp-content").remove(),this.showSpinner();a=C.utility.getParams();if(typeof a.trackid!="undefined"&&typeof this.trackid=="undefined")this.trackid=a.trackid;if(typeof a.strackid!="undefined"){if(this.strackid=a.strackid,this.strackid.indexOf("#")!=-1)this.strackid=this.strackid.substring(0,this.strackid.indexOf("#"))}else this.strackid=this.generateTrackId();if(this.trackid)b.trackid=
this.trackid;if(this.strackid)b.strackid=this.strackid;b.query=this.getQuery();this.model.set("payload",b);this.model.load()},render:function(){var a={"Textbook Solutions":"tbs","Q&A":"question",Tutors:"tutor"},c=this.model.get("payload");this.$el.html(this.template({advertisment:c.advertisment}));var d=Eggshell.create("C.common.advertisements");Eggshell.trigger(d,"render");this.createSerpHeader();this.createSerpPagination();this.createLoadingIndicator();$(".serp-content").remove();this.$(".serp-list").append($('<ul class="serp-content"></ul>'));
$serpContent=$(".serp-content");d=this.model.get("searchResult").searchResult;if(typeof c.page=="undefined")c.page=1;var c=(c.page-1)*10,k;for(k in d)for(var l=0;l<d[k].length;l++){var q=a[d[k][l].type],r=d[k][l].search_id?d[k][l].search_id:d[k][l].id,g=l+1;typeof d[k][l].url!="undefined"&&(d[k][l].url+=this.getTrackUrl(d[k][l],++c));d[k][l].component&&Eggshell.create(d[k][l].component,{el:$('<li class="item-result chgent_'+q+" chgentid_"+r+" chgrank_"+g+'" id='+d[k][l].id+"></li>").appendTo($serpContent)}).trigger("render",
d[k][l])}b.trigger("set trackid",this.trackid).trigger("set strackid",this.strackid).trigger("set event",this.model.get("searchResult")).trigger("set query mode","autosuggest").trigger("log event");this.Eggshell.trigger("rendered")},generateTrackId:function(){return("000000000"+Math.abs(Math.random()*4294967295<<0).toString(16)).slice(-8)},getTrackUrl:function(a,b){return this.trackid&&this.strackid?"?trackid="+this.trackid+"&strackid="+this.strackid+"&ii="+b:(this.trackid=a.trackid,"?trackid="+a.trackid+
"&strackid="+this.strackid+"&ii="+b)},getTrackParams:function(){var a=C.utility.json2UriParams(_.pick(this.model.get("payload"),"trackid","strackid"));return a?"?"+a:""},getPopularSubjects:function(){return["Computer Science","Physics","Economics","Writing","Statistics","Accounting","Chemistry","Calculus","Biology","Finance"]},scrollToTop:function(){$("html, body").stop().animate({scrollTop:0},300)},showSpinner:function(){this.loadingIndicator&&this.loadingIndicator.show()},hideSpinner:function(){this.loadingIndicator&&
this.loadingIndicator.hide()},getQuery:function(){return window.location.pathname.split("/")[2]},getQuery2:function(){var a="";query_array=/[\?&]q=([^&#]*)/.exec(location.search);Array.isArray(query_array)&&(a=query_array.pop());return a},renderError:function(){this.$el.html(this.template({advertisment:this.model.get("payload").advertisment}));var a=Eggshell.create("C.common.advertisements");Eggshell.trigger(a,"render");this.createSerpHeader();this.showNoResults()},template:_.template('<div class="row"><div class="col-10 col-first"><div class="serp-container"><div class="serp-headline"></div><div class="serp-subheadline"></div><div class="serp-list Chgsec_Res"></div><div class="serp-pagination Chgsec_Pagination"></div></div></div><div class="col-2 col-last"><div class="chg-ad Chgsec_Ad"><div class="chg-display" data-unit="<%= advertisment %>" data-size="160x600"></div></div></div></div>'),
createLoadingIndicator:function(){this.loadingIndicator=$('<div class="chg-search-loading"><canvas height="30" width="30"></canvas><br/>Loading</div>');this.$el.append(this.loadingIndicator);this.spinner=new C.widget.spinner({canvas:$(".chg-search-loading canvas"),color:"#ffffff"});this.hideSpinner()},createSerpPagination:function(){var a=this.model.get("payload"),b=this.model.get("searchResult");if(typeof a.page=="undefined")a.page=1;this.$pagination=Eggshell.create("C.Eggshell.pagination",{el:this.$(".serp-pagination")}).trigger("totalItemsNum",
b.count).trigger("itemsPerPage",10).trigger("currentPage",a.page).trigger("showPageDesc",!0).trigger("render");$(".C-Eggshell-pagination a").click($.proxy(function(b){var c=$(b.target);pageNumber=Math.max(1,parseInt(c.attr("href"),10));this.load(b,a,pageNumber);return!1},this))},createSerpHeader:function(){a=this.model.get("searchResult");if(typeof a=="undefined")var a={count:0};this.$header=Eggshell.create("C.common.search.serp.header",{el:this.$(".serp-headline")}).trigger("render",{count:a.count,
trackid:this.trackid,strackid:this.strackid})},onMouseOverSelection:function(a){a=$(a.target).closest(".item-result");a.length&&($(".serp-content").find(".item-result").removeClass("selected"),a.addClass("selected"))},onMouseLeaveSelection:function(){$(".serp-content").find(".item-result").removeClass("selected")},parseLink:function(a){a.charAt(0)!="/"&&(a="/"+a);return a},onTutorSelectionClick:function(a){(a=$(a.target).closest(".tutor-card").find("a").attr("href"))&&C.utility.navigate(this.parseLink(a));
return!1},onSelectionClick:function(a){(a=$(a.target).closest(".item-result").find("a").attr("href"))&&C.utility.navigate(this.parseLink(a));return!1},showNoResults:function(){this.hideSpinner();if(this.$(".no-results").length===0){var a=this.getQuery(),a=decodeURIComponent(a),b=window.location.pathname;b.indexOf("/")!==-1&&(b=b.split("/")[3],b=="books"?this.$(".serp-container").append($(this.tmplNoResults({searchTerm:a}))):b=="textbook-solutions"?this.$(".serp-container").append($(this.tmplTBSNoResults({searchTerm:a}))):
b=="questions-and-answers"?this.$(".serp-container").append($(this.tmplQNANoResults({searchTerm:a}))):b=="tutors"&&($("#tutors-search-content .placeholder").hide(),this.$(".serp-list").append($(this.tmplTutorNoResults({searchTerm:a,links:this.getPopularSubjects(),trackParams:this.getTrackParams()})))))}},showNoResults2:function(){this.hideSpinner();if(this.$(".no-results").length===0){var a=this.getQuery(),a=decodeURIComponent(a),b=window.location.pathname;b.indexOf("/")!==-1&&(b=b.split("/"),Array.isArray(b)&&
b[2]&&(b=b[2],b=="books"?this.$(".serp-container").append($(this.tmplNoResults({searchTerm:a}))):b=="textbook-solutions"?this.$(".serp-container").append($(this.tmplTBSNoResults({searchTerm:a}))):b=="questions-and-answers"?this.$(".serp-container").append($(this.tmplQNANoResults({searchTerm:a}))):b=="tutors"&&($("#tutors-search-content .placeholder").hide(),this.$(".serp-list").append($(this.tmplTutorNoResults({searchTerm:a,links:this.getPopularSubjects(),trackParams:this.getTrackParams()}))))))}},
events:{"mouseover .item-result":"onMouseOverSelection","mouseleave .serp-content":"onMouseLeaveSelection","click .item-result .tutor-card a":"onTutorSelectionClick","click .item-result a":"onSelectionClick"},tmplNoResults:_.template('<div class="no-results"><div class="no-results-img"><img src="/s/search/images/gary_no_serp_results.png"/></div><div class="no-results-txt"><p class="title-1">Hmmmm....</p><p class="title-2">We can\'t find <span class="search-term"><%= searchTerm %></span></p><p class="title-3"><span class="title-bold">Double check the ISBN or spelling.</span><span> You can search title, ISBN or author\'s name.</span></p></div></div>'),
tmplTBSNoResults:_.template('<div class="no-results"><div class="no-results-txt"><p class="title-1">Hmmmm....</p><p class="title-2">We can\'t find any textbook solutions for <span class="search-term"><%= searchTerm %></span></p><p class="title-2">Please double check the ISBN or spelling.<br><span class="subtext"> You can search title, ISBN or author\'s name.</span></p></div></div>'),tmplQNANoResults:_.template('<div class="no-results"><div class="no-results-txt"><p class="title-1">Hmmmm....</p><p class="title-2">We can\'t find any questions for <span class="search-term"><%= searchTerm %></span></p></div></div>'),
tmplTutorNoResults:_.template('<div class="no-results"><div class="no-results-txt"><p class="title-1">Hmmmm....</p><p class="title-2">We can\'t find any tutoring for <span class="search-term"><%= searchTerm %></span></p><p class="title-2">Select one of the popular tutoring subjects on InstaEDU</p></div><ul class="popular-subjects"><% _.each(links, function(link){ %><li><a href="/search/<%- link.replace(\' \', \'-\') %>/tutors/<%- trackParams %>"><%- link %></a></li><% }) %></ul><div class="instaedu-logo"></div></div>')})}());
Eggshell.define("C.common.search.serp.header",{inputs:{render:{payload:{count:"string",trackid:"string",strackid:"string"}}},outputs:{"search result item clicked":{payload:"object"}},strict:!1},function(){return Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render)},render:function(b,a){var c=this.getQuery();if(a.count>500)a.count="500+";this.$el.prepend(this.template({headline:{count:a.count,trackid:a.trackid,strackid:a.strackid,query:decodeURIComponent(c),urlquery:c}}));
this.getSelectedTab()},onTabClick:function(b){b.preventDefault();b=$(b.target).find("a").attr("href");C.utility.navigate(C.global.cheggSiteUrl+b);return!1},getSelectedTab:function(){var b=window.location.pathname;b.indexOf("/")!==-1&&(b=b.split("/")[3],b=="books"?this.$el.find(".books").addClass("selected"):b=="textbook-solutions"?this.$el.find(".textbook-solutions").addClass("selected"):b=="questions-and-answers"?this.$el.find(".questions-and-answers").addClass("selected"):b=="tutors"?this.$el.find(".tutors").addClass("selected"):
b=="careers"&&C.global.search==!0?this.$el.find(".careers").addClass("selected"):b=="colleges"&&C.global.search==!0&&this.$el.find(".colleges").addClass("selected"))},getQuery:function(){var b=window.location.pathname,a="";b.indexOf("/")!==-1&&(a=b.split("/")[2]);return a},events:{"click .serp-single-tab a":"onTabClick"},template:_.template('<div class="serp-header"><div class="serp-tabs Chgsec_Tab"><a href="/search/<%-headline.urlquery%>/books?trackid=<%- headline.trackid %>&strackid=<%- headline.strackid %>" class="serp-single-tab books Chgsec_TabBook Chgsrv_rm"><h2>Books</h2></a><a href="/search/<%-headline.urlquery%>/textbook-solutions?trackid=<%- headline.trackid %>&strackid=<%- headline.strackid %>" class="serp-single-tab textbook-solutions Chgsec_TabTbs Chgsrv_ls"><h2>Textbook Solutions</h2></a><a href="/search/<%-headline.urlquery%>/questions-and-answers?trackid=<%- headline.trackid %>&strackid=<%- headline.strackid %>" class="serp-single-tab questions-and-answers Chgsec_TabQs Chgsrv_ls"><h2>Q&A</h2></a><a href="/search/<%-headline.urlquery%>/tutors?trackid=<%- headline.trackid %>&strackid=<%- headline.strackid %>" class="serp-single-tab tutors Chgsec_TabTutor Chgsrv_ls"><h2>Tutors</h2></a><%if (C.global.search == true) { %><a href="/search/<%-headline.urlquery%>/careers?trackid=<%- headline.trackid %>&strackid=<%- headline.strackid %>#search=<%-headline.urlquery%>" class="serp-single-tab careers"><h2>Careers</h2></a><% } %><%if (C.global.search == true) { %><a href="/search/<%-headline.urlquery%>/colleges?trackid=<%- headline.trackid %>&strackid=<%- headline.strackid %>#searchWord=<%-headline.urlquery%>" class="serp-single-tab colleges"><h2>Colleges</h2></a><% } %></div><div class="result-details"><h2><span class="result-count"><%- headline.count %> </span>results for<span class="result-query"> <%- headline.query %></span></h2></div></div>')})}());
Eggshell.define("C.global.header",{inputs:["render","hide user distractions","show user distractions","hide all overlays","update user menu","expand search box","collapse search box"],output:["rendered component"]},function(){this.render=function(){if($(".chg-hdr-v3").length==0)return"";headerEl=$(".chg-hdr-v3");this.navEvents=Eggshell.create("C.global.header.navigation",{targetEl:headerEl.find(".chg-hdr-navigation")}).trigger("load events");this.searchBox=Eggshell.create("C.global.header.searchbox",
{el:headerEl.find(".chg-hdr-search-box")}).trigger("render");this.rightSection=Eggshell.create("C.global.header.rightsection",{el:headerEl.find(".chg-hdr-right-section")}).trigger("render");Eggshell.immuneToDestroyAll(this.navEvents);Eggshell.immuneToDestroyAll(this.searchBox);Eggshell.immuneToDestroyAll(this.rightSection);Eggshell.connect(this.searchBox,"search field start expanding",this.navEvents,"collapse navigation items");Eggshell.connect(this.searchBox,"search field collapsed",this.navEvents,
"expand navigation items");Eggshell.connect(this.navEvents,"navigation items start expanding",this.searchBox,"collapse search box");Eggshell.connect(this.navEvents,"hover menu opened",Eggshell.find(this),"hide all overlays")};this.hideSearchBox=function(){this.searchBox.trigger("hide search box")};this.showSearchBox=function(){this.searchBox.trigger("show search box")};this.pageRefreshed=function(){this.navEvents.trigger("refresh nav");this.rightSection.trigger("page refreshed");this.searchBox.trigger("enable auto collapse of searchbox")};
this.hideAllOverlays=function(){this.searchBox.trigger("close search results");this.rightSection.trigger("close right section overlays")};this.updateUserMenu=function(){Eggshell.find("C.global.header.rightsection.usermenu").trigger("update template")};this.expandSearchBox=function(){this.searchBox.trigger("expand search box")};this.collapseSearchBox=function(){this.searchBox.trigger("collapse search box")};this.disableAutoCollapse=function(){this.searchBox.trigger("disable auto collapse of searchbox")};
this.enableAutoCollapse=function(){this.searchBox.trigger("enable auto collapse of searchbox")};this.setListeners=function(){Eggshell.find(this).on("render",this.render).on("hide search box",this.hideSearchBox).on("show search box",this.showSearchBox).on("page refreshed",this.pageRefreshed).on("hide all overlays",this.hideAllOverlays).on("hide user distractions",this.hideDistractions).on("show user distractions",this.showDistractions).on("update user menu",this.updateUserMenu).on("expand search box",
this.expandSearchBox,this).on("collapse search box",this.collapseSearchBox,this).on("disable auto collapse of searchbox",this.disableAutoCollapse,this).on("enable auto collapse of searchbox",this.enableAutoCollapse,this)};this.hideDistractions=function(){$(".chg-hdr-navigation").addClass("hidden");$(".signin-item").length!=0&&$(".chg-hdr-right-section").addClass("hidden")};this.showDistractions=function(){$(".chg-hdr-navigation").removeClass("hidden");$(".signin-item").length!=0&&$(".chg-hdr-right-section").removeClass("hidden")};
this.initialize=function(){this.setListeners()};this.initialize()});
Eggshell.define("C.global.header.navigation",{inputs:["load events"],output:["navigation items expanded","navigation items start expanding"]},function(b){this.$el=b.targetEl;this.setDefaultSelection=function(a){this.$el.find(".nav-item").removeClass("highlight-item");$path=a?a:window.location.pathname;a=$path.indexOf("/books")!=-1||$path.indexOf("/textbooks/")!=-1||$path.indexOf("/my/account/returnbooks")!=-1||$path.indexOf("/shoppingcart")!=-1||$path.indexOf("/checkout/")!=-1||$path.indexOf("/sell-textbooks")!=
-1||$path.indexOf("/selltextbooks")!=-1||$path.indexOf("/etextbooks")!=-1?".books-item":"";a=$path.indexOf("/study")!=-1||$path.indexOf("/textbook-solutions")!=-1||$path.indexOf("/questions-and-answers")!=-1||$path.indexOf("/tutors")!=-1?".study-item":a;a=$path.indexOf("/career-center")!=-1||$path.indexOf("/app/internships")!=-1||$path.indexOf("/learn")!=-1?".career-item":a;a=$path.indexOf("/schools")!=-1||$path.indexOf("/admissions")!=-1?".colleges-item":a;a=$path.indexOf("/scholarships")!=-1?".scholarships-item":
a;a!==""&&this.$el.find(a).addClass("highlight-item")};this.centralizeDivsAndCarrots=function(){$(".nav-item").each(function(a){var a=$($(".nav-item")[a]),b=a.width();a.find(".carrot").css({"margin-left":b/2-10});a.find(".single-box.right").css({"margin-left":b/2-100})})};this.showHoverItems=function(a){$(a.currentTarget).find(".hover-box").css({display:"block"});$(a.currentTarget).find(".carrot").css({display:"block"});$(a.currentTarget).addClass("hover-box-visible");Eggshell.find(this).trigger("hover menu opened")};
this.hideHoverItems=function(a){$(a.currentTarget).find(".hover-box").css({display:"none"});$(a.currentTarget).find(".carrot").css({display:"none"});$(a.currentTarget).removeClass("hover-box-visible")};this.loadHoverEvents=function(){$(this.$el.find(".nav-item")).hover($.proxy(this.showHoverItems,this),this.hideHoverItems)};this.loadClickEvents=function(){this.is_touch_device()?($(".navigation-menu .nav-item").click($.proxy(function(a){a.preventDefault();a.stopPropagation();$(a.currentTarget).find(".hover-box").is(":visible")?
this.hideHoverItems(a):($(".hover-box").is(":visible")&&($(".hover-box").css({display:"none"}),$(".carrot").css({display:"none"})),this.showHoverItems(a),$(".hover-box").is(":visible")?$(".navigation-menu .nav-item").find(".links-section a").click($.proxy(function(a){C.utility.navigate($(a.currentTarget).attr("href"))},this)):C.utility.navigate($(a.currentTarget).find(".nav-item-header").attr("href")))},this)),$("html").click($.proxy(function(){$(".navigation-menu .nav-item:hover").length==0&&$(".navigation-menu .hover-box").is(":visible")&&
($(".navigation-menu .hover-box").css({display:"none"}),$(".navigation-menu .carrot").css({display:"none"}))},this)),$(document).scroll($.proxy(function(){$(".navigation-menu .hover-box").is(":visible")&&($(".navigation-menu .hover-box").css({display:"none"}),$(".navigation-menu .carrot").css({display:"none"}))},this))):$(".nav-item").each($.proxy(function(a){a=$($(".nav-item")[a]);a.find(".nav-item-header").click($.proxy(function(a){if($(a.currentTarget).hasClass("collapsed-item-header"))return"";
this.setDefaultSelection($(a.currentTarget).attr("href"))},this));a.click($.proxy(function(a){this.hideHoverItems(a)},this))},this))};this.loadEvents=function(){this.is_touch_device()||this.loadHoverEvents();this.loadClickEvents()};this.collapse=function(){$(".collapsed-item").removeClass("hidden");$(".navigation-menu").addClass("collapsed-menu");window.outerWidth>1150?$(".collapsed-item .nav-item-header").text("MORE"):$(".collapsed-item .nav-item-header").text("MENU");if(!this.resizeFunctionSet)$(window).resize($.proxy(function(){this.collapse(!0)},
this)),this.resizeFunctionSet=!0};this.expand=function(){if(!this.$el.hasClass("animate")){this.$el.addClass("animate");Eggshell.find(this).trigger("navigation items start expanding");var a=$(".navigation-menu");width=a.width();a.css({width:""});expandedWidth=a.width();a.css({width:width});$(".collapsed-item").addClass("hidden");a.animate({width:expandedWidth+"px"},400,$.proxy(function(){a.css({width:""});a.removeClass("collapsed-menu");this.$el.removeClass("animate");Eggshell.find(this).trigger("navigation items expanded")},
this));$(window).off("resize");this.resizeFunctionSet=!1}};this.refreshNav=function(){this.setDefaultSelection()};this.is_touch_device=function(){return"ontouchstart"in window||"onmsgesturechange"in window};this.setListeners=function(){Eggshell.find(this).on("load events",this.loadEvents).on("collapse navigation items",this.collapse,this).on("expand navigation items",this.expand,this).on("refresh nav",this.refreshNav,this);$(this.$el.find(".collapsed-item")).click($.proxy(function(){this.expand()},
this))};this.initialize=function(){this.centralizeDivsAndCarrots();this.setListeners();this.setDefaultSelection()};this.initialize()});
Eggshell.define("C.global.header.searchbox",{inputs:["render","expand search box","collapse search box","hide","show"],output:["rendered","search field expanded","search field collapsed","search field start expanding","search field start collapsing","disable auto collapse of searchbox","enable auto collapse of searchbox"]},function(b){this.$el=b.el;this.autoCollapse=!0;this.render=function(){this.placeholderText="Find books, solutions, tutors and more...";this.$el.append('<div class="chg-header-autosuggest Chgsec_NavBox"></div><div class="overlay-wrapper"><div class="overlay"></div></div>');
$(".chg-header-autosuggest",this.$el).append('<form class="chg-search-form" action="/search" onsubmit="return false"><a data-type="button" class="autosuggest-search-btn search-magnify-btn Chgsec_NavBoxGo" href="#"><span class="icn-magnify">Submit</span></a><input id="autosuggest-input" name="autosuggest-input" class="header-autosuggest autosuggest-input-field form-input-sm Chgsec_NavBoxQuery" type="text" placeholder="Search" autocomplete="off"><a class="autosuggest-search-cancel search-magnify-btn-close autosuggest-search-cancel"  href="#"><span class="icon-x">Close</span></a></form><div class="autosuggest-input-search-container"></div>');
this.autosuggestWidget=Eggshell.create("C.common.search",{el:$(".autosuggest-input-search-container",this.$el)}).trigger("render",{ajaxEndpoint:"_ajax/search/globallist",target:$(".chg-header .autosuggest-input-field"),filters:{type:"group"}});Eggshell.immuneToDestroyAll(this.autosuggestWidget);C.global.headerAutosuggest=this.autosuggestWidget;$(window).click($.proxy(function(){this.autosuggestWidget.trigger("hide results")},this));$(".chg-header-autosuggest",this.$el).on("click",function(a){a.stopPropagation()});
$(".overlay",this.$el).on("click",$.proxy(function(){this.expand();$("#autosuggest-input, .autosuggest-input-field",this.$el).focus()},this));$(document).on("click",$.proxy(function(a){$(".chg-header-autosuggest",this.$el).not($(a.target).closest(".C-global-header-searchbox").find(".chg-header-autosuggest")).length==1&&this.autoCollapse&&this.collapse()},this));this.Eggshell.trigger("rendered")};this.expand=function(){!this.$el.hasClass("expanded")&&!this.$el.hasClass("animate")&&(this.$el.addClass("animate"),
this.Eggshell.trigger("search field start expanding"),$(".C-global-header-searchbox").animate({width:"580px"},400,$.proxy(function(){$(".C-global-header-searchbox").css({width:""});this.$el.addClass("expanded");this.$el.removeClass("animate");$("#autosuggest-input, .autosuggest-input-field").attr("placeholder",this.placeholderText);this.Eggshell.trigger("search field expanded")},this)))};this.collapse=function(){this.$el.hasClass("expanded")&&!this.$el.hasClass("animate")&&(this.$el.addClass("animate"),
this.Eggshell.trigger("search field start collapsing"),$(".C-global-header-searchbox").animate({width:$(document).width()<=1045?"204px":"260px"},400,$.proxy(function(){$(".C-global-header-searchbox").css({width:""});this.$el.removeClass("expanded animate");this.$el.find("#autosuggest-input, .autosuggest-input-field").attr("placeholder","Search");this.Eggshell.trigger("search field collapsed")},this)))};this.closeSearchResults=function(){this.autosuggestWidget.trigger("hide results")};this.disableAutoCollapse=
function(){this.autoCollapse=!1};this.enableAutoCollapse=function(){this.autoCollapse=!0};this.setListeners=function(){Eggshell.find(this).on("render",this.render,this).on("expand search box",this.expand,this).on("collapse search box",this.collapse,this).on("close search results",this.closeSearchResults,this).on("disable auto collapse of searchbox",this.disableAutoCollapse,this).on("enable auto collapse of searchbox",this.enableAutoCollapse,this)};this.initialize=function(){this.setListeners()};this.initialize()});
Eggshell.define("C.global.header.rightsection",{inputs:["render","show","hide","close right section overlays"],output:["rendered"]},function(b){this.$el=b.el;this.render=function(){this.cart=Eggshell.create("C.global.header.rightsection.cart",{el:this.$el}).trigger("render");this.notifications=Eggshell.create("C.global.header.rightsection.notifications",{el:this.$el});this.userMenu=Eggshell.create("C.global.header.rightsection.usermenu",{el:this.$el}).trigger("render");Eggshell.immuneToDestroyAll(this.cart);
Eggshell.immuneToDestroyAll(this.userMenu);Eggshell.immuneToDestroyAll(this.notifications)};this.closeRightSectionOverlays=function(){this.userMenu.trigger("hide menu");this.notifications&&this.notifications.trigger("close notifications overlays")};this.pageRefreshed=function(){this.cart.trigger("page refreshed",this)};this.setListeners=function(){Eggshell.find(this).on("render",this.render).on("close right section overlays",this.closeRightSectionOverlays,this).on("page refreshed",this.pageRefreshed,
this)};this.initialize=function(){this.setListeners()};this.initialize()});
Eggshell.define("C.global.header.rightsection.cart",{inputs:["render","show","hide"],output:["rendered"]},function(b){this.$el=b.el;this.tmpl='<div class="cart-item nav-item chg-cart-area"><div class="header chg-menu-item track-cart"><span class="chg-cart"></span><span class="chg-cart-count"></span></div><div class="carrot"><div class="carrot-inner"></div></div><div class="cart-hover-content hover-box"></div></div>';this.tmpl2='<a class="chg-cart-area chg-menu-item track-cart nav-item" rel="nofollow" data-noajax="data-noajax" href="'+
C.global.cheggSiteUrl+'shoppingcart/"><span class="chg-cart"></span><span class="chg-cart-count"></span></a>';this.render=function(){C.global.minicart?(this.$el.append(this.tmpl),this.renderMiniCart(),$(".cart-item",this.$el).on("click",$.proxy(function(a){$(a.target).closest(".cart-hover-content, .carrot").length==0&&C.global.minicart.trigger("show")},this)),$(document).on("click",$.proxy(function(a){$(a.target).closest(".nav-item.cart-item").length==0&&C.global.minicart.trigger("hide")},this))):
(this.$el.append(this.tmpl2))};this.renderMiniCart=function(){C.global.minicart=Eggshell.create("C.global.header.minicart",{el:$(".cart-hover-content",this.$el)}).trigger("render");Eggshell.immuneToDestroyAll(C.global.minicart)};this.pageRefreshed=function(){C.global.minicart&&C.global.minicart.trigger("hide")};this.setListeners=function(){Eggshell.find(this).on("render",this.render).on("page refreshed",this.pageRefreshed,this)};this.initialize=function(){this.setListeners()};
this.initialize()});
Eggshell.define("C.global.header.rightsection.notifications",{inputs:["render"],output:["rendered"]},function(b){this.$el=b.el;var a=$("<div class='chg-hdr-notifications' id='notifications-component'></div>");this.$el.append(a);window.lightningjs||function(a){function b(e,j){return j&&(j+=(/\?/.test(j)?"&":"?")+"lv=1"),a[e]||function(){var b=window,r=document,g=e,o=r.location.protocol,u="load",p=0;(function(){function e(){k.P(u);k.w=1;a[g]("_load")}a[g]=function(){function c(){return c.id=f,a[g].apply(c,
arguments)}var e,f=++p;e=this&&this!=b?this.id||0:0;return(k.s=k.s||[]).push([f,e,arguments]),c.then=function(a,b,d){var e=k.fh[f]=k.fh[f]||[],g=k.eh[f]=k.eh[f]||[],j=k.ph[f]=k.ph[f]||[];return a&&e.push(a),b&&g.push(b),d&&j.push(d),c},c};var k=a[g]._={};k.fh={};k.eh={};k.ph={};k.l=j?j.replace(/^\/\//,("https:"==o?o:"http:")+"//"):j;k.p={0:+new Date};k.P=function(a){k.p[a]=new Date-k.p[0]};k.w&&e();b.addEventListener?b.addEventListener(u,e,!1):b.attachEvent("on"+u,e);var x=function(){function a(){return["<head></head><",
b,' onload="var d=',u,";d.getElementsByTagName('head')[0].",j,"(d.",l,"('script')).",o,"='",k.l,"'\"></",b,">"].join("")}var b="body",d=r[b];if(!d)return setTimeout(x,100);k.P(1);var e,j="appendChild",l="createElement",o="src",q=r[l]("div"),p=q[j](r[l]("div")),s=r[l]("iframe"),u="document";q.style.display="none";d.insertBefore(q,d.firstChild).id=c+"-"+g;s.frameBorder="0";s.id=c+"-frame-"+g;/MSIE[ ]+6/.test(navigator.userAgent)&&(s[o]="javascript:false");s.allowTransparency="true";p[j](s);try{s.contentWindow[u].open()}catch(A){k.domain=
r.domain,e="javascript:var d="+u+".open();d.domain='"+r.domain+"';",s[o]=e+"void(0);"}try{var h=s.contentWindow[u];h.write(a());h.close()}catch(O){s[o]=e+'d.write("'+a().replace(/"/g,String.fromCharCode(92)+'"')+'");d.close();'}
k.P(2)};k.l&&x()})()}(),
a[e].lv="1",a[e]}
var c="lightningjs",j=window[c]=b(c);j.require=b;j.modules=a}({});

this.start=function(){c("on",{redirect:function(a){window.location.href=a},"chat:open":function(a){window.location.href=
"/tutors/cuuid/"+a}});c("start")};this.render=function(){c("render",{API_URL:"/tutors/api/v1/",SOCKET_URL:window.location.protocol+"//"+window.location.hostname+"/",SOCKET_PATH:"/tutors/socket.io",CSS_URL:"/tutors/static/css/notifications.css",uid:C.global.userUuid,CHEGG_UUID_CHECKSUM:C.global.uuidChecksum,container:a[0],io:window.SOCKET_IO_IEDU&&window.io?window.io:null});C.global.userUuid&&this.start()};this.hideOverlay=function(){c("toggle",!1)};this.setListeners=function(){Eggshell.find(this).on("render",
this.render).on("close notifications overlays",this.hideOverlay,this)};this.initialize=function(){C.global.userUuid&&C.global.instaEdu&&this.setListeners()};this.initialize()});
Eggshell.define("C.global.header.rightsection.usermenu",{inputs:["render","show","hide","show menu","hide menu","update template"],output:["rendered"]},function(b){this.$el=b.el;this.signOutTmpl=_.template('<a href="<%- cheggSiteUrl %>login" class="signin-item nav-item">Sign in</a><div class="more-item nav-item"><div class="header">More <span class="arrow-down"></span></div><div class="carrot"><div class="carrot-inner"></div></div><div class="more-hover-content hover-box"><ul><li><a href="<%- cheggSiteUrl %>signup" class="track-signup">Create an account</a></li><li><a href="<%- cheggSiteUrl %>login/?redirect=/my/account/returnbooks" class="track-returnbooks" data-noajax>Return your books</a></li><li><a href="<%- liveSiteUrl %>sell-textbooks"  class="track-selltextbooks" data-noajax>Sell your books</a></li><li><a href="<%- liveSiteUrl %>contactus"  class="track-help" data-noajax>Help</a></li></ul></div></div>');this.signInTmpl=
_.template('<div class="user-item nav-item"><div class="header"><span class="avatar"></span><span class="arrow-down"></span></div><div class="carrot"><div class="carrot-inner"></div></div><div class="user-hover-content hover-box"><div class="profile"><div class="track-user-avatar avatar"></div><div class="info"><a class="name track-my-profile capitalized" href="<%- liveSiteUrl %>my/profile"><%= userName %></a><div class="email"><%- userEmail %></div><a class="my-profile track-my-profile" href="<%- liveSiteUrl %>my/profile">My profile</a></div></div><ul><li><a href="<%- cheggSiteSecureUrl %>my/account" class="track-my-account" rel="nofollow">My Account</a></li><li><a href="<%- cheggSiteSecureUrl %>my/account/tracker" class="track-track-books" rel="nofollow">Track Books</a></li><li><a href="<%- cheggSiteSecureUrl %>my/account/returnbooks" class="track-return-books" rel="nofollow">Return Books</a></li><li><a href="<%- cheggSiteSecureUrl %>my/account/extendables" class="track-extend" rel="nofollow">Extend / Purchase</a></li><li><a href="<%- liveSiteUrl %>sell-textbooks" class="track-sell-books" rel="nofollow">Sell Books</a></li><li><a href="<%- cheggSiteSecureUrl %>my/orders" class="track-view-orders" rel="nofollow">View Orders</a></li><li><a href="<%- liveSiteUrl %>contactus" class="track-help" rel="nofollow">Help</a></li><li><a href="<%- liveSiteUrl %>signout?token=<%- csrfToken %>" class="track-signout" rel="nofollow" data-noajax>Sign Out</a></li></ul></div></div>');
this.showMenu=function(){$(".nav-item.user-item, .nav-item.more-item",this.$el).addClass("active")};this.hideMenu=function(){$(".nav-item.user-item, .nav-item.more-item",this.$el).removeClass("active")};this.render=function(){if(C.global.userUuid==="")this.$el.append(this.signOutTmpl({cheggSiteUrl:C.global.cheggSiteUrl,liveSiteUrl:C.global.liveSiteUrl}));else{this.$el.append(this.signInTmpl({cheggSiteSecureUrl:C.global.cheggSiteSecureUrl,liveSiteUrl:C.global.liveSiteUrl,csrfToken:C.global.csrfToken,
userEmail:C.global.userEmail,userName:C.global.userFirstName+" "+C.global.userLastName}));var a=Eggshell.create("C.common.avatar",{el:$(".user-item .header .avatar",this.$el)}).trigger("set avatar id",C.global.userUuid).trigger("set size","xsmall").trigger("set shape","circle").trigger("set border").trigger("update avatar image url",C.global.userAvatar),b=Eggshell.create("C.common.avatar",{el:$(".user-item .user-hover-content .profile .avatar",this.$el)}).trigger("set avatar id",C.global.userUuid).trigger("set size",
"large").trigger("set avatar link url",C.global.liveSiteUrl+"my/profile").trigger("update avatar image url",C.global.userAvatar);Eggshell.immuneToDestroyAll(a);Eggshell.immuneToDestroyAll(b)}$(".nav-item.user-item, .nav-item.more-item",this.$el).on("click",function(){$(this).toggleClass("active")});$(document).on("click",$.proxy(function(a){$(a.target).closest(".nav-item.user-item, .nav-item.more-item").length==0&&$(".nav-item",this.$el).removeClass("active")},this))};this.updateTemplate=function(){this.$el.find(".name").html(C.global.userFirstName+
" "+C.global.userLastName)};this.setListeners=function(){Eggshell.find(this).on("show menu",this.showMenu).on("hide menu",this.hideMenu).on("update template",this.updateTemplate).on("render",this.render)};this.initialize=function(){this.setListeners()};this.initialize()});
Eggshell.define("C.global.header.minicart",{inputs:{render:{payload:null},show:{payload:"object"},hide:{payload:null},"add Items":{payload:"array"},"add Items and refresh":{payload:"array"},"remove Item":{payload:{pricingId:"string"}},refresh:{payload:null},"get cart items":{payload:null}},outputs:{rendered:{payload:null},"items added":{payload:{catalogItemId:"string",pricingId:"string"}},"item removed":{payload:{catalogItemId:"string",pricingId:"string"}},"cart refreshed":{payload:null},"cart refresh failed":{payload:null},
"current cart items":{payload:"array"},"button close clicked":{payload:null},"button checkout clicked":{payload:null}}},function(b){this.$el=b.el;this.tmpl=_.template('<div class="header"><span class="title"><%- label.cart %></span><span class="close"></span></div><div class="content"><ul></ul><div class="loader"></div></div><div class="footer"><div class="total"><span class="savings"><%- label.saving %></span><span class="subtotal"><%- label.subtotal %></span></div><div class="buttons"><span class="message"><%- label.message %></span><a href="/shoppingcart/" data-type="button" class="btn-primary-sm"><%- label.viewcart %></a></div></div>');
this.tmplItem=_.template('<li data-id="<%- item.pricingId %>"<% if(item.type){ %> class="<%- item.type.replace(" ", "-") %>"<% } %>><% if(item.type == "cheggstudy"){ %><a href="#" class="no-click-section"><% } else { %><a href="<%- item.pdpUrl %>"><% } %><span class="cover"><% if(item.imgUrl){ %><img src="<%- coverUrl %><%- item.imgUrl %>" alt="<%- item.title %>"><% } else if(item.type == "cheggstudy" ){ %><img src="/s/shoppingcart/images/cheggstudy.png" alt="<%- item.title %>"><% } else if(item.type == "dac" ){ %><img src="http://c.chegg.com//s/_global/images/dac/img-DAC-100-130.png" alt="<%- item.title %>"><% } %></span><% if(item.type == "cheggstudy"){ %><div class="title">Chegg Study Membership</div><% } else { %><div class="title"><%- item.title %><% if(item.edition){ %> | <%- toOrdinal(item.edition) %> Edition<% } %></div><% } %><% if(item.type){ %><% if(item.type == "dac"){ %><div class="type">Type: Digital Access Code</div><% } else if(item.type == "cheggstudy") { %><div class="type">Type: Membership</div><% } else if(item.type == "Rent") { %><div class="type">Type: Rental Book</div><% } else { %><div class="type">Type: <%- item.type %></div><% } %><% } %><% if(item.dueDate){ %><div class="due-date">Due: <%- item.dueDate %></div><% } %><% if(item.type == "cheggstudy") { %><div class="price"><div class="trial"><%- parseInt(item.freePeriod)/4 %>-wks free</div><div class="per-month">$<%- parseFloat(item.renewalPrice).toFixed(2) %>/month after</div></div><% } else { %><div class="price">$<%- parseFloat(item.price).toFixed(2) %></div><% } %></a></li>');
this.items=[];this.setListeners=function(){Eggshell.find(this).on("render",this.render).on("show",this.show).on("hide",this.hide).on("add Items",this.addItems).on("add Items and refresh",this.addItemsAndRefresh).on("remove Item",this.removeItem).on("refresh",this.refresh).on("get cart items",this.getCartItems)};this.render=function(){this.$el.html(this.tmpl({label:{cart:C.resource.fetch("C.global.header.minicart.cart"),viewcart:C.resource.fetch("C.global.header.minicart.viewcart"),message:C.resource.fetch("C.global.header.minicart.message"),
checkout:C.resource.fetch("C.global.header.minicart.checkout"),saving:C.resource.fetch("C.global.header.minicart.saving",[(0).toFixed(2)]),subtotal:C.resource.fetch("C.global.header.minicart.subtotal",[(0).toFixed(2)])}}));$(".header .close",this.$el).on("click",$.proxy(this.closeClicked,this));$(".footer .buttons a",this.$el).on("click",$.proxy(this.viewCartClicked,this));this.refresh();this.Eggshell.trigger("rendered")};this.show=function(a,b){if(this.items.length!=0||b.force)this.$el.show(),this.$el.parents(".cart-item").addClass("active")};
this.hide=function(){this.$el.hide();this.$el.parents(".cart-item").removeClass("active")};this.refresh=function(){$(".content ul",this.$el).css({visibility:"hidden",opacity:0});$(".loader",this.$el).css({visibility:"visible",opacity:1});$.ajax({url:"_ajax/cart/status",type:"get",dataType:"json",context:this,success:function(a){this.items=[];$(".content ul",this.$el).html("");this.addItems(null,a);$(".content ul",this.$el).css({visibility:"visible",opacity:1});$(".loader",this.$el).css({visibility:"hidden",
opacity:0});this.Eggshell.trigger("cart refreshed")},error:function(){$(".content ul",this.$el).css({visibility:"visible",opacity:1});$(".loader",this.$el).css({visibility:"hidden",opacity:0});this.Eggshell.trigger("cart refresh failed")}})};this.addItems=function(a,b){var d=this.filterItems(b);this.items=d.concat(this.items);this.items.length==0?this.$el.parents(".cart-item").hide():this.$el.parents(".cart-item").show();for(i in d)d[i].type!="rwyw"&&$(".content ul",this.$el).prepend(this.tmplItem({coverUrl:C.global.coversBaseUrl,
item:d[i],toOrdinal:this.toOrdinal}));this.update();this.Eggshell.trigger("items added",_.map(d,function(a){return{catalogItemId:a.catalogItemId,pricingId:a.pricingId}}))};this.filterItems=function(a){var b=_.map(this.items,function(a){return a.catalogItemId}),d=[],e;for(e in a)a[e].type!="rwyw"&&(b.indexOf(a[e].catalogItemId)>-1||d.push(a[e]));return d};this.addItemsAndRefresh=function(a,b){this.addItems(a,b);this.refresh()};this.removeItem=function(a,b){_.find(this.items,$.proxy(function(a,e){if(a.pricingId==
b.pricingId)return this.items.splice(e,1),$(".content ul li[data-id="+a.pricingId+"]").remove(),this.update(),this.Eggshell.trigger("item removed",{catalogItemId:a.catalogItemId,pricingId:a.pricingId}),!0},this))};this.getCartItems=function(){this.Eggshell.trigger("current cart items",this.items)};this.update=function(){var a=_.reduce(this.items,function(a,b){return b.noAddSavings?parseFloat(b.savings):b.savings?a+parseFloat(b.savings):a},0),b=_.reduce(this.items,function(a,b){return a+parseFloat(b.price)},
0);$(".footer .total .savings").html(C.resource.fetch("C.global.header.minicart.saving",[parseFloat(a).toFixed(2)]));$(".footer .total .subtotal").html(C.resource.fetch("C.global.header.minicart.subtotal",[parseFloat(b).toFixed(2)]));$(".chg-cart-count").text(this.items.length)};this.closeClicked=function(a){a.preventDefault();a.stopPropagation();this.hide();this.Eggshell.trigger("button close clicked")};this.viewCartClicked=function(){this.hide();this.Eggshell.trigger("button view cart clicked")};
this.toOrdinal=function(a){var b=a%10;return b===1&&a!==11?a+"st":b===2&&a!==12?a+"nd":b===3&&a!==13?a+"rd":a+"th"};this.initialize=function(){this.setListeners()};this.initialize()});C.resource.add("C.global.header.minicart.cart","Cart");C.resource.add("C.global.header.minicart.viewcart","View Cart");C.resource.add("C.global.header.minicart.message","Free return shipping on all orders");C.resource.add("C.global.header.minicart.checkout","Checkout");
C.resource.add("C.global.header.minicart.saving","Savings: ${0}");C.resource.add("C.global.header.minicart.subtotal","SUBTOTAL: ${0}");
Eggshell.define("C.common.search.serp.book",{inputs:{render:{payload:{id:"string",component:"C.common.search.serp.book",url:"string",thumbnail:"string",title:"string",author:"string",isbn:"string",isbn13:"string",groupName:"string",isFirst:"boolean",type:"string"}}},outputs:{},strict:!1},function(){return Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render);this.bulletSeperatorHTML="&nbsp;&bull;&nbsp;"},render:function(b,a){this.$el.html(this.template({book:{id:a.id,
url:a.url,title:a.title+(a.editionNo?" ("+this.toOrdinal(a.editionNo)+" Edition)":""),subtitle:a.subtitle?a.subtitle:!1,author:a.author,isbn13:a.isbn13,isbn:a.isbn}}));Eggshell.create("C.common.bookcover",{el:this.$el.find(".book-cover-container")}).trigger("set book image",a.thumbnail).trigger("set book cover size","medium")},toOrdinal:function(b){var a=b%10;return a==1&&b!=11?b+"st":a==2&&b!=12?b+"nd":a==3&&b!=13?b+"rd":b+"th"},template:_.template('<div class="book-result"><div class="result-data"><a href="<%= book.url %>"><span class="book-cover-container"></span><div class="result-info"><div class="left-info"><span class="result-title"><%= book.title %></span><% if(book.subtitle!=false){%><span class="result-sub-header"><%= book.subtitle %></span><% } %><span class="result-detail author"><strong>Author: </strong><%= book.author %></span><span class="result-detail"><strong>ISBN: </strong><span class="isbn"><%= book.isbn %></span><span class="result-detail-isbn13"><strong> ISBN13: </strong><%= book.isbn13 %></span></span><% if(typeof(meta)!= "undefined" && _.size(meta) != 0){ %><div class="results-meta"><%= meta %></div><% } %></div><div class="price-info"><span class="result-title"><strong>Rent </strong><span class="price">$54.49</span></span><span class="result-sub-header">List price: $229.95</span><span class="result-detail">Other: <strong>Buy | eTextbbok </span></div></div></a></div></div>')})}());
Eggshell.define("C.common.search.serp.tbs",{inputs:{render:{payload:{id:"string",component:"string",url:"string",title:"string",long_title:"string",author:"string",isbn:"string",ean:"string",edition_no:"string",solutionCount:"string",subtitle:"string"}}},outputs:{},strict:!1},function(){return Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render);this.bulletSeperatorHTML="&nbsp;&bull;&nbsp;"},render:function(b,a){this.highlightText(a);this.$el.html(this.tbsTemplate({tbs:{id:a.id,
url:a.url.substring(1,a.url.length),coverTitle:a.title,title:this.title+(a.edition_no?" ("+this.toOrdinal(a.edition_no)+" Edition)":""),subtitle:this.subtitle?this.subtitle:!1,author:this.truncateAuthors(a.author),isbn:a.isbn,long_title:a.long_title?a.long_title:!1,isbn13:a.ean?a.ean:!1}}));this.adjustBookCoverTitleLength()},truncateAuthors:function(b){if(b==null)return"";var b=b.split(" ; "),a=b[0];a+=b[1]?"; "+b[1]:"";return a},adjustBookCoverTitleLength:function(){for(var b=this.$(".book-title-text"),
a=this.$(".book-title").height();$(b).outerHeight()>a;)$(b).text(function(a,b){return b.replace(/\W*\s(\S)*$/,"...")})},highlightText:function(b){var a=decodeURIComponent(location.pathname.split("/")[2]),a=RegExp("("+this.regExpQuote(a)+")","i");if(b.title)this.title=b.title.replace(a,'<span class="chg-suggest-term"> $1</span>');if(b.subtitle)this.subtitle=b.subtitle.replace(a,'<span class="chg-suggest-term"> $1</span>')},regExpQuote:function(b){return(b+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},
toOrdinal:function(b){var a=b%10;return a==1&&b!=11?b+"st":a==2&&b!=12?b+"nd":a==3&&b!=13?b+"rd":b+"th"},tbsTemplate:_.template('<div class="result-data"><a class="row" href="<%= tbs.url %>"><div class="left-info"><div class="book-cover"><div class="book-title"><span class="book-title-text"><%= tbs.coverTitle %></span></div></div></div><div class="right-info"><div class="line-item f-size-05 title"><%= tbs.title %></div><div class="f-size-03 line-item detail"><% if(tbs.subtitle!=false){ %><%= tbs.subtitle %><% } %></div><span class="line-item f-size-02 "><strong>Author: </strong><span class="detail"><%= tbs.author %></span></span><div class="line-item"><span class="isbn f-size-02"><strong>ISBN: </strong><span class="detail margin-left"><%= tbs.isbn %></span></span><span class="isbn13 f-size-02"><strong> ISBN13: </strong><span class="detail margin-left"><%= tbs.isbn13 %></span></span></div></div></a></div>')})}());
Eggshell.define("C.common.search.result.tbs",{inputs:{render:{payload:{id:"string",component:"string",url:"string",title:"string",ean:"string",isbn:"string",author:"string",subtitle:"string",edition_no:"string",solutioncount:"string",group:"string",isFirst:"string",type:"string"}}},outputs:{},strict:!1},function(){return Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render)},render:function(b,a){this.highlightText(a);this.$el.html(this.tbsTemplate({tbs:{id:a.id,
component:a.component,searchBy:a.searchBy,url:a.url.substring(1,a.url.length),isbn:a.isbn,isbn13:a.ean,author:this.truncateAuthors(this.author),subtitle:this.subtitle?this.subtitle:!1,title:this.title,edition:a.edition_no?"("+this.toOrdinal(a.edition_no)+" Edition)":""}}))},events:{mouseenter:"onMouseEnterTBSResult",mouseleave:"onMouseLeaveTBSResult"},truncateAuthors:function(b){var a=b;typeof b!="undefined"&&(a=b.split(" ; ")[0]);return a},highlightText:function(b){var a=RegExp("("+this.regExpQuote(b.searchBy)+
")","i");if(b.title)this.title=b.title.replace(a,' <span class="chg-suggest-term">$1</span>');if(b.subtitle)this.subtitle=b.subtitle.replace(a,' <span class="chg-suggest-term">$1</span>');if(b.author)this.author=b.author.replace(a,'<span class="chg-suggest-term">$1</span>')},regExpQuote:function(b){return(b+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},toOrdinal:function(b){var a=b%10;return a===1&&b!==11?b+"st":a===2&&b!==12?b+"nd":a===3&&b!==13?b+"rd":b+"th"},onMouseEnterTBSResult:function(){this.$el.addClass("tbs-highlight")},
onMouseLeaveTBSResult:function(){this.$el.removeClass("tbs-highlight")},tbsTemplate:_.template('<div class="result-data"><a href="<%= tbs.url %>"><div class="left-info"><div class="book-cover"></div></div><div class="right-info"><span class="result-header"><%= tbs.title %>&nbsp;&nbsp;<span class="result-edition"><%= tbs.edition %></span></span><% if(tbs.subtitle!=false){%><span class="result-sub-header"><%= tbs.subtitle %></span><% } %><span class="result-detail"><%= tbs.author %>&nbsp;&bull;&nbsp;ISBN: <%= tbs.isbn %>&nbsp;&bull;&nbsp;ISBN13: <%= tbs.isbn13 %></span></div></a></div>')})}());
Eggshell.define("C.common.search.serp.qna",{inputs:{render:{payload:{}}},outputs:{},strict:!1},function(){return Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render);this.bulletSeperatorHTML="&nbsp;&bull;&nbsp;"},render:function(b,a){var c="undefined"!==typeof a.transcribedData?a.transcribedData:a.text,c=this.getHighlightedText(c.length>440?c.slice(0,440)+"...":c,a.searchBy);this.$el.html(this.qnaTemplate({qna:{id:a.id,text:c,answerCountText:a.answerCount+" Answer"+
(a.answerCount<=1?"":"s"),url:a.url,title:a.title,itemId:a.itemId}}))},getHighlightedText:function(b,a){var c=a?a:decodeURIComponent(location.pathname.split("/")[2]);return b.replace(RegExp(c,"i"),"<span class='highlighted-text'>"+c+"</span>")},qnaTemplate:_.template('<div class="qna-item"><p class="qna-text"><%= qna.text %></p><p class="answer-count"><a href="<%= qna.url %> "><%= qna.answerCountText %></a></p></div>'),onClickSerpItem:function(b){b=$(b.currentTarget).find(".answer-count a").attr("href");
C.utility.navigate(b)},events:{"click .qna-item":"onClickSerpItem"}})}());
Eggshell.define("C.common.search.serp.tutor",{inputs:{render:{payload:{}}},outputs:{},strict:!1},function(){var b=Backbone.Model.extend({urlRoot:"_ajax/tutors",getTutorsBySubject:function(a){return this.fetch({data:{token:C.global.csrfToken,subjectId:a.subjectId,subjectName:a.subjectName,campaign:"Chegg_SERP-tutor-page",limit:"undefined"!==typeof a.count?a.count:3,noSubjectCheck:"undefined"!==typeof a.noSubjectCheck?a.noSubjectCheck:1}})}}),a=Backbone.View.extend({templates:{tutorCard:_.template('<div class="col-4 <%= cssClassName %>"><%= result %></div>'),
viewAll:_.template('<div class="view-all col-4 col-last"><a href="<%= url %>">View All</a></div>'),tutorList:_.template('<div class="tutor-list row"><%= result %></div>'),noTutorAvailable:_.template('<div class="msg-info-lg"><div class="msg-icon"><div class="msg-header">No Tutors Available</div><div class="msg-text">All tutors are offline for this subject currently, please check back later.</div></div></div>')},render:function(a){if(_.isNull(a))a=this.templates.noTutorAvailable();else{var b=$("<div></div>"),
e=a.tutors||[],f=C.utility.getParamsByUrl(a.subjectURL),j=f.trackid,k=f.strackid,l=f.ii;_.each(e,_.bind(function(a,c){var e=$('<div class="tutor-card tutor-row col-4 '+(c%2==0?"col-first":"col-last")+'"></div>');Eggshell.create("C.common.tutors.tutor",{el:e}).trigger("get tbs tutor",a);tutorLink=e.find("a").attr("href");e.find("a").attr("href",tutorLink+"&trackid="+j+"&strackid="+k+"&ii="+l);b.append(e)},this));b.append(this.templates.viewAll({url:a.subjectURL}));a=this.templates.tutorList({result:b.html()});
this.$el.html(a)}}});return Backbone.View.extend({subjectTemplate:_.template('<div class="serp-tutor-subject-container row" data-name="<%= subject.nameOriginal %>" id="<%= subject.id %>"><div class="col-4 subject-name Chgsec_ResSubject Chgsec_ResSubject_<%= subject.heapName %>"><a href="/tutors/<%= subject.url %>" ><%= subject.name %></a></div><div class="col-8 tutor_list_<%= subject.id %> Chgsec_ResTutor "><div class="tutor-list row Chgsec_ResTutorSubject_<%= subject.heapName %>"><div class="view-all tutor-card tutor-row col-4 col-first"></div><div class="view-all tutor-card tutor-row col-4 col-last"></div><div class="view-all tutor-card tutor-row col-4 col-first"></div><div class="view-all col-4 col-last"></div></div></div></div>'),
noSubjectTemplate:_.template('<div class="serp-tutor-subject-container row""><div class="msg-info-lg"><div class="msg-icon"><div class="msg-header">Subject not exist ?</div><div class="msg-text">Please try use another subject keyword to search your tutors.</div></div></div></div>'),initialize:function(){Eggshell.find(this).on("render",this.render);this.bulletSeperatorHTML="&nbsp;&bull;&nbsp;"},render:function(a,b){b&&b.id&&b.name?(this.$el.html(this.subjectTemplate({subject:{id:b.id,nameOriginal:b.name,
name:b.name,heapName:b.name.replace(" ","_"),url:b.url.replace("?","-online-tutoring?")}})),this.getTutorsBySubject(b)):this.$el.html(this.noSubjectTemplate())},getTutorsBySubject:function(c){var d=(new b).getTutorsBySubject({subjectId:c.id,subjectName:c.name}),e=new a({el:this.$(".tutor_list_"+c.id)});d.success(_.bind(function(a){_.has(a,"tutors")?e.render({tutors:a.tutors,url:a.url,subjectURL:this.$(".subject-name a").attr("href")}):e.render(null)},this));d.fail(function(){e.render(null)})}})}());
Eggshell.define("C.common.search.result.qna",{inputs:{render:{payload:{}}},outputs:{},strict:!1},function(){return Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render);this.bulletSeperatorHTML="&nbsp;&bull;&nbsp;"},render:function(b,a){var c="undefined"!==typeof a.transcribedData?a.transcribedData:a.text,c=this.getHighlightedText(c.length>140?c.slice(0,140)+"...":c,a.searchBy);this.$el.html(this.qnaTemplate({qna:{id:a.id,text:c,answerCountText:a.answerCount+" Answer"+
(a.answerCount<=1?"":"s"),url:a.url,title:a.title,itemId:a.itemId}}))},getHighlightedText:function(b,a){regex=RegExp(a,"gi");return b.replace(regex,"<span class='highlighted-text'>"+a+"</span>")},qnaTemplate:_.template('<div class="qna-item"><p class="qna-text f-size-03"><%= qna.text %></p><p class="answer-count"><a href="<%= qna.url %> "><%= qna.answerCountText %></a></p></div>'),onClickSerpItem:function(b){b=$(b.currentTarget).find(".answer-count a").attr("href");C.utility.navigate(b)},events:{"click .qna-item":"onClickSerpItem"}})}());
Eggshell.define("C.common.search.result.subject",{inputs:{render:{payload:{id:"string",url:"string",name:"string",searchBy:"string"}}},outputs:{},strict:!1},function(){return Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render)},render:function(b,a){this.$el.html(this.subjectTemplate({subject:{id:a.id,url:a.url,nameOriginal:a.name,name:this.highlightText(a)}}))},highlightText:function(b){var a=RegExp("("+this.regExpQuote(b.searchBy)+")","i");return b.name.replace(a,
'<span class="highlighted-text">$1</span>')},regExpQuote:function(b){return(b+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},subjectTemplate:_.template('<div class="tutor-subject-result" data-url="<%= subject.url %>" data-name="<%= subject.nameOriginal %>" id="<%= subject.id %>"><%= subject.name %></div>')})}());
Eggshell.define("C.common.search.result.tutor",{inputs:{render:{payload:{id:"string",url:"string",name:"string",searchBy:"string"}}},outputs:{},strict:!1},function(){return Backbone.View.extend({initialize:function(){Eggshell.find(this).on("render",this.render)},render:function(b,a){var c=this.renderUrl(a.url);this.$el.html(this.subjectTemplate({subject:{id:a.id,url:c,nameOriginal:a.name,name:this.highlightText(a)}}));$(".C-common-search-groupV1_6 .category-name").css("padding-top","10px")},renderUrl:function(b){var a=
b.substr(0,b.indexOf("?")),b=b.substr(b.indexOf("?"));return b=C.global.instaEdu?"tutors/"+a+"-online-tutoring/"+b:"search/"+a+"/tutors"+b},highlightText:function(b){var a=RegExp("("+this.regExpQuote(b.searchBy)+")","i");return b.name.replace(a,'<span class="highlighted-text">$1</span>')},regExpQuote:function(b){return(b+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},subjectTemplate:_.template('<a href="<%= subject.url %>"><div class="tutor-subject-result" data-name="<%= subject.nameOriginal %>" id="<%= subject.id %>"><%= subject.name %></div></a>')})}());
(function(){function b(){var a=f.shift();a&&c(a)}function a(){k=setTimeout(function(){b();f.length?a():k=null},e)}function c(a){function b(a){var e;d=+new Date;if(a){try{e=JSON.parse(c.responseText)}catch(f){e={}}a(e)}}var c=new XMLHttpRequest,e=[];c.open("POST",j+"_ajax/odinconcat");c.withCredentials=!0;c.setRequestHeader("Content-Type","application/json");c.onload=b.bind(this,a.success);c.onerror=b.bind(this,a.error);if(a.requests){if(a.requests.length>10)throw"can only use up to 10 requests at a time";
a.requests.forEach(function(a){e.push({url:a.url,method:a.method||"get",payload:a.payload||null,action:a.action,child_request:a.child_request||null,use_board:!!a.use_board,headers:a.headers||{}})});c.send(JSON.stringify({requests:e,headers:a.headers}))}}var d=0,e=100,f=[],j="",k;Eggshell.define("C.odin.concat",{inputs:["fetch","set base url"]},function(){this.Eggshell.listen("fetch",function(c,e){var j=+new Date-d;d=+new Date;f.push(e);k||(j>100?b():a())});this.Eggshell.listen("set base url",function(a,
b){j=b.url})})})();
